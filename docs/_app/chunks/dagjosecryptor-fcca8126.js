var ja=Object.defineProperty,Ka=Object.defineProperties;var Ga=Object.getOwnPropertyDescriptors;var Fi=Object.getOwnPropertySymbols;var Ja=Object.prototype.hasOwnProperty,Xa=Object.prototype.propertyIsEnumerable;var Hi=(e,t,r)=>t in e?ja(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Vt=(e,t)=>{for(var r in t||(t={}))Ja.call(t,r)&&Hi(e,r,t[r]);if(Fi)for(var r of Fi(t))Xa.call(t,r)&&Hi(e,r,t[r]);return e},Yr=(e,t)=>Ka(e,Ga(t));import{ah as er,ai as me,aj as Wa}from"./vendor-fa7435e7.js";var Va={},Ya=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Va}),Za=er(Ya),Zr={};const Qa="elliptic",to="6.5.4",eo="EC cryptography",ro="lib/elliptic.js",no=["lib"],io={lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},fo={type:"git",url:"git@github.com:indutny/elliptic"},ao=["EC","Elliptic","curve","Cryptography"],oo="Fedor Indutny <fedor@indutny.com>",so="MIT",ho={url:"https://github.com/indutny/elliptic/issues"},uo="https://github.com/indutny/elliptic",co={brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},lo={"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"};var vo={name:Qa,version:to,description:eo,main:ro,files:no,scripts:io,repository:fo,keywords:ao,author:oo,license:so,bugs:ho,homepage:uo,devDependencies:co,dependencies:lo},ce={},_e={exports:{}};(function(e){(function(t,r){function n(M,a){if(!M)throw new Error(a||"Assertion failed")}function i(M,a){M.super_=a;var c=function(){};c.prototype=a.prototype,M.prototype=new c,M.prototype.constructor=M}function f(M,a,c){if(f.isBN(M))return M;this.negative=0,this.words=null,this.length=0,this.red=null,M!==null&&((a==="le"||a==="be")&&(c=a,a=10),this._init(M||0,a||10,c||"be"))}typeof t=="object"?t.exports=f:r.BN=f,f.BN=f,f.wordSize=26;var l;try{typeof window!="undefined"&&typeof window.Buffer!="undefined"?l=window.Buffer:l=require("buffer").Buffer}catch{}f.isBN=function(a){return a instanceof f?!0:a!==null&&typeof a=="object"&&a.constructor.wordSize===f.wordSize&&Array.isArray(a.words)},f.max=function(a,c){return a.cmp(c)>0?a:c},f.min=function(a,c){return a.cmp(c)<0?a:c},f.prototype._init=function(a,c,d){if(typeof a=="number")return this._initNumber(a,c,d);if(typeof a=="object")return this._initArray(a,c,d);c==="hex"&&(c=16),n(c===(c|0)&&c>=2&&c<=36),a=a.toString().replace(/\s+/g,"");var v=0;a[0]==="-"&&(v++,this.negative=1),v<a.length&&(c===16?this._parseHex(a,v,d):(this._parseBase(a,c,v),d==="le"&&this._initArray(this.toArray(),c,d)))},f.prototype._initNumber=function(a,c,d){a<0&&(this.negative=1,a=-a),a<67108864?(this.words=[a&67108863],this.length=1):a<4503599627370496?(this.words=[a&67108863,a/67108864&67108863],this.length=2):(n(a<9007199254740992),this.words=[a&67108863,a/67108864&67108863,1],this.length=3),d==="le"&&this._initArray(this.toArray(),c,d)},f.prototype._initArray=function(a,c,d){if(n(typeof a.length=="number"),a.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(a.length/3),this.words=new Array(this.length);for(var v=0;v<this.length;v++)this.words[v]=0;var w,S,_=0;if(d==="be")for(v=a.length-1,w=0;v>=0;v-=3)S=a[v]|a[v-1]<<8|a[v-2]<<16,this.words[w]|=S<<_&67108863,this.words[w+1]=S>>>26-_&67108863,_+=24,_>=26&&(_-=26,w++);else if(d==="le")for(v=0,w=0;v<a.length;v+=3)S=a[v]|a[v+1]<<8|a[v+2]<<16,this.words[w]|=S<<_&67108863,this.words[w+1]=S>>>26-_&67108863,_+=24,_>=26&&(_-=26,w++);return this.strip()};function u(M,a){var c=M.charCodeAt(a);return c>=65&&c<=70?c-55:c>=97&&c<=102?c-87:c-48&15}function p(M,a,c){var d=u(M,c);return c-1>=a&&(d|=u(M,c-1)<<4),d}f.prototype._parseHex=function(a,c,d){this.length=Math.ceil((a.length-c)/6),this.words=new Array(this.length);for(var v=0;v<this.length;v++)this.words[v]=0;var w=0,S=0,_;if(d==="be")for(v=a.length-1;v>=c;v-=2)_=p(a,c,v)<<w,this.words[S]|=_&67108863,w>=18?(w-=18,S+=1,this.words[S]|=_>>>26):w+=8;else{var y=a.length-c;for(v=y%2==0?c+1:c;v<a.length;v+=2)_=p(a,c,v)<<w,this.words[S]|=_&67108863,w>=18?(w-=18,S+=1,this.words[S]|=_>>>26):w+=8}this.strip()};function x(M,a,c,d){for(var v=0,w=Math.min(M.length,c),S=a;S<w;S++){var _=M.charCodeAt(S)-48;v*=d,_>=49?v+=_-49+10:_>=17?v+=_-17+10:v+=_}return v}f.prototype._parseBase=function(a,c,d){this.words=[0],this.length=1;for(var v=0,w=1;w<=67108863;w*=c)v++;v--,w=w/c|0;for(var S=a.length-d,_=S%v,y=Math.min(S,S-_)+d,o=0,m=d;m<y;m+=v)o=x(a,m,m+v,c),this.imuln(w),this.words[0]+o<67108864?this.words[0]+=o:this._iaddn(o);if(_!==0){var K=1;for(o=x(a,m,a.length,c),m=0;m<_;m++)K*=c;this.imuln(K),this.words[0]+o<67108864?this.words[0]+=o:this._iaddn(o)}this.strip()},f.prototype.copy=function(a){a.words=new Array(this.length);for(var c=0;c<this.length;c++)a.words[c]=this.words[c];a.length=this.length,a.negative=this.negative,a.red=this.red},f.prototype.clone=function(){var a=new f(null);return this.copy(a),a},f.prototype._expand=function(a){for(;this.length<a;)this.words[this.length++]=0;return this},f.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},f.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},f.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var g=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],A=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],L=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];f.prototype.toString=function(a,c){a=a||10,c=c|0||1;var d;if(a===16||a==="hex"){d="";for(var v=0,w=0,S=0;S<this.length;S++){var _=this.words[S],y=((_<<v|w)&16777215).toString(16);w=_>>>24-v&16777215,w!==0||S!==this.length-1?d=g[6-y.length]+y+d:d=y+d,v+=2,v>=26&&(v-=26,S--)}for(w!==0&&(d=w.toString(16)+d);d.length%c!=0;)d="0"+d;return this.negative!==0&&(d="-"+d),d}if(a===(a|0)&&a>=2&&a<=36){var o=A[a],m=L[a];d="";var K=this.clone();for(K.negative=0;!K.isZero();){var k=K.modn(m).toString(a);K=K.idivn(m),K.isZero()?d=k+d:d=g[o-k.length]+k+d}for(this.isZero()&&(d="0"+d);d.length%c!=0;)d="0"+d;return this.negative!==0&&(d="-"+d),d}n(!1,"Base should be between 2 and 36")},f.prototype.toNumber=function(){var a=this.words[0];return this.length===2?a+=this.words[1]*67108864:this.length===3&&this.words[2]===1?a+=4503599627370496+this.words[1]*67108864:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-a:a},f.prototype.toJSON=function(){return this.toString(16)},f.prototype.toBuffer=function(a,c){return n(typeof l!="undefined"),this.toArrayLike(l,a,c)},f.prototype.toArray=function(a,c){return this.toArrayLike(Array,a,c)},f.prototype.toArrayLike=function(a,c,d){var v=this.byteLength(),w=d||Math.max(1,v);n(v<=w,"byte array longer than desired length"),n(w>0,"Requested array length <= 0"),this.strip();var S=c==="le",_=new a(w),y,o,m=this.clone();if(S){for(o=0;!m.isZero();o++)y=m.andln(255),m.iushrn(8),_[o]=y;for(;o<w;o++)_[o]=0}else{for(o=0;o<w-v;o++)_[o]=0;for(o=0;!m.isZero();o++)y=m.andln(255),m.iushrn(8),_[w-o-1]=y}return _},Math.clz32?f.prototype._countBits=function(a){return 32-Math.clz32(a)}:f.prototype._countBits=function(a){var c=a,d=0;return c>=4096&&(d+=13,c>>>=13),c>=64&&(d+=7,c>>>=7),c>=8&&(d+=4,c>>>=4),c>=2&&(d+=2,c>>>=2),d+c},f.prototype._zeroBits=function(a){if(a===0)return 26;var c=a,d=0;return(c&8191)==0&&(d+=13,c>>>=13),(c&127)==0&&(d+=7,c>>>=7),(c&15)==0&&(d+=4,c>>>=4),(c&3)==0&&(d+=2,c>>>=2),(c&1)==0&&d++,d},f.prototype.bitLength=function(){var a=this.words[this.length-1],c=this._countBits(a);return(this.length-1)*26+c};function U(M){for(var a=new Array(M.bitLength()),c=0;c<a.length;c++){var d=c/26|0,v=c%26;a[c]=(M.words[d]&1<<v)>>>v}return a}f.prototype.zeroBits=function(){if(this.isZero())return 0;for(var a=0,c=0;c<this.length;c++){var d=this._zeroBits(this.words[c]);if(a+=d,d!==26)break}return a},f.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},f.prototype.toTwos=function(a){return this.negative!==0?this.abs().inotn(a).iaddn(1):this.clone()},f.prototype.fromTwos=function(a){return this.testn(a-1)?this.notn(a).iaddn(1).ineg():this.clone()},f.prototype.isNeg=function(){return this.negative!==0},f.prototype.neg=function(){return this.clone().ineg()},f.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},f.prototype.iuor=function(a){for(;this.length<a.length;)this.words[this.length++]=0;for(var c=0;c<a.length;c++)this.words[c]=this.words[c]|a.words[c];return this.strip()},f.prototype.ior=function(a){return n((this.negative|a.negative)==0),this.iuor(a)},f.prototype.or=function(a){return this.length>a.length?this.clone().ior(a):a.clone().ior(this)},f.prototype.uor=function(a){return this.length>a.length?this.clone().iuor(a):a.clone().iuor(this)},f.prototype.iuand=function(a){var c;this.length>a.length?c=a:c=this;for(var d=0;d<c.length;d++)this.words[d]=this.words[d]&a.words[d];return this.length=c.length,this.strip()},f.prototype.iand=function(a){return n((this.negative|a.negative)==0),this.iuand(a)},f.prototype.and=function(a){return this.length>a.length?this.clone().iand(a):a.clone().iand(this)},f.prototype.uand=function(a){return this.length>a.length?this.clone().iuand(a):a.clone().iuand(this)},f.prototype.iuxor=function(a){var c,d;this.length>a.length?(c=this,d=a):(c=a,d=this);for(var v=0;v<d.length;v++)this.words[v]=c.words[v]^d.words[v];if(this!==c)for(;v<c.length;v++)this.words[v]=c.words[v];return this.length=c.length,this.strip()},f.prototype.ixor=function(a){return n((this.negative|a.negative)==0),this.iuxor(a)},f.prototype.xor=function(a){return this.length>a.length?this.clone().ixor(a):a.clone().ixor(this)},f.prototype.uxor=function(a){return this.length>a.length?this.clone().iuxor(a):a.clone().iuxor(this)},f.prototype.inotn=function(a){n(typeof a=="number"&&a>=0);var c=Math.ceil(a/26)|0,d=a%26;this._expand(c),d>0&&c--;for(var v=0;v<c;v++)this.words[v]=~this.words[v]&67108863;return d>0&&(this.words[v]=~this.words[v]&67108863>>26-d),this.strip()},f.prototype.notn=function(a){return this.clone().inotn(a)},f.prototype.setn=function(a,c){n(typeof a=="number"&&a>=0);var d=a/26|0,v=a%26;return this._expand(d+1),c?this.words[d]=this.words[d]|1<<v:this.words[d]=this.words[d]&~(1<<v),this.strip()},f.prototype.iadd=function(a){var c;if(this.negative!==0&&a.negative===0)return this.negative=0,c=this.isub(a),this.negative^=1,this._normSign();if(this.negative===0&&a.negative!==0)return a.negative=0,c=this.isub(a),a.negative=1,c._normSign();var d,v;this.length>a.length?(d=this,v=a):(d=a,v=this);for(var w=0,S=0;S<v.length;S++)c=(d.words[S]|0)+(v.words[S]|0)+w,this.words[S]=c&67108863,w=c>>>26;for(;w!==0&&S<d.length;S++)c=(d.words[S]|0)+w,this.words[S]=c&67108863,w=c>>>26;if(this.length=d.length,w!==0)this.words[this.length]=w,this.length++;else if(d!==this)for(;S<d.length;S++)this.words[S]=d.words[S];return this},f.prototype.add=function(a){var c;return a.negative!==0&&this.negative===0?(a.negative=0,c=this.sub(a),a.negative^=1,c):a.negative===0&&this.negative!==0?(this.negative=0,c=a.sub(this),this.negative=1,c):this.length>a.length?this.clone().iadd(a):a.clone().iadd(this)},f.prototype.isub=function(a){if(a.negative!==0){a.negative=0;var c=this.iadd(a);return a.negative=1,c._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(a),this.negative=1,this._normSign();var d=this.cmp(a);if(d===0)return this.negative=0,this.length=1,this.words[0]=0,this;var v,w;d>0?(v=this,w=a):(v=a,w=this);for(var S=0,_=0;_<w.length;_++)c=(v.words[_]|0)-(w.words[_]|0)+S,S=c>>26,this.words[_]=c&67108863;for(;S!==0&&_<v.length;_++)c=(v.words[_]|0)+S,S=c>>26,this.words[_]=c&67108863;if(S===0&&_<v.length&&v!==this)for(;_<v.length;_++)this.words[_]=v.words[_];return this.length=Math.max(this.length,_),v!==this&&(this.negative=1),this.strip()},f.prototype.sub=function(a){return this.clone().isub(a)};function N(M,a,c){c.negative=a.negative^M.negative;var d=M.length+a.length|0;c.length=d,d=d-1|0;var v=M.words[0]|0,w=a.words[0]|0,S=v*w,_=S&67108863,y=S/67108864|0;c.words[0]=_;for(var o=1;o<d;o++){for(var m=y>>>26,K=y&67108863,k=Math.min(o,a.length-1),W=Math.max(0,o-M.length+1);W<=k;W++){var b=o-W|0;v=M.words[b]|0,w=a.words[W]|0,S=v*w+K,m+=S/67108864|0,K=S&67108863}c.words[o]=K|0,y=m|0}return y!==0?c.words[o]=y|0:c.length--,c.strip()}var T=function(a,c,d){var v=a.words,w=c.words,S=d.words,_=0,y,o,m,K=v[0]|0,k=K&8191,W=K>>>13,b=v[1]|0,R=b&8191,E=b>>>13,C=v[2]|0,B=C&8191,s=C>>>13,I=v[3]|0,D=I&8191,V=I>>>13,Y=v[4]|0,Q=Y&8191,it=Y>>>13,Ut=v[5]|0,vt=Ut&8191,dt=Ut>>>13,Bt=v[6]|0,ft=Bt&8191,nt=Bt>>>13,pt=v[7]|0,rt=pt&8191,et=pt>>>13,lt=v[8]|0,tt=lt&8191,at=lt>>>13,$t=v[9]|0,ot=$t&8191,st=$t>>>13,Ct=w[0]|0,ut=Ct&8191,ct=Ct>>>13,zt=w[1]|0,Pt=zt&8191,Rt=zt>>>13,se=w[2]|0,Tt=se&8191,Dt=se>>>13,ye=w[3]|0,kt=ye&8191,yt=ye>>>13,Kt=w[4]|0,gt=Kt&8191,xt=Kt>>>13,Gt=w[5]|0,wt=Gt&8191,mt=Gt>>>13,Jt=w[6]|0,_t=Jt&8191,Mt=Jt>>>13,Xt=w[7]|0,St=Xt&8191,At=Xt>>>13,Wt=w[8]|0,Et=Wt&8191,It=Wt>>>13,tr=w[9]|0,Ft=tr&8191,Ht=tr>>>13;d.negative=a.negative^c.negative,d.length=19,y=Math.imul(k,ut),o=Math.imul(k,ct),o=o+Math.imul(W,ut)|0,m=Math.imul(W,ct);var Te=(_+y|0)+((o&8191)<<13)|0;_=(m+(o>>>13)|0)+(Te>>>26)|0,Te&=67108863,y=Math.imul(R,ut),o=Math.imul(R,ct),o=o+Math.imul(E,ut)|0,m=Math.imul(E,ct),y=y+Math.imul(k,Pt)|0,o=o+Math.imul(k,Rt)|0,o=o+Math.imul(W,Pt)|0,m=m+Math.imul(W,Rt)|0;var De=(_+y|0)+((o&8191)<<13)|0;_=(m+(o>>>13)|0)+(De>>>26)|0,De&=67108863,y=Math.imul(B,ut),o=Math.imul(B,ct),o=o+Math.imul(s,ut)|0,m=Math.imul(s,ct),y=y+Math.imul(R,Pt)|0,o=o+Math.imul(R,Rt)|0,o=o+Math.imul(E,Pt)|0,m=m+Math.imul(E,Rt)|0,y=y+Math.imul(k,Tt)|0,o=o+Math.imul(k,Dt)|0,o=o+Math.imul(W,Tt)|0,m=m+Math.imul(W,Dt)|0;var ke=(_+y|0)+((o&8191)<<13)|0;_=(m+(o>>>13)|0)+(ke>>>26)|0,ke&=67108863,y=Math.imul(D,ut),o=Math.imul(D,ct),o=o+Math.imul(V,ut)|0,m=Math.imul(V,ct),y=y+Math.imul(B,Pt)|0,o=o+Math.imul(B,Rt)|0,o=o+Math.imul(s,Pt)|0,m=m+Math.imul(s,Rt)|0,y=y+Math.imul(R,Tt)|0,o=o+Math.imul(R,Dt)|0,o=o+Math.imul(E,Tt)|0,m=m+Math.imul(E,Dt)|0,y=y+Math.imul(k,kt)|0,o=o+Math.imul(k,yt)|0,o=o+Math.imul(W,kt)|0,m=m+Math.imul(W,yt)|0;var qe=(_+y|0)+((o&8191)<<13)|0;_=(m+(o>>>13)|0)+(qe>>>26)|0,qe&=67108863,y=Math.imul(Q,ut),o=Math.imul(Q,ct),o=o+Math.imul(it,ut)|0,m=Math.imul(it,ct),y=y+Math.imul(D,Pt)|0,o=o+Math.imul(D,Rt)|0,o=o+Math.imul(V,Pt)|0,m=m+Math.imul(V,Rt)|0,y=y+Math.imul(B,Tt)|0,o=o+Math.imul(B,Dt)|0,o=o+Math.imul(s,Tt)|0,m=m+Math.imul(s,Dt)|0,y=y+Math.imul(R,kt)|0,o=o+Math.imul(R,yt)|0,o=o+Math.imul(E,kt)|0,m=m+Math.imul(E,yt)|0,y=y+Math.imul(k,gt)|0,o=o+Math.imul(k,xt)|0,o=o+Math.imul(W,gt)|0,m=m+Math.imul(W,xt)|0;var Fe=(_+y|0)+((o&8191)<<13)|0;_=(m+(o>>>13)|0)+(Fe>>>26)|0,Fe&=67108863,y=Math.imul(vt,ut),o=Math.imul(vt,ct),o=o+Math.imul(dt,ut)|0,m=Math.imul(dt,ct),y=y+Math.imul(Q,Pt)|0,o=o+Math.imul(Q,Rt)|0,o=o+Math.imul(it,Pt)|0,m=m+Math.imul(it,Rt)|0,y=y+Math.imul(D,Tt)|0,o=o+Math.imul(D,Dt)|0,o=o+Math.imul(V,Tt)|0,m=m+Math.imul(V,Dt)|0,y=y+Math.imul(B,kt)|0,o=o+Math.imul(B,yt)|0,o=o+Math.imul(s,kt)|0,m=m+Math.imul(s,yt)|0,y=y+Math.imul(R,gt)|0,o=o+Math.imul(R,xt)|0,o=o+Math.imul(E,gt)|0,m=m+Math.imul(E,xt)|0,y=y+Math.imul(k,wt)|0,o=o+Math.imul(k,mt)|0,o=o+Math.imul(W,wt)|0,m=m+Math.imul(W,mt)|0;var He=(_+y|0)+((o&8191)<<13)|0;_=(m+(o>>>13)|0)+(He>>>26)|0,He&=67108863,y=Math.imul(ft,ut),o=Math.imul(ft,ct),o=o+Math.imul(nt,ut)|0,m=Math.imul(nt,ct),y=y+Math.imul(vt,Pt)|0,o=o+Math.imul(vt,Rt)|0,o=o+Math.imul(dt,Pt)|0,m=m+Math.imul(dt,Rt)|0,y=y+Math.imul(Q,Tt)|0,o=o+Math.imul(Q,Dt)|0,o=o+Math.imul(it,Tt)|0,m=m+Math.imul(it,Dt)|0,y=y+Math.imul(D,kt)|0,o=o+Math.imul(D,yt)|0,o=o+Math.imul(V,kt)|0,m=m+Math.imul(V,yt)|0,y=y+Math.imul(B,gt)|0,o=o+Math.imul(B,xt)|0,o=o+Math.imul(s,gt)|0,m=m+Math.imul(s,xt)|0,y=y+Math.imul(R,wt)|0,o=o+Math.imul(R,mt)|0,o=o+Math.imul(E,wt)|0,m=m+Math.imul(E,mt)|0,y=y+Math.imul(k,_t)|0,o=o+Math.imul(k,Mt)|0,o=o+Math.imul(W,_t)|0,m=m+Math.imul(W,Mt)|0;var je=(_+y|0)+((o&8191)<<13)|0;_=(m+(o>>>13)|0)+(je>>>26)|0,je&=67108863,y=Math.imul(rt,ut),o=Math.imul(rt,ct),o=o+Math.imul(et,ut)|0,m=Math.imul(et,ct),y=y+Math.imul(ft,Pt)|0,o=o+Math.imul(ft,Rt)|0,o=o+Math.imul(nt,Pt)|0,m=m+Math.imul(nt,Rt)|0,y=y+Math.imul(vt,Tt)|0,o=o+Math.imul(vt,Dt)|0,o=o+Math.imul(dt,Tt)|0,m=m+Math.imul(dt,Dt)|0,y=y+Math.imul(Q,kt)|0,o=o+Math.imul(Q,yt)|0,o=o+Math.imul(it,kt)|0,m=m+Math.imul(it,yt)|0,y=y+Math.imul(D,gt)|0,o=o+Math.imul(D,xt)|0,o=o+Math.imul(V,gt)|0,m=m+Math.imul(V,xt)|0,y=y+Math.imul(B,wt)|0,o=o+Math.imul(B,mt)|0,o=o+Math.imul(s,wt)|0,m=m+Math.imul(s,mt)|0,y=y+Math.imul(R,_t)|0,o=o+Math.imul(R,Mt)|0,o=o+Math.imul(E,_t)|0,m=m+Math.imul(E,Mt)|0,y=y+Math.imul(k,St)|0,o=o+Math.imul(k,At)|0,o=o+Math.imul(W,St)|0,m=m+Math.imul(W,At)|0;var Dn=(_+y|0)+((o&8191)<<13)|0;_=(m+(o>>>13)|0)+(Dn>>>26)|0,Dn&=67108863,y=Math.imul(tt,ut),o=Math.imul(tt,ct),o=o+Math.imul(at,ut)|0,m=Math.imul(at,ct),y=y+Math.imul(rt,Pt)|0,o=o+Math.imul(rt,Rt)|0,o=o+Math.imul(et,Pt)|0,m=m+Math.imul(et,Rt)|0,y=y+Math.imul(ft,Tt)|0,o=o+Math.imul(ft,Dt)|0,o=o+Math.imul(nt,Tt)|0,m=m+Math.imul(nt,Dt)|0,y=y+Math.imul(vt,kt)|0,o=o+Math.imul(vt,yt)|0,o=o+Math.imul(dt,kt)|0,m=m+Math.imul(dt,yt)|0,y=y+Math.imul(Q,gt)|0,o=o+Math.imul(Q,xt)|0,o=o+Math.imul(it,gt)|0,m=m+Math.imul(it,xt)|0,y=y+Math.imul(D,wt)|0,o=o+Math.imul(D,mt)|0,o=o+Math.imul(V,wt)|0,m=m+Math.imul(V,mt)|0,y=y+Math.imul(B,_t)|0,o=o+Math.imul(B,Mt)|0,o=o+Math.imul(s,_t)|0,m=m+Math.imul(s,Mt)|0,y=y+Math.imul(R,St)|0,o=o+Math.imul(R,At)|0,o=o+Math.imul(E,St)|0,m=m+Math.imul(E,At)|0,y=y+Math.imul(k,Et)|0,o=o+Math.imul(k,It)|0,o=o+Math.imul(W,Et)|0,m=m+Math.imul(W,It)|0;var kn=(_+y|0)+((o&8191)<<13)|0;_=(m+(o>>>13)|0)+(kn>>>26)|0,kn&=67108863,y=Math.imul(ot,ut),o=Math.imul(ot,ct),o=o+Math.imul(st,ut)|0,m=Math.imul(st,ct),y=y+Math.imul(tt,Pt)|0,o=o+Math.imul(tt,Rt)|0,o=o+Math.imul(at,Pt)|0,m=m+Math.imul(at,Rt)|0,y=y+Math.imul(rt,Tt)|0,o=o+Math.imul(rt,Dt)|0,o=o+Math.imul(et,Tt)|0,m=m+Math.imul(et,Dt)|0,y=y+Math.imul(ft,kt)|0,o=o+Math.imul(ft,yt)|0,o=o+Math.imul(nt,kt)|0,m=m+Math.imul(nt,yt)|0,y=y+Math.imul(vt,gt)|0,o=o+Math.imul(vt,xt)|0,o=o+Math.imul(dt,gt)|0,m=m+Math.imul(dt,xt)|0,y=y+Math.imul(Q,wt)|0,o=o+Math.imul(Q,mt)|0,o=o+Math.imul(it,wt)|0,m=m+Math.imul(it,mt)|0,y=y+Math.imul(D,_t)|0,o=o+Math.imul(D,Mt)|0,o=o+Math.imul(V,_t)|0,m=m+Math.imul(V,Mt)|0,y=y+Math.imul(B,St)|0,o=o+Math.imul(B,At)|0,o=o+Math.imul(s,St)|0,m=m+Math.imul(s,At)|0,y=y+Math.imul(R,Et)|0,o=o+Math.imul(R,It)|0,o=o+Math.imul(E,Et)|0,m=m+Math.imul(E,It)|0,y=y+Math.imul(k,Ft)|0,o=o+Math.imul(k,Ht)|0,o=o+Math.imul(W,Ft)|0,m=m+Math.imul(W,Ht)|0;var qn=(_+y|0)+((o&8191)<<13)|0;_=(m+(o>>>13)|0)+(qn>>>26)|0,qn&=67108863,y=Math.imul(ot,Pt),o=Math.imul(ot,Rt),o=o+Math.imul(st,Pt)|0,m=Math.imul(st,Rt),y=y+Math.imul(tt,Tt)|0,o=o+Math.imul(tt,Dt)|0,o=o+Math.imul(at,Tt)|0,m=m+Math.imul(at,Dt)|0,y=y+Math.imul(rt,kt)|0,o=o+Math.imul(rt,yt)|0,o=o+Math.imul(et,kt)|0,m=m+Math.imul(et,yt)|0,y=y+Math.imul(ft,gt)|0,o=o+Math.imul(ft,xt)|0,o=o+Math.imul(nt,gt)|0,m=m+Math.imul(nt,xt)|0,y=y+Math.imul(vt,wt)|0,o=o+Math.imul(vt,mt)|0,o=o+Math.imul(dt,wt)|0,m=m+Math.imul(dt,mt)|0,y=y+Math.imul(Q,_t)|0,o=o+Math.imul(Q,Mt)|0,o=o+Math.imul(it,_t)|0,m=m+Math.imul(it,Mt)|0,y=y+Math.imul(D,St)|0,o=o+Math.imul(D,At)|0,o=o+Math.imul(V,St)|0,m=m+Math.imul(V,At)|0,y=y+Math.imul(B,Et)|0,o=o+Math.imul(B,It)|0,o=o+Math.imul(s,Et)|0,m=m+Math.imul(s,It)|0,y=y+Math.imul(R,Ft)|0,o=o+Math.imul(R,Ht)|0,o=o+Math.imul(E,Ft)|0,m=m+Math.imul(E,Ht)|0;var Fn=(_+y|0)+((o&8191)<<13)|0;_=(m+(o>>>13)|0)+(Fn>>>26)|0,Fn&=67108863,y=Math.imul(ot,Tt),o=Math.imul(ot,Dt),o=o+Math.imul(st,Tt)|0,m=Math.imul(st,Dt),y=y+Math.imul(tt,kt)|0,o=o+Math.imul(tt,yt)|0,o=o+Math.imul(at,kt)|0,m=m+Math.imul(at,yt)|0,y=y+Math.imul(rt,gt)|0,o=o+Math.imul(rt,xt)|0,o=o+Math.imul(et,gt)|0,m=m+Math.imul(et,xt)|0,y=y+Math.imul(ft,wt)|0,o=o+Math.imul(ft,mt)|0,o=o+Math.imul(nt,wt)|0,m=m+Math.imul(nt,mt)|0,y=y+Math.imul(vt,_t)|0,o=o+Math.imul(vt,Mt)|0,o=o+Math.imul(dt,_t)|0,m=m+Math.imul(dt,Mt)|0,y=y+Math.imul(Q,St)|0,o=o+Math.imul(Q,At)|0,o=o+Math.imul(it,St)|0,m=m+Math.imul(it,At)|0,y=y+Math.imul(D,Et)|0,o=o+Math.imul(D,It)|0,o=o+Math.imul(V,Et)|0,m=m+Math.imul(V,It)|0,y=y+Math.imul(B,Ft)|0,o=o+Math.imul(B,Ht)|0,o=o+Math.imul(s,Ft)|0,m=m+Math.imul(s,Ht)|0;var Hn=(_+y|0)+((o&8191)<<13)|0;_=(m+(o>>>13)|0)+(Hn>>>26)|0,Hn&=67108863,y=Math.imul(ot,kt),o=Math.imul(ot,yt),o=o+Math.imul(st,kt)|0,m=Math.imul(st,yt),y=y+Math.imul(tt,gt)|0,o=o+Math.imul(tt,xt)|0,o=o+Math.imul(at,gt)|0,m=m+Math.imul(at,xt)|0,y=y+Math.imul(rt,wt)|0,o=o+Math.imul(rt,mt)|0,o=o+Math.imul(et,wt)|0,m=m+Math.imul(et,mt)|0,y=y+Math.imul(ft,_t)|0,o=o+Math.imul(ft,Mt)|0,o=o+Math.imul(nt,_t)|0,m=m+Math.imul(nt,Mt)|0,y=y+Math.imul(vt,St)|0,o=o+Math.imul(vt,At)|0,o=o+Math.imul(dt,St)|0,m=m+Math.imul(dt,At)|0,y=y+Math.imul(Q,Et)|0,o=o+Math.imul(Q,It)|0,o=o+Math.imul(it,Et)|0,m=m+Math.imul(it,It)|0,y=y+Math.imul(D,Ft)|0,o=o+Math.imul(D,Ht)|0,o=o+Math.imul(V,Ft)|0,m=m+Math.imul(V,Ht)|0;var jn=(_+y|0)+((o&8191)<<13)|0;_=(m+(o>>>13)|0)+(jn>>>26)|0,jn&=67108863,y=Math.imul(ot,gt),o=Math.imul(ot,xt),o=o+Math.imul(st,gt)|0,m=Math.imul(st,xt),y=y+Math.imul(tt,wt)|0,o=o+Math.imul(tt,mt)|0,o=o+Math.imul(at,wt)|0,m=m+Math.imul(at,mt)|0,y=y+Math.imul(rt,_t)|0,o=o+Math.imul(rt,Mt)|0,o=o+Math.imul(et,_t)|0,m=m+Math.imul(et,Mt)|0,y=y+Math.imul(ft,St)|0,o=o+Math.imul(ft,At)|0,o=o+Math.imul(nt,St)|0,m=m+Math.imul(nt,At)|0,y=y+Math.imul(vt,Et)|0,o=o+Math.imul(vt,It)|0,o=o+Math.imul(dt,Et)|0,m=m+Math.imul(dt,It)|0,y=y+Math.imul(Q,Ft)|0,o=o+Math.imul(Q,Ht)|0,o=o+Math.imul(it,Ft)|0,m=m+Math.imul(it,Ht)|0;var Kn=(_+y|0)+((o&8191)<<13)|0;_=(m+(o>>>13)|0)+(Kn>>>26)|0,Kn&=67108863,y=Math.imul(ot,wt),o=Math.imul(ot,mt),o=o+Math.imul(st,wt)|0,m=Math.imul(st,mt),y=y+Math.imul(tt,_t)|0,o=o+Math.imul(tt,Mt)|0,o=o+Math.imul(at,_t)|0,m=m+Math.imul(at,Mt)|0,y=y+Math.imul(rt,St)|0,o=o+Math.imul(rt,At)|0,o=o+Math.imul(et,St)|0,m=m+Math.imul(et,At)|0,y=y+Math.imul(ft,Et)|0,o=o+Math.imul(ft,It)|0,o=o+Math.imul(nt,Et)|0,m=m+Math.imul(nt,It)|0,y=y+Math.imul(vt,Ft)|0,o=o+Math.imul(vt,Ht)|0,o=o+Math.imul(dt,Ft)|0,m=m+Math.imul(dt,Ht)|0;var Gn=(_+y|0)+((o&8191)<<13)|0;_=(m+(o>>>13)|0)+(Gn>>>26)|0,Gn&=67108863,y=Math.imul(ot,_t),o=Math.imul(ot,Mt),o=o+Math.imul(st,_t)|0,m=Math.imul(st,Mt),y=y+Math.imul(tt,St)|0,o=o+Math.imul(tt,At)|0,o=o+Math.imul(at,St)|0,m=m+Math.imul(at,At)|0,y=y+Math.imul(rt,Et)|0,o=o+Math.imul(rt,It)|0,o=o+Math.imul(et,Et)|0,m=m+Math.imul(et,It)|0,y=y+Math.imul(ft,Ft)|0,o=o+Math.imul(ft,Ht)|0,o=o+Math.imul(nt,Ft)|0,m=m+Math.imul(nt,Ht)|0;var Jn=(_+y|0)+((o&8191)<<13)|0;_=(m+(o>>>13)|0)+(Jn>>>26)|0,Jn&=67108863,y=Math.imul(ot,St),o=Math.imul(ot,At),o=o+Math.imul(st,St)|0,m=Math.imul(st,At),y=y+Math.imul(tt,Et)|0,o=o+Math.imul(tt,It)|0,o=o+Math.imul(at,Et)|0,m=m+Math.imul(at,It)|0,y=y+Math.imul(rt,Ft)|0,o=o+Math.imul(rt,Ht)|0,o=o+Math.imul(et,Ft)|0,m=m+Math.imul(et,Ht)|0;var Xn=(_+y|0)+((o&8191)<<13)|0;_=(m+(o>>>13)|0)+(Xn>>>26)|0,Xn&=67108863,y=Math.imul(ot,Et),o=Math.imul(ot,It),o=o+Math.imul(st,Et)|0,m=Math.imul(st,It),y=y+Math.imul(tt,Ft)|0,o=o+Math.imul(tt,Ht)|0,o=o+Math.imul(at,Ft)|0,m=m+Math.imul(at,Ht)|0;var Wn=(_+y|0)+((o&8191)<<13)|0;_=(m+(o>>>13)|0)+(Wn>>>26)|0,Wn&=67108863,y=Math.imul(ot,Ft),o=Math.imul(ot,Ht),o=o+Math.imul(st,Ft)|0,m=Math.imul(st,Ht);var Vn=(_+y|0)+((o&8191)<<13)|0;return _=(m+(o>>>13)|0)+(Vn>>>26)|0,Vn&=67108863,S[0]=Te,S[1]=De,S[2]=ke,S[3]=qe,S[4]=Fe,S[5]=He,S[6]=je,S[7]=Dn,S[8]=kn,S[9]=qn,S[10]=Fn,S[11]=Hn,S[12]=jn,S[13]=Kn,S[14]=Gn,S[15]=Jn,S[16]=Xn,S[17]=Wn,S[18]=Vn,_!==0&&(S[19]=_,d.length++),d};Math.imul||(T=N);function q(M,a,c){c.negative=a.negative^M.negative,c.length=M.length+a.length;for(var d=0,v=0,w=0;w<c.length-1;w++){var S=v;v=0;for(var _=d&67108863,y=Math.min(w,a.length-1),o=Math.max(0,w-M.length+1);o<=y;o++){var m=w-o,K=M.words[m]|0,k=a.words[o]|0,W=K*k,b=W&67108863;S=S+(W/67108864|0)|0,b=b+_|0,_=b&67108863,S=S+(b>>>26)|0,v+=S>>>26,S&=67108863}c.words[w]=_,d=S,S=v}return d!==0?c.words[w]=d:c.length--,c.strip()}function j(M,a,c){var d=new J;return d.mulp(M,a,c)}f.prototype.mulTo=function(a,c){var d,v=this.length+a.length;return this.length===10&&a.length===10?d=T(this,a,c):v<63?d=N(this,a,c):v<1024?d=q(this,a,c):d=j(this,a,c),d};function J(M,a){this.x=M,this.y=a}J.prototype.makeRBT=function(a){for(var c=new Array(a),d=f.prototype._countBits(a)-1,v=0;v<a;v++)c[v]=this.revBin(v,d,a);return c},J.prototype.revBin=function(a,c,d){if(a===0||a===d-1)return a;for(var v=0,w=0;w<c;w++)v|=(a&1)<<c-w-1,a>>=1;return v},J.prototype.permute=function(a,c,d,v,w,S){for(var _=0;_<S;_++)v[_]=c[a[_]],w[_]=d[a[_]]},J.prototype.transform=function(a,c,d,v,w,S){this.permute(S,a,c,d,v,w);for(var _=1;_<w;_<<=1)for(var y=_<<1,o=Math.cos(2*Math.PI/y),m=Math.sin(2*Math.PI/y),K=0;K<w;K+=y)for(var k=o,W=m,b=0;b<_;b++){var R=d[K+b],E=v[K+b],C=d[K+b+_],B=v[K+b+_],s=k*C-W*B;B=k*B+W*C,C=s,d[K+b]=R+C,v[K+b]=E+B,d[K+b+_]=R-C,v[K+b+_]=E-B,b!==y&&(s=o*k-m*W,W=o*W+m*k,k=s)}},J.prototype.guessLen13b=function(a,c){var d=Math.max(c,a)|1,v=d&1,w=0;for(d=d/2|0;d;d=d>>>1)w++;return 1<<w+1+v},J.prototype.conjugate=function(a,c,d){if(!(d<=1))for(var v=0;v<d/2;v++){var w=a[v];a[v]=a[d-v-1],a[d-v-1]=w,w=c[v],c[v]=-c[d-v-1],c[d-v-1]=-w}},J.prototype.normalize13b=function(a,c){for(var d=0,v=0;v<c/2;v++){var w=Math.round(a[2*v+1]/c)*8192+Math.round(a[2*v]/c)+d;a[v]=w&67108863,w<67108864?d=0:d=w/67108864|0}return a},J.prototype.convert13b=function(a,c,d,v){for(var w=0,S=0;S<c;S++)w=w+(a[S]|0),d[2*S]=w&8191,w=w>>>13,d[2*S+1]=w&8191,w=w>>>13;for(S=2*c;S<v;++S)d[S]=0;n(w===0),n((w&~8191)==0)},J.prototype.stub=function(a){for(var c=new Array(a),d=0;d<a;d++)c[d]=0;return c},J.prototype.mulp=function(a,c,d){var v=2*this.guessLen13b(a.length,c.length),w=this.makeRBT(v),S=this.stub(v),_=new Array(v),y=new Array(v),o=new Array(v),m=new Array(v),K=new Array(v),k=new Array(v),W=d.words;W.length=v,this.convert13b(a.words,a.length,_,v),this.convert13b(c.words,c.length,m,v),this.transform(_,S,y,o,v,w),this.transform(m,S,K,k,v,w);for(var b=0;b<v;b++){var R=y[b]*K[b]-o[b]*k[b];o[b]=y[b]*k[b]+o[b]*K[b],y[b]=R}return this.conjugate(y,o,v),this.transform(y,o,W,S,v,w),this.conjugate(W,S,v),this.normalize13b(W,v),d.negative=a.negative^c.negative,d.length=a.length+c.length,d.strip()},f.prototype.mul=function(a){var c=new f(null);return c.words=new Array(this.length+a.length),this.mulTo(a,c)},f.prototype.mulf=function(a){var c=new f(null);return c.words=new Array(this.length+a.length),j(this,a,c)},f.prototype.imul=function(a){return this.clone().mulTo(a,this)},f.prototype.imuln=function(a){n(typeof a=="number"),n(a<67108864);for(var c=0,d=0;d<this.length;d++){var v=(this.words[d]|0)*a,w=(v&67108863)+(c&67108863);c>>=26,c+=v/67108864|0,c+=w>>>26,this.words[d]=w&67108863}return c!==0&&(this.words[d]=c,this.length++),this},f.prototype.muln=function(a){return this.clone().imuln(a)},f.prototype.sqr=function(){return this.mul(this)},f.prototype.isqr=function(){return this.imul(this.clone())},f.prototype.pow=function(a){var c=U(a);if(c.length===0)return new f(1);for(var d=this,v=0;v<c.length&&c[v]===0;v++,d=d.sqr());if(++v<c.length)for(var w=d.sqr();v<c.length;v++,w=w.sqr())c[v]!==0&&(d=d.mul(w));return d},f.prototype.iushln=function(a){n(typeof a=="number"&&a>=0);var c=a%26,d=(a-c)/26,v=67108863>>>26-c<<26-c,w;if(c!==0){var S=0;for(w=0;w<this.length;w++){var _=this.words[w]&v,y=(this.words[w]|0)-_<<c;this.words[w]=y|S,S=_>>>26-c}S&&(this.words[w]=S,this.length++)}if(d!==0){for(w=this.length-1;w>=0;w--)this.words[w+d]=this.words[w];for(w=0;w<d;w++)this.words[w]=0;this.length+=d}return this.strip()},f.prototype.ishln=function(a){return n(this.negative===0),this.iushln(a)},f.prototype.iushrn=function(a,c,d){n(typeof a=="number"&&a>=0);var v;c?v=(c-c%26)/26:v=0;var w=a%26,S=Math.min((a-w)/26,this.length),_=67108863^67108863>>>w<<w,y=d;if(v-=S,v=Math.max(0,v),y){for(var o=0;o<S;o++)y.words[o]=this.words[o];y.length=S}if(S!==0)if(this.length>S)for(this.length-=S,o=0;o<this.length;o++)this.words[o]=this.words[o+S];else this.words[0]=0,this.length=1;var m=0;for(o=this.length-1;o>=0&&(m!==0||o>=v);o--){var K=this.words[o]|0;this.words[o]=m<<26-w|K>>>w,m=K&_}return y&&m!==0&&(y.words[y.length++]=m),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},f.prototype.ishrn=function(a,c,d){return n(this.negative===0),this.iushrn(a,c,d)},f.prototype.shln=function(a){return this.clone().ishln(a)},f.prototype.ushln=function(a){return this.clone().iushln(a)},f.prototype.shrn=function(a){return this.clone().ishrn(a)},f.prototype.ushrn=function(a){return this.clone().iushrn(a)},f.prototype.testn=function(a){n(typeof a=="number"&&a>=0);var c=a%26,d=(a-c)/26,v=1<<c;if(this.length<=d)return!1;var w=this.words[d];return!!(w&v)},f.prototype.imaskn=function(a){n(typeof a=="number"&&a>=0);var c=a%26,d=(a-c)/26;if(n(this.negative===0,"imaskn works only with positive numbers"),this.length<=d)return this;if(c!==0&&d++,this.length=Math.min(d,this.length),c!==0){var v=67108863^67108863>>>c<<c;this.words[this.length-1]&=v}return this.strip()},f.prototype.maskn=function(a){return this.clone().imaskn(a)},f.prototype.iaddn=function(a){return n(typeof a=="number"),n(a<67108864),a<0?this.isubn(-a):this.negative!==0?this.length===1&&(this.words[0]|0)<a?(this.words[0]=a-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(a),this.negative=1,this):this._iaddn(a)},f.prototype._iaddn=function(a){this.words[0]+=a;for(var c=0;c<this.length&&this.words[c]>=67108864;c++)this.words[c]-=67108864,c===this.length-1?this.words[c+1]=1:this.words[c+1]++;return this.length=Math.max(this.length,c+1),this},f.prototype.isubn=function(a){if(n(typeof a=="number"),n(a<67108864),a<0)return this.iaddn(-a);if(this.negative!==0)return this.negative=0,this.iaddn(a),this.negative=1,this;if(this.words[0]-=a,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var c=0;c<this.length&&this.words[c]<0;c++)this.words[c]+=67108864,this.words[c+1]-=1;return this.strip()},f.prototype.addn=function(a){return this.clone().iaddn(a)},f.prototype.subn=function(a){return this.clone().isubn(a)},f.prototype.iabs=function(){return this.negative=0,this},f.prototype.abs=function(){return this.clone().iabs()},f.prototype._ishlnsubmul=function(a,c,d){var v=a.length+d,w;this._expand(v);var S,_=0;for(w=0;w<a.length;w++){S=(this.words[w+d]|0)+_;var y=(a.words[w]|0)*c;S-=y&67108863,_=(S>>26)-(y/67108864|0),this.words[w+d]=S&67108863}for(;w<this.length-d;w++)S=(this.words[w+d]|0)+_,_=S>>26,this.words[w+d]=S&67108863;if(_===0)return this.strip();for(n(_===-1),_=0,w=0;w<this.length;w++)S=-(this.words[w]|0)+_,_=S>>26,this.words[w]=S&67108863;return this.negative=1,this.strip()},f.prototype._wordDiv=function(a,c){var d=this.length-a.length,v=this.clone(),w=a,S=w.words[w.length-1]|0,_=this._countBits(S);d=26-_,d!==0&&(w=w.ushln(d),v.iushln(d),S=w.words[w.length-1]|0);var y=v.length-w.length,o;if(c!=="mod"){o=new f(null),o.length=y+1,o.words=new Array(o.length);for(var m=0;m<o.length;m++)o.words[m]=0}var K=v.clone()._ishlnsubmul(w,1,y);K.negative===0&&(v=K,o&&(o.words[y]=1));for(var k=y-1;k>=0;k--){var W=(v.words[w.length+k]|0)*67108864+(v.words[w.length+k-1]|0);for(W=Math.min(W/S|0,67108863),v._ishlnsubmul(w,W,k);v.negative!==0;)W--,v.negative=0,v._ishlnsubmul(w,1,k),v.isZero()||(v.negative^=1);o&&(o.words[k]=W)}return o&&o.strip(),v.strip(),c!=="div"&&d!==0&&v.iushrn(d),{div:o||null,mod:v}},f.prototype.divmod=function(a,c,d){if(n(!a.isZero()),this.isZero())return{div:new f(0),mod:new f(0)};var v,w,S;return this.negative!==0&&a.negative===0?(S=this.neg().divmod(a,c),c!=="mod"&&(v=S.div.neg()),c!=="div"&&(w=S.mod.neg(),d&&w.negative!==0&&w.iadd(a)),{div:v,mod:w}):this.negative===0&&a.negative!==0?(S=this.divmod(a.neg(),c),c!=="mod"&&(v=S.div.neg()),{div:v,mod:S.mod}):(this.negative&a.negative)!=0?(S=this.neg().divmod(a.neg(),c),c!=="div"&&(w=S.mod.neg(),d&&w.negative!==0&&w.isub(a)),{div:S.div,mod:w}):a.length>this.length||this.cmp(a)<0?{div:new f(0),mod:this}:a.length===1?c==="div"?{div:this.divn(a.words[0]),mod:null}:c==="mod"?{div:null,mod:new f(this.modn(a.words[0]))}:{div:this.divn(a.words[0]),mod:new f(this.modn(a.words[0]))}:this._wordDiv(a,c)},f.prototype.div=function(a){return this.divmod(a,"div",!1).div},f.prototype.mod=function(a){return this.divmod(a,"mod",!1).mod},f.prototype.umod=function(a){return this.divmod(a,"mod",!0).mod},f.prototype.divRound=function(a){var c=this.divmod(a);if(c.mod.isZero())return c.div;var d=c.div.negative!==0?c.mod.isub(a):c.mod,v=a.ushrn(1),w=a.andln(1),S=d.cmp(v);return S<0||w===1&&S===0?c.div:c.div.negative!==0?c.div.isubn(1):c.div.iaddn(1)},f.prototype.modn=function(a){n(a<=67108863);for(var c=(1<<26)%a,d=0,v=this.length-1;v>=0;v--)d=(c*d+(this.words[v]|0))%a;return d},f.prototype.idivn=function(a){n(a<=67108863);for(var c=0,d=this.length-1;d>=0;d--){var v=(this.words[d]|0)+c*67108864;this.words[d]=v/a|0,c=v%a}return this.strip()},f.prototype.divn=function(a){return this.clone().idivn(a)},f.prototype.egcd=function(a){n(a.negative===0),n(!a.isZero());var c=this,d=a.clone();c.negative!==0?c=c.umod(a):c=c.clone();for(var v=new f(1),w=new f(0),S=new f(0),_=new f(1),y=0;c.isEven()&&d.isEven();)c.iushrn(1),d.iushrn(1),++y;for(var o=d.clone(),m=c.clone();!c.isZero();){for(var K=0,k=1;(c.words[0]&k)==0&&K<26;++K,k<<=1);if(K>0)for(c.iushrn(K);K-- >0;)(v.isOdd()||w.isOdd())&&(v.iadd(o),w.isub(m)),v.iushrn(1),w.iushrn(1);for(var W=0,b=1;(d.words[0]&b)==0&&W<26;++W,b<<=1);if(W>0)for(d.iushrn(W);W-- >0;)(S.isOdd()||_.isOdd())&&(S.iadd(o),_.isub(m)),S.iushrn(1),_.iushrn(1);c.cmp(d)>=0?(c.isub(d),v.isub(S),w.isub(_)):(d.isub(c),S.isub(v),_.isub(w))}return{a:S,b:_,gcd:d.iushln(y)}},f.prototype._invmp=function(a){n(a.negative===0),n(!a.isZero());var c=this,d=a.clone();c.negative!==0?c=c.umod(a):c=c.clone();for(var v=new f(1),w=new f(0),S=d.clone();c.cmpn(1)>0&&d.cmpn(1)>0;){for(var _=0,y=1;(c.words[0]&y)==0&&_<26;++_,y<<=1);if(_>0)for(c.iushrn(_);_-- >0;)v.isOdd()&&v.iadd(S),v.iushrn(1);for(var o=0,m=1;(d.words[0]&m)==0&&o<26;++o,m<<=1);if(o>0)for(d.iushrn(o);o-- >0;)w.isOdd()&&w.iadd(S),w.iushrn(1);c.cmp(d)>=0?(c.isub(d),v.isub(w)):(d.isub(c),w.isub(v))}var K;return c.cmpn(1)===0?K=v:K=w,K.cmpn(0)<0&&K.iadd(a),K},f.prototype.gcd=function(a){if(this.isZero())return a.abs();if(a.isZero())return this.abs();var c=this.clone(),d=a.clone();c.negative=0,d.negative=0;for(var v=0;c.isEven()&&d.isEven();v++)c.iushrn(1),d.iushrn(1);do{for(;c.isEven();)c.iushrn(1);for(;d.isEven();)d.iushrn(1);var w=c.cmp(d);if(w<0){var S=c;c=d,d=S}else if(w===0||d.cmpn(1)===0)break;c.isub(d)}while(!0);return d.iushln(v)},f.prototype.invm=function(a){return this.egcd(a).a.umod(a)},f.prototype.isEven=function(){return(this.words[0]&1)==0},f.prototype.isOdd=function(){return(this.words[0]&1)==1},f.prototype.andln=function(a){return this.words[0]&a},f.prototype.bincn=function(a){n(typeof a=="number");var c=a%26,d=(a-c)/26,v=1<<c;if(this.length<=d)return this._expand(d+1),this.words[d]|=v,this;for(var w=v,S=d;w!==0&&S<this.length;S++){var _=this.words[S]|0;_+=w,w=_>>>26,_&=67108863,this.words[S]=_}return w!==0&&(this.words[S]=w,this.length++),this},f.prototype.isZero=function(){return this.length===1&&this.words[0]===0},f.prototype.cmpn=function(a){var c=a<0;if(this.negative!==0&&!c)return-1;if(this.negative===0&&c)return 1;this.strip();var d;if(this.length>1)d=1;else{c&&(a=-a),n(a<=67108863,"Number is too big");var v=this.words[0]|0;d=v===a?0:v<a?-1:1}return this.negative!==0?-d|0:d},f.prototype.cmp=function(a){if(this.negative!==0&&a.negative===0)return-1;if(this.negative===0&&a.negative!==0)return 1;var c=this.ucmp(a);return this.negative!==0?-c|0:c},f.prototype.ucmp=function(a){if(this.length>a.length)return 1;if(this.length<a.length)return-1;for(var c=0,d=this.length-1;d>=0;d--){var v=this.words[d]|0,w=a.words[d]|0;if(v!==w){v<w?c=-1:v>w&&(c=1);break}}return c},f.prototype.gtn=function(a){return this.cmpn(a)===1},f.prototype.gt=function(a){return this.cmp(a)===1},f.prototype.gten=function(a){return this.cmpn(a)>=0},f.prototype.gte=function(a){return this.cmp(a)>=0},f.prototype.ltn=function(a){return this.cmpn(a)===-1},f.prototype.lt=function(a){return this.cmp(a)===-1},f.prototype.lten=function(a){return this.cmpn(a)<=0},f.prototype.lte=function(a){return this.cmp(a)<=0},f.prototype.eqn=function(a){return this.cmpn(a)===0},f.prototype.eq=function(a){return this.cmp(a)===0},f.red=function(a){return new F(a)},f.prototype.toRed=function(a){return n(!this.red,"Already a number in reduction context"),n(this.negative===0,"red works only with positives"),a.convertTo(this)._forceRed(a)},f.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},f.prototype._forceRed=function(a){return this.red=a,this},f.prototype.forceRed=function(a){return n(!this.red,"Already a number in reduction context"),this._forceRed(a)},f.prototype.redAdd=function(a){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,a)},f.prototype.redIAdd=function(a){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,a)},f.prototype.redSub=function(a){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,a)},f.prototype.redISub=function(a){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,a)},f.prototype.redShl=function(a){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,a)},f.prototype.redMul=function(a){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,a),this.red.mul(this,a)},f.prototype.redIMul=function(a){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,a),this.red.imul(this,a)},f.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},f.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},f.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},f.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},f.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},f.prototype.redPow=function(a){return n(this.red&&!a.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,a)};var X={k256:null,p224:null,p192:null,p25519:null};function P(M,a){this.name=M,this.p=new f(a,16),this.n=this.p.bitLength(),this.k=new f(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}P.prototype._tmp=function(){var a=new f(null);return a.words=new Array(Math.ceil(this.n/13)),a},P.prototype.ireduce=function(a){var c=a,d;do this.split(c,this.tmp),c=this.imulK(c),c=c.iadd(this.tmp),d=c.bitLength();while(d>this.n);var v=d<this.n?-1:c.ucmp(this.p);return v===0?(c.words[0]=0,c.length=1):v>0?c.isub(this.p):c.strip!==void 0?c.strip():c._strip(),c},P.prototype.split=function(a,c){a.iushrn(this.n,0,c)},P.prototype.imulK=function(a){return a.imul(this.k)};function O(){P.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}i(O,P),O.prototype.split=function(a,c){for(var d=4194303,v=Math.min(a.length,9),w=0;w<v;w++)c.words[w]=a.words[w];if(c.length=v,a.length<=9){a.words[0]=0,a.length=1;return}var S=a.words[9];for(c.words[c.length++]=S&d,w=10;w<a.length;w++){var _=a.words[w]|0;a.words[w-10]=(_&d)<<4|S>>>22,S=_}S>>>=22,a.words[w-10]=S,S===0&&a.length>10?a.length-=10:a.length-=9},O.prototype.imulK=function(a){a.words[a.length]=0,a.words[a.length+1]=0,a.length+=2;for(var c=0,d=0;d<a.length;d++){var v=a.words[d]|0;c+=v*977,a.words[d]=c&67108863,c=v*64+(c/67108864|0)}return a.words[a.length-1]===0&&(a.length--,a.words[a.length-1]===0&&a.length--),a};function z(){P.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}i(z,P);function h(){P.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}i(h,P);function $(){P.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}i($,P),$.prototype.imulK=function(a){for(var c=0,d=0;d<a.length;d++){var v=(a.words[d]|0)*19+c,w=v&67108863;v>>>=26,a.words[d]=w,c=v}return c!==0&&(a.words[a.length++]=c),a},f._prime=function(a){if(X[a])return X[a];var c;if(a==="k256")c=new O;else if(a==="p224")c=new z;else if(a==="p192")c=new h;else if(a==="p25519")c=new $;else throw new Error("Unknown prime "+a);return X[a]=c,c};function F(M){if(typeof M=="string"){var a=f._prime(M);this.m=a.p,this.prime=a}else n(M.gtn(1),"modulus must be greater than 1"),this.m=M,this.prime=null}F.prototype._verify1=function(a){n(a.negative===0,"red works only with positives"),n(a.red,"red works only with red numbers")},F.prototype._verify2=function(a,c){n((a.negative|c.negative)==0,"red works only with positives"),n(a.red&&a.red===c.red,"red works only with red numbers")},F.prototype.imod=function(a){return this.prime?this.prime.ireduce(a)._forceRed(this):a.umod(this.m)._forceRed(this)},F.prototype.neg=function(a){return a.isZero()?a.clone():this.m.sub(a)._forceRed(this)},F.prototype.add=function(a,c){this._verify2(a,c);var d=a.add(c);return d.cmp(this.m)>=0&&d.isub(this.m),d._forceRed(this)},F.prototype.iadd=function(a,c){this._verify2(a,c);var d=a.iadd(c);return d.cmp(this.m)>=0&&d.isub(this.m),d},F.prototype.sub=function(a,c){this._verify2(a,c);var d=a.sub(c);return d.cmpn(0)<0&&d.iadd(this.m),d._forceRed(this)},F.prototype.isub=function(a,c){this._verify2(a,c);var d=a.isub(c);return d.cmpn(0)<0&&d.iadd(this.m),d},F.prototype.shl=function(a,c){return this._verify1(a),this.imod(a.ushln(c))},F.prototype.imul=function(a,c){return this._verify2(a,c),this.imod(a.imul(c))},F.prototype.mul=function(a,c){return this._verify2(a,c),this.imod(a.mul(c))},F.prototype.isqr=function(a){return this.imul(a,a.clone())},F.prototype.sqr=function(a){return this.mul(a,a)},F.prototype.sqrt=function(a){if(a.isZero())return a.clone();var c=this.m.andln(3);if(n(c%2==1),c===3){var d=this.m.add(new f(1)).iushrn(2);return this.pow(a,d)}for(var v=this.m.subn(1),w=0;!v.isZero()&&v.andln(1)===0;)w++,v.iushrn(1);n(!v.isZero());var S=new f(1).toRed(this),_=S.redNeg(),y=this.m.subn(1).iushrn(1),o=this.m.bitLength();for(o=new f(2*o*o).toRed(this);this.pow(o,y).cmp(_)!==0;)o.redIAdd(_);for(var m=this.pow(o,v),K=this.pow(a,v.addn(1).iushrn(1)),k=this.pow(a,v),W=w;k.cmp(S)!==0;){for(var b=k,R=0;b.cmp(S)!==0;R++)b=b.redSqr();n(R<W);var E=this.pow(m,new f(1).iushln(W-R-1));K=K.redMul(E),m=E.redSqr(),k=k.redMul(m),W=R}return K},F.prototype.invm=function(a){var c=a._invmp(this.m);return c.negative!==0?(c.negative=0,this.imod(c).redNeg()):this.imod(c)},F.prototype.pow=function(a,c){if(c.isZero())return new f(1).toRed(this);if(c.cmpn(1)===0)return a.clone();var d=4,v=new Array(1<<d);v[0]=new f(1).toRed(this),v[1]=a;for(var w=2;w<v.length;w++)v[w]=this.mul(v[w-1],a);var S=v[0],_=0,y=0,o=c.bitLength()%26;for(o===0&&(o=26),w=c.length-1;w>=0;w--){for(var m=c.words[w],K=o-1;K>=0;K--){var k=m>>K&1;if(S!==v[0]&&(S=this.sqr(S)),k===0&&_===0){y=0;continue}_<<=1,_|=k,y++,!(y!==d&&(w!==0||K!==0))&&(S=this.mul(S,v[_]),y=0,_=0)}o=26}return S},F.prototype.convertTo=function(a){var c=a.umod(this.m);return c===a?c.clone():c},F.prototype.convertFrom=function(a){var c=a.clone();return c.red=null,c},f.mont=function(a){return new G(a)};function G(M){F.call(this,M),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new f(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}i(G,F),G.prototype.convertTo=function(a){return this.imod(a.ushln(this.shift))},G.prototype.convertFrom=function(a){var c=this.imod(a.mul(this.rinv));return c.red=null,c},G.prototype.imul=function(a,c){if(a.isZero()||c.isZero())return a.words[0]=0,a.length=1,a;var d=a.imul(c),v=d.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),w=d.isub(v).iushrn(this.shift),S=w;return w.cmp(this.m)>=0?S=w.isub(this.m):w.cmpn(0)<0&&(S=w.iadd(this.m)),S._forceRed(this)},G.prototype.mul=function(a,c){if(a.isZero()||c.isZero())return new f(0)._forceRed(this);var d=a.mul(c),v=d.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),w=d.isub(v).iushrn(this.shift),S=w;return w.cmp(this.m)>=0?S=w.isub(this.m):w.cmpn(0)<0&&(S=w.iadd(this.m)),S._forceRed(this)},G.prototype.invm=function(a){var c=this.imod(a._invmp(this.m).mul(this.r2));return c._forceRed(this)}})(e,me)})(_e);var rr=ji;function ji(e,t){if(!e)throw new Error(t||"Assertion failed")}ji.equal=function(t,r,n){if(t!=r)throw new Error(n||"Assertion failed: "+t+" != "+r)};var Yn={};(function(e){var t=e;function r(f,l){if(Array.isArray(f))return f.slice();if(!f)return[];var u=[];if(typeof f!="string"){for(var p=0;p<f.length;p++)u[p]=f[p]|0;return u}if(l==="hex"){f=f.replace(/[^a-z0-9]+/ig,""),f.length%2!=0&&(f="0"+f);for(var p=0;p<f.length;p+=2)u.push(parseInt(f[p]+f[p+1],16))}else for(var p=0;p<f.length;p++){var x=f.charCodeAt(p),g=x>>8,A=x&255;g?u.push(g,A):u.push(A)}return u}t.toArray=r;function n(f){return f.length===1?"0"+f:f}t.zero2=n;function i(f){for(var l="",u=0;u<f.length;u++)l+=n(f[u].toString(16));return l}t.toHex=i,t.encode=function(l,u){return u==="hex"?i(l):l}})(Yn);(function(e){var t=e,r=_e.exports,n=rr,i=Yn;t.assert=n,t.toArray=i.toArray,t.zero2=i.zero2,t.toHex=i.toHex,t.encode=i.encode;function f(g,A,L){var U=new Array(Math.max(g.bitLength(),L)+1);U.fill(0);for(var N=1<<A+1,T=g.clone(),q=0;q<U.length;q++){var j,J=T.andln(N-1);T.isOdd()?(J>(N>>1)-1?j=(N>>1)-J:j=J,T.isubn(j)):j=0,U[q]=j,T.iushrn(1)}return U}t.getNAF=f;function l(g,A){var L=[[],[]];g=g.clone(),A=A.clone();for(var U=0,N=0,T;g.cmpn(-U)>0||A.cmpn(-N)>0;){var q=g.andln(3)+U&3,j=A.andln(3)+N&3;q===3&&(q=-1),j===3&&(j=-1);var J;(q&1)==0?J=0:(T=g.andln(7)+U&7,(T===3||T===5)&&j===2?J=-q:J=q),L[0].push(J);var X;(j&1)==0?X=0:(T=A.andln(7)+N&7,(T===3||T===5)&&q===2?X=-j:X=j),L[1].push(X),2*U===J+1&&(U=1-U),2*N===X+1&&(N=1-N),g.iushrn(1),A.iushrn(1)}return L}t.getJSF=l;function u(g,A,L){var U="_"+A;g.prototype[A]=function(){return this[U]!==void 0?this[U]:this[U]=L.call(this)}}t.cachedProperty=u;function p(g){return typeof g=="string"?t.toArray(g,"hex"):g}t.parseBytes=p;function x(g){return new r(g,"hex","le")}t.intFromLE=x})(ce);var Qr={exports:{}},Zn;Qr.exports=function(t){return Zn||(Zn=new Ke(null)),Zn.generate(t)};function Ke(e){this.rand=e}Qr.exports.Rand=Ke;Ke.prototype.generate=function(t){return this._rand(t)};Ke.prototype._rand=function(t){if(this.rand.getBytes)return this.rand.getBytes(t);for(var r=new Uint8Array(t),n=0;n<r.length;n++)r[n]=this.rand.getByte();return r};if(typeof self=="object")self.crypto&&self.crypto.getRandomValues?Ke.prototype._rand=function(t){var r=new Uint8Array(t);return self.crypto.getRandomValues(r),r}:self.msCrypto&&self.msCrypto.getRandomValues?Ke.prototype._rand=function(t){var r=new Uint8Array(t);return self.msCrypto.getRandomValues(r),r}:typeof window=="object"&&(Ke.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var Ki=require("crypto");if(typeof Ki.randomBytes!="function")throw new Error("Not supported");Ke.prototype._rand=function(t){return Ki.randomBytes(t)}}catch{}var Qn={},nr=_e.exports,Lr=ce,tn=Lr.getNAF,po=Lr.getJSF,en=Lr.assert;function Ge(e,t){this.type=e,this.p=new nr(t.p,16),this.red=t.prime?nr.red(t.prime):nr.mont(this.p),this.zero=new nr(0).toRed(this.red),this.one=new nr(1).toRed(this.red),this.two=new nr(2).toRed(this.red),this.n=t.n&&new nr(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var rn=Ge;Ge.prototype.point=function(){throw new Error("Not implemented")};Ge.prototype.validate=function(){throw new Error("Not implemented")};Ge.prototype._fixedNafMul=function(t,r){en(t.precomputed);var n=t._getDoubles(),i=tn(r,1,this._bitLength),f=(1<<n.step+1)-(n.step%2==0?2:1);f/=3;var l=[],u,p;for(u=0;u<i.length;u+=n.step){p=0;for(var x=u+n.step-1;x>=u;x--)p=(p<<1)+i[x];l.push(p)}for(var g=this.jpoint(null,null,null),A=this.jpoint(null,null,null),L=f;L>0;L--){for(u=0;u<l.length;u++)p=l[u],p===L?A=A.mixedAdd(n.points[u]):p===-L&&(A=A.mixedAdd(n.points[u].neg()));g=g.add(A)}return g.toP()};Ge.prototype._wnafMul=function(t,r){var n=4,i=t._getNAFPoints(n);n=i.wnd;for(var f=i.points,l=tn(r,n,this._bitLength),u=this.jpoint(null,null,null),p=l.length-1;p>=0;p--){for(var x=0;p>=0&&l[p]===0;p--)x++;if(p>=0&&x++,u=u.dblp(x),p<0)break;var g=l[p];en(g!==0),t.type==="affine"?g>0?u=u.mixedAdd(f[g-1>>1]):u=u.mixedAdd(f[-g-1>>1].neg()):g>0?u=u.add(f[g-1>>1]):u=u.add(f[-g-1>>1].neg())}return t.type==="affine"?u.toP():u};Ge.prototype._wnafMulAdd=function(t,r,n,i,f){var l=this._wnafT1,u=this._wnafT2,p=this._wnafT3,x=0,g,A,L;for(g=0;g<i;g++){L=r[g];var U=L._getNAFPoints(t);l[g]=U.wnd,u[g]=U.points}for(g=i-1;g>=1;g-=2){var N=g-1,T=g;if(l[N]!==1||l[T]!==1){p[N]=tn(n[N],l[N],this._bitLength),p[T]=tn(n[T],l[T],this._bitLength),x=Math.max(p[N].length,x),x=Math.max(p[T].length,x);continue}var q=[r[N],null,null,r[T]];r[N].y.cmp(r[T].y)===0?(q[1]=r[N].add(r[T]),q[2]=r[N].toJ().mixedAdd(r[T].neg())):r[N].y.cmp(r[T].y.redNeg())===0?(q[1]=r[N].toJ().mixedAdd(r[T]),q[2]=r[N].add(r[T].neg())):(q[1]=r[N].toJ().mixedAdd(r[T]),q[2]=r[N].toJ().mixedAdd(r[T].neg()));var j=[-3,-1,-5,-7,0,7,5,1,3],J=po(n[N],n[T]);for(x=Math.max(J[0].length,x),p[N]=new Array(x),p[T]=new Array(x),A=0;A<x;A++){var X=J[0][A]|0,P=J[1][A]|0;p[N][A]=j[(X+1)*3+(P+1)],p[T][A]=0,u[N]=q}}var O=this.jpoint(null,null,null),z=this._wnafT4;for(g=x;g>=0;g--){for(var h=0;g>=0;){var $=!0;for(A=0;A<i;A++)z[A]=p[A][g]|0,z[A]!==0&&($=!1);if(!$)break;h++,g--}if(g>=0&&h++,O=O.dblp(h),g<0)break;for(A=0;A<i;A++){var F=z[A];F!==0&&(F>0?L=u[A][F-1>>1]:F<0&&(L=u[A][-F-1>>1].neg()),L.type==="affine"?O=O.mixedAdd(L):O=O.add(L))}}for(g=0;g<i;g++)u[g]=null;return f?O:O.toP()};function le(e,t){this.curve=e,this.type=t,this.precomputed=null}Ge.BasePoint=le;le.prototype.eq=function(){throw new Error("Not implemented")};le.prototype.validate=function(){return this.curve.validate(this)};Ge.prototype.decodePoint=function(t,r){t=Lr.toArray(t,r);var n=this.p.byteLength();if((t[0]===4||t[0]===6||t[0]===7)&&t.length-1==2*n){t[0]===6?en(t[t.length-1]%2==0):t[0]===7&&en(t[t.length-1]%2==1);var i=this.point(t.slice(1,1+n),t.slice(1+n,1+2*n));return i}else if((t[0]===2||t[0]===3)&&t.length-1===n)return this.pointFromX(t.slice(1,1+n),t[0]===3);throw new Error("Unknown point format")};le.prototype.encodeCompressed=function(t){return this.encode(t,!0)};le.prototype._encode=function(t){var r=this.curve.p.byteLength(),n=this.getX().toArray("be",r);return t?[this.getY().isEven()?2:3].concat(n):[4].concat(n,this.getY().toArray("be",r))};le.prototype.encode=function(t,r){return Lr.encode(this._encode(r),t)};le.prototype.precompute=function(t){if(this.precomputed)return this;var r={doubles:null,naf:null,beta:null};return r.naf=this._getNAFPoints(8),r.doubles=this._getDoubles(4,t),r.beta=this._getBeta(),this.precomputed=r,this};le.prototype._hasDoubles=function(t){if(!this.precomputed)return!1;var r=this.precomputed.doubles;return r?r.points.length>=Math.ceil((t.bitLength()+1)/r.step):!1};le.prototype._getDoubles=function(t,r){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var n=[this],i=this,f=0;f<r;f+=t){for(var l=0;l<t;l++)i=i.dbl();n.push(i)}return{step:t,points:n}};le.prototype._getNAFPoints=function(t){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var r=[this],n=(1<<t)-1,i=n===1?null:this.dbl(),f=1;f<n;f++)r[f]=r[f-1].add(i);return{wnd:t,points:r}};le.prototype._getBeta=function(){return null};le.prototype.dblp=function(t){for(var r=this,n=0;n<t;n++)r=r.dbl();return r};var pr={exports:{}};typeof Object.create=="function"?pr.exports=function(t,r){r&&(t.super_=r,t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:pr.exports=function(t,r){if(r){t.super_=r;var n=function(){};n.prototype=r.prototype,t.prototype=new n,t.prototype.constructor=t}};var bo=ce,Yt=_e.exports,ti=pr.exports,br=rn,yo=bo.assert;function ve(e){br.call(this,"short",e),this.a=new Yt(e.a,16).toRed(this.red),this.b=new Yt(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(e),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}ti(ve,br);var go=ve;ve.prototype._getEndomorphism=function(t){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var r,n;if(t.beta)r=new Yt(t.beta,16).toRed(this.red);else{var i=this._getEndoRoots(this.p);r=i[0].cmp(i[1])<0?i[0]:i[1],r=r.toRed(this.red)}if(t.lambda)n=new Yt(t.lambda,16);else{var f=this._getEndoRoots(this.n);this.g.mul(f[0]).x.cmp(this.g.x.redMul(r))===0?n=f[0]:(n=f[1],yo(this.g.mul(n).x.cmp(this.g.x.redMul(r))===0))}var l;return t.basis?l=t.basis.map(function(u){return{a:new Yt(u.a,16),b:new Yt(u.b,16)}}):l=this._getEndoBasis(n),{beta:r,lambda:n,basis:l}}};ve.prototype._getEndoRoots=function(t){var r=t===this.p?this.red:Yt.mont(t),n=new Yt(2).toRed(r).redInvm(),i=n.redNeg(),f=new Yt(3).toRed(r).redNeg().redSqrt().redMul(n),l=i.redAdd(f).fromRed(),u=i.redSub(f).fromRed();return[l,u]};ve.prototype._getEndoBasis=function(t){for(var r=this.n.ushrn(Math.floor(this.n.bitLength()/2)),n=t,i=this.n.clone(),f=new Yt(1),l=new Yt(0),u=new Yt(0),p=new Yt(1),x,g,A,L,U,N,T,q=0,j,J;n.cmpn(0)!==0;){var X=i.div(n);j=i.sub(X.mul(n)),J=u.sub(X.mul(f));var P=p.sub(X.mul(l));if(!A&&j.cmp(r)<0)x=T.neg(),g=f,A=j.neg(),L=J;else if(A&&++q==2)break;T=j,i=n,n=j,u=f,f=J,p=l,l=P}U=j.neg(),N=J;var O=A.sqr().add(L.sqr()),z=U.sqr().add(N.sqr());return z.cmp(O)>=0&&(U=x,N=g),A.negative&&(A=A.neg(),L=L.neg()),U.negative&&(U=U.neg(),N=N.neg()),[{a:A,b:L},{a:U,b:N}]};ve.prototype._endoSplit=function(t){var r=this.endo.basis,n=r[0],i=r[1],f=i.b.mul(t).divRound(this.n),l=n.b.neg().mul(t).divRound(this.n),u=f.mul(n.a),p=l.mul(i.a),x=f.mul(n.b),g=l.mul(i.b),A=t.sub(u).sub(p),L=x.add(g).neg();return{k1:A,k2:L}};ve.prototype.pointFromX=function(t,r){t=new Yt(t,16),t.red||(t=t.toRed(this.red));var n=t.redSqr().redMul(t).redIAdd(t.redMul(this.a)).redIAdd(this.b),i=n.redSqrt();if(i.redSqr().redSub(n).cmp(this.zero)!==0)throw new Error("invalid point");var f=i.fromRed().isOdd();return(r&&!f||!r&&f)&&(i=i.redNeg()),this.point(t,i)};ve.prototype.validate=function(t){if(t.inf)return!0;var r=t.x,n=t.y,i=this.a.redMul(r),f=r.redSqr().redMul(r).redIAdd(i).redIAdd(this.b);return n.redSqr().redISub(f).cmpn(0)===0};ve.prototype._endoWnafMulAdd=function(t,r,n){for(var i=this._endoWnafT1,f=this._endoWnafT2,l=0;l<t.length;l++){var u=this._endoSplit(r[l]),p=t[l],x=p._getBeta();u.k1.negative&&(u.k1.ineg(),p=p.neg(!0)),u.k2.negative&&(u.k2.ineg(),x=x.neg(!0)),i[l*2]=p,i[l*2+1]=x,f[l*2]=u.k1,f[l*2+1]=u.k2}for(var g=this._wnafMulAdd(1,i,f,l*2,n),A=0;A<l*2;A++)i[A]=null,f[A]=null;return g};function Qt(e,t,r,n){br.BasePoint.call(this,e,"affine"),t===null&&r===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new Yt(t,16),this.y=new Yt(r,16),n&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}ti(Qt,br.BasePoint);ve.prototype.point=function(t,r,n){return new Qt(this,t,r,n)};ve.prototype.pointFromJSON=function(t,r){return Qt.fromJSON(this,t,r)};Qt.prototype._getBeta=function(){if(!!this.curve.endo){var t=this.precomputed;if(t&&t.beta)return t.beta;var r=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(t){var n=this.curve,i=function(f){return n.point(f.x.redMul(n.endo.beta),f.y)};t.beta=r,r.precomputed={beta:null,naf:t.naf&&{wnd:t.naf.wnd,points:t.naf.points.map(i)},doubles:t.doubles&&{step:t.doubles.step,points:t.doubles.points.map(i)}}}return r}};Qt.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};Qt.fromJSON=function(t,r,n){typeof r=="string"&&(r=JSON.parse(r));var i=t.point(r[0],r[1],n);if(!r[2])return i;function f(u){return t.point(u[0],u[1],n)}var l=r[2];return i.precomputed={beta:null,doubles:l.doubles&&{step:l.doubles.step,points:[i].concat(l.doubles.points.map(f))},naf:l.naf&&{wnd:l.naf.wnd,points:[i].concat(l.naf.points.map(f))}},i};Qt.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};Qt.prototype.isInfinity=function(){return this.inf};Qt.prototype.add=function(t){if(this.inf)return t;if(t.inf)return this;if(this.eq(t))return this.dbl();if(this.neg().eq(t))return this.curve.point(null,null);if(this.x.cmp(t.x)===0)return this.curve.point(null,null);var r=this.y.redSub(t.y);r.cmpn(0)!==0&&(r=r.redMul(this.x.redSub(t.x).redInvm()));var n=r.redSqr().redISub(this.x).redISub(t.x),i=r.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,i)};Qt.prototype.dbl=function(){if(this.inf)return this;var t=this.y.redAdd(this.y);if(t.cmpn(0)===0)return this.curve.point(null,null);var r=this.curve.a,n=this.x.redSqr(),i=t.redInvm(),f=n.redAdd(n).redIAdd(n).redIAdd(r).redMul(i),l=f.redSqr().redISub(this.x.redAdd(this.x)),u=f.redMul(this.x.redSub(l)).redISub(this.y);return this.curve.point(l,u)};Qt.prototype.getX=function(){return this.x.fromRed()};Qt.prototype.getY=function(){return this.y.fromRed()};Qt.prototype.mul=function(t){return t=new Yt(t,16),this.isInfinity()?this:this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve.endo?this.curve._endoWnafMulAdd([this],[t]):this.curve._wnafMul(this,t)};Qt.prototype.mulAdd=function(t,r,n){var i=[this,r],f=[t,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,f):this.curve._wnafMulAdd(1,i,f,2)};Qt.prototype.jmulAdd=function(t,r,n){var i=[this,r],f=[t,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,f,!0):this.curve._wnafMulAdd(1,i,f,2,!0)};Qt.prototype.eq=function(t){return this===t||this.inf===t.inf&&(this.inf||this.x.cmp(t.x)===0&&this.y.cmp(t.y)===0)};Qt.prototype.neg=function(t){if(this.inf)return this;var r=this.curve.point(this.x,this.y.redNeg());if(t&&this.precomputed){var n=this.precomputed,i=function(f){return f.neg()};r.precomputed={naf:n.naf&&{wnd:n.naf.wnd,points:n.naf.points.map(i)},doubles:n.doubles&&{step:n.doubles.step,points:n.doubles.points.map(i)}}}return r};Qt.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var t=this.curve.jpoint(this.x,this.y,this.curve.one);return t};function re(e,t,r,n){br.BasePoint.call(this,e,"jacobian"),t===null&&r===null&&n===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new Yt(0)):(this.x=new Yt(t,16),this.y=new Yt(r,16),this.z=new Yt(n,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}ti(re,br.BasePoint);ve.prototype.jpoint=function(t,r,n){return new re(this,t,r,n)};re.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var t=this.z.redInvm(),r=t.redSqr(),n=this.x.redMul(r),i=this.y.redMul(r).redMul(t);return this.curve.point(n,i)};re.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};re.prototype.add=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var r=t.z.redSqr(),n=this.z.redSqr(),i=this.x.redMul(r),f=t.x.redMul(n),l=this.y.redMul(r.redMul(t.z)),u=t.y.redMul(n.redMul(this.z)),p=i.redSub(f),x=l.redSub(u);if(p.cmpn(0)===0)return x.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var g=p.redSqr(),A=g.redMul(p),L=i.redMul(g),U=x.redSqr().redIAdd(A).redISub(L).redISub(L),N=x.redMul(L.redISub(U)).redISub(l.redMul(A)),T=this.z.redMul(t.z).redMul(p);return this.curve.jpoint(U,N,T)};re.prototype.mixedAdd=function(t){if(this.isInfinity())return t.toJ();if(t.isInfinity())return this;var r=this.z.redSqr(),n=this.x,i=t.x.redMul(r),f=this.y,l=t.y.redMul(r).redMul(this.z),u=n.redSub(i),p=f.redSub(l);if(u.cmpn(0)===0)return p.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var x=u.redSqr(),g=x.redMul(u),A=n.redMul(x),L=p.redSqr().redIAdd(g).redISub(A).redISub(A),U=p.redMul(A.redISub(L)).redISub(f.redMul(g)),N=this.z.redMul(u);return this.curve.jpoint(L,U,N)};re.prototype.dblp=function(t){if(t===0)return this;if(this.isInfinity())return this;if(!t)return this.dbl();var r;if(this.curve.zeroA||this.curve.threeA){var n=this;for(r=0;r<t;r++)n=n.dbl();return n}var i=this.curve.a,f=this.curve.tinv,l=this.x,u=this.y,p=this.z,x=p.redSqr().redSqr(),g=u.redAdd(u);for(r=0;r<t;r++){var A=l.redSqr(),L=g.redSqr(),U=L.redSqr(),N=A.redAdd(A).redIAdd(A).redIAdd(i.redMul(x)),T=l.redMul(L),q=N.redSqr().redISub(T.redAdd(T)),j=T.redISub(q),J=N.redMul(j);J=J.redIAdd(J).redISub(U);var X=g.redMul(p);r+1<t&&(x=x.redMul(U)),l=q,p=X,g=J}return this.curve.jpoint(l,g.redMul(f),p)};re.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};re.prototype._zeroDbl=function(){var t,r,n;if(this.zOne){var i=this.x.redSqr(),f=this.y.redSqr(),l=f.redSqr(),u=this.x.redAdd(f).redSqr().redISub(i).redISub(l);u=u.redIAdd(u);var p=i.redAdd(i).redIAdd(i),x=p.redSqr().redISub(u).redISub(u),g=l.redIAdd(l);g=g.redIAdd(g),g=g.redIAdd(g),t=x,r=p.redMul(u.redISub(x)).redISub(g),n=this.y.redAdd(this.y)}else{var A=this.x.redSqr(),L=this.y.redSqr(),U=L.redSqr(),N=this.x.redAdd(L).redSqr().redISub(A).redISub(U);N=N.redIAdd(N);var T=A.redAdd(A).redIAdd(A),q=T.redSqr(),j=U.redIAdd(U);j=j.redIAdd(j),j=j.redIAdd(j),t=q.redISub(N).redISub(N),r=T.redMul(N.redISub(t)).redISub(j),n=this.y.redMul(this.z),n=n.redIAdd(n)}return this.curve.jpoint(t,r,n)};re.prototype._threeDbl=function(){var t,r,n;if(this.zOne){var i=this.x.redSqr(),f=this.y.redSqr(),l=f.redSqr(),u=this.x.redAdd(f).redSqr().redISub(i).redISub(l);u=u.redIAdd(u);var p=i.redAdd(i).redIAdd(i).redIAdd(this.curve.a),x=p.redSqr().redISub(u).redISub(u);t=x;var g=l.redIAdd(l);g=g.redIAdd(g),g=g.redIAdd(g),r=p.redMul(u.redISub(x)).redISub(g),n=this.y.redAdd(this.y)}else{var A=this.z.redSqr(),L=this.y.redSqr(),U=this.x.redMul(L),N=this.x.redSub(A).redMul(this.x.redAdd(A));N=N.redAdd(N).redIAdd(N);var T=U.redIAdd(U);T=T.redIAdd(T);var q=T.redAdd(T);t=N.redSqr().redISub(q),n=this.y.redAdd(this.z).redSqr().redISub(L).redISub(A);var j=L.redSqr();j=j.redIAdd(j),j=j.redIAdd(j),j=j.redIAdd(j),r=N.redMul(T.redISub(t)).redISub(j)}return this.curve.jpoint(t,r,n)};re.prototype._dbl=function(){var t=this.curve.a,r=this.x,n=this.y,i=this.z,f=i.redSqr().redSqr(),l=r.redSqr(),u=n.redSqr(),p=l.redAdd(l).redIAdd(l).redIAdd(t.redMul(f)),x=r.redAdd(r);x=x.redIAdd(x);var g=x.redMul(u),A=p.redSqr().redISub(g.redAdd(g)),L=g.redISub(A),U=u.redSqr();U=U.redIAdd(U),U=U.redIAdd(U),U=U.redIAdd(U);var N=p.redMul(L).redISub(U),T=n.redAdd(n).redMul(i);return this.curve.jpoint(A,N,T)};re.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var t=this.x.redSqr(),r=this.y.redSqr(),n=this.z.redSqr(),i=r.redSqr(),f=t.redAdd(t).redIAdd(t),l=f.redSqr(),u=this.x.redAdd(r).redSqr().redISub(t).redISub(i);u=u.redIAdd(u),u=u.redAdd(u).redIAdd(u),u=u.redISub(l);var p=u.redSqr(),x=i.redIAdd(i);x=x.redIAdd(x),x=x.redIAdd(x),x=x.redIAdd(x);var g=f.redIAdd(u).redSqr().redISub(l).redISub(p).redISub(x),A=r.redMul(g);A=A.redIAdd(A),A=A.redIAdd(A);var L=this.x.redMul(p).redISub(A);L=L.redIAdd(L),L=L.redIAdd(L);var U=this.y.redMul(g.redMul(x.redISub(g)).redISub(u.redMul(p)));U=U.redIAdd(U),U=U.redIAdd(U),U=U.redIAdd(U);var N=this.z.redAdd(u).redSqr().redISub(n).redISub(p);return this.curve.jpoint(L,U,N)};re.prototype.mul=function(t,r){return t=new Yt(t,r),this.curve._wnafMul(this,t)};re.prototype.eq=function(t){if(t.type==="affine")return this.eq(t.toJ());if(this===t)return!0;var r=this.z.redSqr(),n=t.z.redSqr();if(this.x.redMul(n).redISub(t.x.redMul(r)).cmpn(0)!==0)return!1;var i=r.redMul(this.z),f=n.redMul(t.z);return this.y.redMul(f).redISub(t.y.redMul(i)).cmpn(0)===0};re.prototype.eqXToP=function(t){var r=this.z.redSqr(),n=t.toRed(this.curve.red).redMul(r);if(this.x.cmp(n)===0)return!0;for(var i=t.clone(),f=this.curve.redN.redMul(r);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(n.redIAdd(f),this.x.cmp(n)===0)return!0}};re.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};re.prototype.isInfinity=function(){return this.z.cmpn(0)===0};var yr=_e.exports,Gi=pr.exports,nn=rn,xo=ce;function gr(e){nn.call(this,"mont",e),this.a=new yr(e.a,16).toRed(this.red),this.b=new yr(e.b,16).toRed(this.red),this.i4=new yr(4).toRed(this.red).redInvm(),this.two=new yr(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}Gi(gr,nn);var wo=gr;gr.prototype.validate=function(t){var r=t.normalize().x,n=r.redSqr(),i=n.redMul(r).redAdd(n.redMul(this.a)).redAdd(r),f=i.redSqrt();return f.redSqr().cmp(i)===0};function te(e,t,r){nn.BasePoint.call(this,e,"projective"),t===null&&r===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new yr(t,16),this.z=new yr(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}Gi(te,nn.BasePoint);gr.prototype.decodePoint=function(t,r){return this.point(xo.toArray(t,r),1)};gr.prototype.point=function(t,r){return new te(this,t,r)};gr.prototype.pointFromJSON=function(t){return te.fromJSON(this,t)};te.prototype.precompute=function(){};te.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())};te.fromJSON=function(t,r){return new te(t,r[0],r[1]||t.one)};te.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};te.prototype.isInfinity=function(){return this.z.cmpn(0)===0};te.prototype.dbl=function(){var t=this.x.redAdd(this.z),r=t.redSqr(),n=this.x.redSub(this.z),i=n.redSqr(),f=r.redSub(i),l=r.redMul(i),u=f.redMul(i.redAdd(this.curve.a24.redMul(f)));return this.curve.point(l,u)};te.prototype.add=function(){throw new Error("Not supported on Montgomery curve")};te.prototype.diffAdd=function(t,r){var n=this.x.redAdd(this.z),i=this.x.redSub(this.z),f=t.x.redAdd(t.z),l=t.x.redSub(t.z),u=l.redMul(n),p=f.redMul(i),x=r.z.redMul(u.redAdd(p).redSqr()),g=r.x.redMul(u.redISub(p).redSqr());return this.curve.point(x,g)};te.prototype.mul=function(t){for(var r=t.clone(),n=this,i=this.curve.point(null,null),f=this,l=[];r.cmpn(0)!==0;r.iushrn(1))l.push(r.andln(1));for(var u=l.length-1;u>=0;u--)l[u]===0?(n=n.diffAdd(i,f),i=i.dbl()):(i=n.diffAdd(i,f),n=n.dbl());return i};te.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")};te.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")};te.prototype.eq=function(t){return this.getX().cmp(t.getX())===0};te.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this};te.prototype.getX=function(){return this.normalize(),this.x.fromRed()};var mo=ce,Le=_e.exports,Ji=pr.exports,fn=rn,_o=mo.assert;function Me(e){this.twisted=(e.a|0)!=1,this.mOneA=this.twisted&&(e.a|0)==-1,this.extended=this.mOneA,fn.call(this,"edwards",e),this.a=new Le(e.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new Le(e.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new Le(e.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),_o(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(e.c|0)==1}Ji(Me,fn);var Mo=Me;Me.prototype._mulA=function(t){return this.mOneA?t.redNeg():this.a.redMul(t)};Me.prototype._mulC=function(t){return this.oneC?t:this.c.redMul(t)};Me.prototype.jpoint=function(t,r,n,i){return this.point(t,r,n,i)};Me.prototype.pointFromX=function(t,r){t=new Le(t,16),t.red||(t=t.toRed(this.red));var n=t.redSqr(),i=this.c2.redSub(this.a.redMul(n)),f=this.one.redSub(this.c2.redMul(this.d).redMul(n)),l=i.redMul(f.redInvm()),u=l.redSqrt();if(u.redSqr().redSub(l).cmp(this.zero)!==0)throw new Error("invalid point");var p=u.fromRed().isOdd();return(r&&!p||!r&&p)&&(u=u.redNeg()),this.point(t,u)};Me.prototype.pointFromY=function(t,r){t=new Le(t,16),t.red||(t=t.toRed(this.red));var n=t.redSqr(),i=n.redSub(this.c2),f=n.redMul(this.d).redMul(this.c2).redSub(this.a),l=i.redMul(f.redInvm());if(l.cmp(this.zero)===0){if(r)throw new Error("invalid point");return this.point(this.zero,t)}var u=l.redSqrt();if(u.redSqr().redSub(l).cmp(this.zero)!==0)throw new Error("invalid point");return u.fromRed().isOdd()!==r&&(u=u.redNeg()),this.point(u,t)};Me.prototype.validate=function(t){if(t.isInfinity())return!0;t.normalize();var r=t.x.redSqr(),n=t.y.redSqr(),i=r.redMul(this.a).redAdd(n),f=this.c2.redMul(this.one.redAdd(this.d.redMul(r).redMul(n)));return i.cmp(f)===0};function qt(e,t,r,n,i){fn.BasePoint.call(this,e,"projective"),t===null&&r===null&&n===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new Le(t,16),this.y=new Le(r,16),this.z=n?new Le(n,16):this.curve.one,this.t=i&&new Le(i,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}Ji(qt,fn.BasePoint);Me.prototype.pointFromJSON=function(t){return qt.fromJSON(this,t)};Me.prototype.point=function(t,r,n,i){return new qt(this,t,r,n,i)};qt.fromJSON=function(t,r){return new qt(t,r[0],r[1],r[2])};qt.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};qt.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};qt.prototype._extDbl=function(){var t=this.x.redSqr(),r=this.y.redSqr(),n=this.z.redSqr();n=n.redIAdd(n);var i=this.curve._mulA(t),f=this.x.redAdd(this.y).redSqr().redISub(t).redISub(r),l=i.redAdd(r),u=l.redSub(n),p=i.redSub(r),x=f.redMul(u),g=l.redMul(p),A=f.redMul(p),L=u.redMul(l);return this.curve.point(x,g,L,A)};qt.prototype._projDbl=function(){var t=this.x.redAdd(this.y).redSqr(),r=this.x.redSqr(),n=this.y.redSqr(),i,f,l,u,p,x;if(this.curve.twisted){u=this.curve._mulA(r);var g=u.redAdd(n);this.zOne?(i=t.redSub(r).redSub(n).redMul(g.redSub(this.curve.two)),f=g.redMul(u.redSub(n)),l=g.redSqr().redSub(g).redSub(g)):(p=this.z.redSqr(),x=g.redSub(p).redISub(p),i=t.redSub(r).redISub(n).redMul(x),f=g.redMul(u.redSub(n)),l=g.redMul(x))}else u=r.redAdd(n),p=this.curve._mulC(this.z).redSqr(),x=u.redSub(p).redSub(p),i=this.curve._mulC(t.redISub(u)).redMul(x),f=this.curve._mulC(u).redMul(r.redISub(n)),l=u.redMul(x);return this.curve.point(i,f,l)};qt.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()};qt.prototype._extAdd=function(t){var r=this.y.redSub(this.x).redMul(t.y.redSub(t.x)),n=this.y.redAdd(this.x).redMul(t.y.redAdd(t.x)),i=this.t.redMul(this.curve.dd).redMul(t.t),f=this.z.redMul(t.z.redAdd(t.z)),l=n.redSub(r),u=f.redSub(i),p=f.redAdd(i),x=n.redAdd(r),g=l.redMul(u),A=p.redMul(x),L=l.redMul(x),U=u.redMul(p);return this.curve.point(g,A,U,L)};qt.prototype._projAdd=function(t){var r=this.z.redMul(t.z),n=r.redSqr(),i=this.x.redMul(t.x),f=this.y.redMul(t.y),l=this.curve.d.redMul(i).redMul(f),u=n.redSub(l),p=n.redAdd(l),x=this.x.redAdd(this.y).redMul(t.x.redAdd(t.y)).redISub(i).redISub(f),g=r.redMul(u).redMul(x),A,L;return this.curve.twisted?(A=r.redMul(p).redMul(f.redSub(this.curve._mulA(i))),L=u.redMul(p)):(A=r.redMul(p).redMul(f.redSub(i)),L=this.curve._mulC(u).redMul(p)),this.curve.point(g,A,L)};qt.prototype.add=function(t){return this.isInfinity()?t:t.isInfinity()?this:this.curve.extended?this._extAdd(t):this._projAdd(t)};qt.prototype.mul=function(t){return this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve._wnafMul(this,t)};qt.prototype.mulAdd=function(t,r,n){return this.curve._wnafMulAdd(1,[this,r],[t,n],2,!1)};qt.prototype.jmulAdd=function(t,r,n){return this.curve._wnafMulAdd(1,[this,r],[t,n],2,!0)};qt.prototype.normalize=function(){if(this.zOne)return this;var t=this.z.redInvm();return this.x=this.x.redMul(t),this.y=this.y.redMul(t),this.t&&(this.t=this.t.redMul(t)),this.z=this.curve.one,this.zOne=!0,this};qt.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};qt.prototype.getX=function(){return this.normalize(),this.x.fromRed()};qt.prototype.getY=function(){return this.normalize(),this.y.fromRed()};qt.prototype.eq=function(t){return this===t||this.getX().cmp(t.getX())===0&&this.getY().cmp(t.getY())===0};qt.prototype.eqXToP=function(t){var r=t.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(r)===0)return!0;for(var n=t.clone(),i=this.curve.redN.redMul(this.z);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(i),this.x.cmp(r)===0)return!0}};qt.prototype.toP=qt.prototype.normalize;qt.prototype.mixedAdd=qt.prototype.add;(function(e){var t=e;t.base=rn,t.short=go,t.mont=wo,t.edwards=Mo})(Qn);var an={},on={},Nt={},So=rr,Ao=pr.exports;Nt.inherits=Ao;function Eo(e,t){return(e.charCodeAt(t)&64512)!=55296||t<0||t+1>=e.length?!1:(e.charCodeAt(t+1)&64512)==56320}function Io(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var r=[];if(typeof e=="string")if(t){if(t==="hex")for(e=e.replace(/[^a-z0-9]+/ig,""),e.length%2!=0&&(e="0"+e),i=0;i<e.length;i+=2)r.push(parseInt(e[i]+e[i+1],16))}else for(var n=0,i=0;i<e.length;i++){var f=e.charCodeAt(i);f<128?r[n++]=f:f<2048?(r[n++]=f>>6|192,r[n++]=f&63|128):Eo(e,i)?(f=65536+((f&1023)<<10)+(e.charCodeAt(++i)&1023),r[n++]=f>>18|240,r[n++]=f>>12&63|128,r[n++]=f>>6&63|128,r[n++]=f&63|128):(r[n++]=f>>12|224,r[n++]=f>>6&63|128,r[n++]=f&63|128)}else for(i=0;i<e.length;i++)r[i]=e[i]|0;return r}Nt.toArray=Io;function Bo(e){for(var t="",r=0;r<e.length;r++)t+=Wi(e[r].toString(16));return t}Nt.toHex=Bo;function Xi(e){var t=e>>>24|e>>>8&65280|e<<8&16711680|(e&255)<<24;return t>>>0}Nt.htonl=Xi;function $o(e,t){for(var r="",n=0;n<e.length;n++){var i=e[n];t==="little"&&(i=Xi(i)),r+=Vi(i.toString(16))}return r}Nt.toHex32=$o;function Wi(e){return e.length===1?"0"+e:e}Nt.zero2=Wi;function Vi(e){return e.length===7?"0"+e:e.length===6?"00"+e:e.length===5?"000"+e:e.length===4?"0000"+e:e.length===3?"00000"+e:e.length===2?"000000"+e:e.length===1?"0000000"+e:e}Nt.zero8=Vi;function Uo(e,t,r,n){var i=r-t;So(i%4==0);for(var f=new Array(i/4),l=0,u=t;l<f.length;l++,u+=4){var p;n==="big"?p=e[u]<<24|e[u+1]<<16|e[u+2]<<8|e[u+3]:p=e[u+3]<<24|e[u+2]<<16|e[u+1]<<8|e[u],f[l]=p>>>0}return f}Nt.join32=Uo;function Co(e,t){for(var r=new Array(e.length*4),n=0,i=0;n<e.length;n++,i+=4){var f=e[n];t==="big"?(r[i]=f>>>24,r[i+1]=f>>>16&255,r[i+2]=f>>>8&255,r[i+3]=f&255):(r[i+3]=f>>>24,r[i+2]=f>>>16&255,r[i+1]=f>>>8&255,r[i]=f&255)}return r}Nt.split32=Co;function No(e,t){return e>>>t|e<<32-t}Nt.rotr32=No;function Lo(e,t){return e<<t|e>>>32-t}Nt.rotl32=Lo;function zo(e,t){return e+t>>>0}Nt.sum32=zo;function Po(e,t,r){return e+t+r>>>0}Nt.sum32_3=Po;function Ro(e,t,r,n){return e+t+r+n>>>0}Nt.sum32_4=Ro;function Oo(e,t,r,n,i){return e+t+r+n+i>>>0}Nt.sum32_5=Oo;function To(e,t,r,n){var i=e[t],f=e[t+1],l=n+f>>>0,u=(l<n?1:0)+r+i;e[t]=u>>>0,e[t+1]=l}Nt.sum64=To;function Do(e,t,r,n){var i=t+n>>>0,f=(i<t?1:0)+e+r;return f>>>0}Nt.sum64_hi=Do;function ko(e,t,r,n){var i=t+n;return i>>>0}Nt.sum64_lo=ko;function qo(e,t,r,n,i,f,l,u){var p=0,x=t;x=x+n>>>0,p+=x<t?1:0,x=x+f>>>0,p+=x<f?1:0,x=x+u>>>0,p+=x<u?1:0;var g=e+r+i+l+p;return g>>>0}Nt.sum64_4_hi=qo;function Fo(e,t,r,n,i,f,l,u){var p=t+n+f+u;return p>>>0}Nt.sum64_4_lo=Fo;function Ho(e,t,r,n,i,f,l,u,p,x){var g=0,A=t;A=A+n>>>0,g+=A<t?1:0,A=A+f>>>0,g+=A<f?1:0,A=A+u>>>0,g+=A<u?1:0,A=A+x>>>0,g+=A<x?1:0;var L=e+r+i+l+p+g;return L>>>0}Nt.sum64_5_hi=Ho;function jo(e,t,r,n,i,f,l,u,p,x){var g=t+n+f+u+x;return g>>>0}Nt.sum64_5_lo=jo;function Ko(e,t,r){var n=t<<32-r|e>>>r;return n>>>0}Nt.rotr64_hi=Ko;function Go(e,t,r){var n=e<<32-r|t>>>r;return n>>>0}Nt.rotr64_lo=Go;function Jo(e,t,r){return e>>>r}Nt.shr64_hi=Jo;function Xo(e,t,r){var n=e<<32-r|t>>>r;return n>>>0}Nt.shr64_lo=Xo;var xr={},Yi=Nt,Wo=rr;function sn(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}xr.BlockHash=sn;sn.prototype.update=function(t,r){if(t=Yi.toArray(t,r),this.pending?this.pending=this.pending.concat(t):this.pending=t,this.pendingTotal+=t.length,this.pending.length>=this._delta8){t=this.pending;var n=t.length%this._delta8;this.pending=t.slice(t.length-n,t.length),this.pending.length===0&&(this.pending=null),t=Yi.join32(t,0,t.length-n,this.endian);for(var i=0;i<t.length;i+=this._delta32)this._update(t,i,i+this._delta32)}return this};sn.prototype.digest=function(t){return this.update(this._pad()),Wo(this.pending===null),this._digest(t)};sn.prototype._pad=function(){var t=this.pendingTotal,r=this._delta8,n=r-(t+this.padLength)%r,i=new Array(n+this.padLength);i[0]=128;for(var f=1;f<n;f++)i[f]=0;if(t<<=3,this.endian==="big"){for(var l=8;l<this.padLength;l++)i[f++]=0;i[f++]=0,i[f++]=0,i[f++]=0,i[f++]=0,i[f++]=t>>>24&255,i[f++]=t>>>16&255,i[f++]=t>>>8&255,i[f++]=t&255}else for(i[f++]=t&255,i[f++]=t>>>8&255,i[f++]=t>>>16&255,i[f++]=t>>>24&255,i[f++]=0,i[f++]=0,i[f++]=0,i[f++]=0,l=8;l<this.padLength;l++)i[f++]=0;return i};var wr={},Se={},Vo=Nt,Ae=Vo.rotr32;function Yo(e,t,r,n){if(e===0)return Zi(t,r,n);if(e===1||e===3)return tf(t,r,n);if(e===2)return Qi(t,r,n)}Se.ft_1=Yo;function Zi(e,t,r){return e&t^~e&r}Se.ch32=Zi;function Qi(e,t,r){return e&t^e&r^t&r}Se.maj32=Qi;function tf(e,t,r){return e^t^r}Se.p32=tf;function Zo(e){return Ae(e,2)^Ae(e,13)^Ae(e,22)}Se.s0_256=Zo;function Qo(e){return Ae(e,6)^Ae(e,11)^Ae(e,25)}Se.s1_256=Qo;function ts(e){return Ae(e,7)^Ae(e,18)^e>>>3}Se.g0_256=ts;function es(e){return Ae(e,17)^Ae(e,19)^e>>>10}Se.g1_256=es;var mr=Nt,rs=xr,ns=Se,ei=mr.rotl32,zr=mr.sum32,is=mr.sum32_5,fs=ns.ft_1,ef=rs.BlockHash,as=[1518500249,1859775393,2400959708,3395469782];function Ee(){if(!(this instanceof Ee))return new Ee;ef.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}mr.inherits(Ee,ef);var os=Ee;Ee.blockSize=512;Ee.outSize=160;Ee.hmacStrength=80;Ee.padLength=64;Ee.prototype._update=function(t,r){for(var n=this.W,i=0;i<16;i++)n[i]=t[r+i];for(;i<n.length;i++)n[i]=ei(n[i-3]^n[i-8]^n[i-14]^n[i-16],1);var f=this.h[0],l=this.h[1],u=this.h[2],p=this.h[3],x=this.h[4];for(i=0;i<n.length;i++){var g=~~(i/20),A=is(ei(f,5),fs(g,l,u,p),x,n[i],as[g]);x=p,p=u,u=ei(l,30),l=f,f=A}this.h[0]=zr(this.h[0],f),this.h[1]=zr(this.h[1],l),this.h[2]=zr(this.h[2],u),this.h[3]=zr(this.h[3],p),this.h[4]=zr(this.h[4],x)};Ee.prototype._digest=function(t){return t==="hex"?mr.toHex32(this.h,"big"):mr.split32(this.h,"big")};var _r=Nt,ss=xr,Mr=Se,hs=rr,ge=_r.sum32,us=_r.sum32_4,cs=_r.sum32_5,ds=Mr.ch32,ls=Mr.maj32,vs=Mr.s0_256,ps=Mr.s1_256,bs=Mr.g0_256,ys=Mr.g1_256,rf=ss.BlockHash,gs=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Ie(){if(!(this instanceof Ie))return new Ie;rf.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=gs,this.W=new Array(64)}_r.inherits(Ie,rf);var nf=Ie;Ie.blockSize=512;Ie.outSize=256;Ie.hmacStrength=192;Ie.padLength=64;Ie.prototype._update=function(t,r){for(var n=this.W,i=0;i<16;i++)n[i]=t[r+i];for(;i<n.length;i++)n[i]=us(ys(n[i-2]),n[i-7],bs(n[i-15]),n[i-16]);var f=this.h[0],l=this.h[1],u=this.h[2],p=this.h[3],x=this.h[4],g=this.h[5],A=this.h[6],L=this.h[7];for(hs(this.k.length===n.length),i=0;i<n.length;i++){var U=cs(L,ps(x),ds(x,g,A),this.k[i],n[i]),N=ge(vs(f),ls(f,l,u));L=A,A=g,g=x,x=ge(p,U),p=u,u=l,l=f,f=ge(U,N)}this.h[0]=ge(this.h[0],f),this.h[1]=ge(this.h[1],l),this.h[2]=ge(this.h[2],u),this.h[3]=ge(this.h[3],p),this.h[4]=ge(this.h[4],x),this.h[5]=ge(this.h[5],g),this.h[6]=ge(this.h[6],A),this.h[7]=ge(this.h[7],L)};Ie.prototype._digest=function(t){return t==="hex"?_r.toHex32(this.h,"big"):_r.split32(this.h,"big")};var ri=Nt,ff=nf;function ze(){if(!(this instanceof ze))return new ze;ff.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}ri.inherits(ze,ff);var xs=ze;ze.blockSize=512;ze.outSize=224;ze.hmacStrength=192;ze.padLength=64;ze.prototype._digest=function(t){return t==="hex"?ri.toHex32(this.h.slice(0,7),"big"):ri.split32(this.h.slice(0,7),"big")};var he=Nt,ws=xr,ms=rr,Be=he.rotr64_hi,$e=he.rotr64_lo,af=he.shr64_hi,of=he.shr64_lo,Je=he.sum64,ni=he.sum64_hi,ii=he.sum64_lo,_s=he.sum64_4_hi,Ms=he.sum64_4_lo,Ss=he.sum64_5_hi,As=he.sum64_5_lo,sf=ws.BlockHash,Es=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function xe(){if(!(this instanceof xe))return new xe;sf.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=Es,this.W=new Array(160)}he.inherits(xe,sf);var hf=xe;xe.blockSize=1024;xe.outSize=512;xe.hmacStrength=192;xe.padLength=128;xe.prototype._prepareBlock=function(t,r){for(var n=this.W,i=0;i<32;i++)n[i]=t[r+i];for(;i<n.length;i+=2){var f=Os(n[i-4],n[i-3]),l=Ts(n[i-4],n[i-3]),u=n[i-14],p=n[i-13],x=Ps(n[i-30],n[i-29]),g=Rs(n[i-30],n[i-29]),A=n[i-32],L=n[i-31];n[i]=_s(f,l,u,p,x,g,A,L),n[i+1]=Ms(f,l,u,p,x,g,A,L)}};xe.prototype._update=function(t,r){this._prepareBlock(t,r);var n=this.W,i=this.h[0],f=this.h[1],l=this.h[2],u=this.h[3],p=this.h[4],x=this.h[5],g=this.h[6],A=this.h[7],L=this.h[8],U=this.h[9],N=this.h[10],T=this.h[11],q=this.h[12],j=this.h[13],J=this.h[14],X=this.h[15];ms(this.k.length===n.length);for(var P=0;P<n.length;P+=2){var O=J,z=X,h=Ls(L,U),$=zs(L,U),F=Is(L,U,N,T,q),G=Bs(L,U,N,T,q,j),M=this.k[P],a=this.k[P+1],c=n[P],d=n[P+1],v=Ss(O,z,h,$,F,G,M,a,c,d),w=As(O,z,h,$,F,G,M,a,c,d);O=Cs(i,f),z=Ns(i,f),h=$s(i,f,l,u,p),$=Us(i,f,l,u,p,x);var S=ni(O,z,h,$),_=ii(O,z,h,$);J=q,X=j,q=N,j=T,N=L,T=U,L=ni(g,A,v,w),U=ii(A,A,v,w),g=p,A=x,p=l,x=u,l=i,u=f,i=ni(v,w,S,_),f=ii(v,w,S,_)}Je(this.h,0,i,f),Je(this.h,2,l,u),Je(this.h,4,p,x),Je(this.h,6,g,A),Je(this.h,8,L,U),Je(this.h,10,N,T),Je(this.h,12,q,j),Je(this.h,14,J,X)};xe.prototype._digest=function(t){return t==="hex"?he.toHex32(this.h,"big"):he.split32(this.h,"big")};function Is(e,t,r,n,i){var f=e&r^~e&i;return f<0&&(f+=4294967296),f}function Bs(e,t,r,n,i,f){var l=t&n^~t&f;return l<0&&(l+=4294967296),l}function $s(e,t,r,n,i){var f=e&r^e&i^r&i;return f<0&&(f+=4294967296),f}function Us(e,t,r,n,i,f){var l=t&n^t&f^n&f;return l<0&&(l+=4294967296),l}function Cs(e,t){var r=Be(e,t,28),n=Be(t,e,2),i=Be(t,e,7),f=r^n^i;return f<0&&(f+=4294967296),f}function Ns(e,t){var r=$e(e,t,28),n=$e(t,e,2),i=$e(t,e,7),f=r^n^i;return f<0&&(f+=4294967296),f}function Ls(e,t){var r=Be(e,t,14),n=Be(e,t,18),i=Be(t,e,9),f=r^n^i;return f<0&&(f+=4294967296),f}function zs(e,t){var r=$e(e,t,14),n=$e(e,t,18),i=$e(t,e,9),f=r^n^i;return f<0&&(f+=4294967296),f}function Ps(e,t){var r=Be(e,t,1),n=Be(e,t,8),i=af(e,t,7),f=r^n^i;return f<0&&(f+=4294967296),f}function Rs(e,t){var r=$e(e,t,1),n=$e(e,t,8),i=of(e,t,7),f=r^n^i;return f<0&&(f+=4294967296),f}function Os(e,t){var r=Be(e,t,19),n=Be(t,e,29),i=af(e,t,6),f=r^n^i;return f<0&&(f+=4294967296),f}function Ts(e,t){var r=$e(e,t,19),n=$e(t,e,29),i=of(e,t,6),f=r^n^i;return f<0&&(f+=4294967296),f}var fi=Nt,uf=hf;function Pe(){if(!(this instanceof Pe))return new Pe;uf.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}fi.inherits(Pe,uf);var Ds=Pe;Pe.blockSize=1024;Pe.outSize=384;Pe.hmacStrength=192;Pe.padLength=128;Pe.prototype._digest=function(t){return t==="hex"?fi.toHex32(this.h.slice(0,12),"big"):fi.split32(this.h.slice(0,12),"big")};wr.sha1=os;wr.sha224=xs;wr.sha256=nf;wr.sha384=Ds;wr.sha512=hf;var cf={},ir=Nt,ks=xr,hn=ir.rotl32,df=ir.sum32,Pr=ir.sum32_3,lf=ir.sum32_4,vf=ks.BlockHash;function Ue(){if(!(this instanceof Ue))return new Ue;vf.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}ir.inherits(Ue,vf);cf.ripemd160=Ue;Ue.blockSize=512;Ue.outSize=160;Ue.hmacStrength=192;Ue.padLength=64;Ue.prototype._update=function(t,r){for(var n=this.h[0],i=this.h[1],f=this.h[2],l=this.h[3],u=this.h[4],p=n,x=i,g=f,A=l,L=u,U=0;U<80;U++){var N=df(hn(lf(n,pf(U,i,f,l),t[Hs[U]+r],qs(U)),Ks[U]),u);n=u,u=l,l=hn(f,10),f=i,i=N,N=df(hn(lf(p,pf(79-U,x,g,A),t[js[U]+r],Fs(U)),Gs[U]),L),p=L,L=A,A=hn(g,10),g=x,x=N}N=Pr(this.h[1],f,A),this.h[1]=Pr(this.h[2],l,L),this.h[2]=Pr(this.h[3],u,p),this.h[3]=Pr(this.h[4],n,x),this.h[4]=Pr(this.h[0],i,g),this.h[0]=N};Ue.prototype._digest=function(t){return t==="hex"?ir.toHex32(this.h,"little"):ir.split32(this.h,"little")};function pf(e,t,r,n){return e<=15?t^r^n:e<=31?t&r|~t&n:e<=47?(t|~r)^n:e<=63?t&n|r&~n:t^(r|~n)}function qs(e){return e<=15?0:e<=31?1518500249:e<=47?1859775393:e<=63?2400959708:2840853838}function Fs(e){return e<=15?1352829926:e<=31?1548603684:e<=47?1836072691:e<=63?2053994217:0}var Hs=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],js=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],Ks=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],Gs=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],Js=Nt,Xs=rr;function Sr(e,t,r){if(!(this instanceof Sr))return new Sr(e,t,r);this.Hash=e,this.blockSize=e.blockSize/8,this.outSize=e.outSize/8,this.inner=null,this.outer=null,this._init(Js.toArray(t,r))}var Ws=Sr;Sr.prototype._init=function(t){t.length>this.blockSize&&(t=new this.Hash().update(t).digest()),Xs(t.length<=this.blockSize);for(var r=t.length;r<this.blockSize;r++)t.push(0);for(r=0;r<t.length;r++)t[r]^=54;for(this.inner=new this.Hash().update(t),r=0;r<t.length;r++)t[r]^=106;this.outer=new this.Hash().update(t)};Sr.prototype.update=function(t,r){return this.inner.update(t,r),this};Sr.prototype.digest=function(t){return this.outer.update(this.inner.digest()),this.outer.digest(t)};(function(e){var t=e;t.utils=Nt,t.common=xr,t.sha=wr,t.ripemd=cf,t.hmac=Ws,t.sha1=t.sha.sha1,t.sha256=t.sha.sha256,t.sha224=t.sha.sha224,t.sha384=t.sha.sha384,t.sha512=t.sha.sha512,t.ripemd160=t.ripemd.ripemd160})(on);(function(e){var t=e,r=on,n=Qn,i=ce,f=i.assert;function l(x){x.type==="short"?this.curve=new n.short(x):x.type==="edwards"?this.curve=new n.edwards(x):this.curve=new n.mont(x),this.g=this.curve.g,this.n=this.curve.n,this.hash=x.hash,f(this.g.validate(),"Invalid curve"),f(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}t.PresetCurve=l;function u(x,g){Object.defineProperty(t,x,{configurable:!0,enumerable:!0,get:function(){var A=new l(g);return Object.defineProperty(t,x,{configurable:!0,enumerable:!0,value:A}),A}})}u("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:r.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),u("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:r.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),u("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:r.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),u("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:r.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),u("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:r.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),u("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:r.sha256,gRed:!1,g:["9"]}),u("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:r.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var p;try{p=require("./precomputed/secp256k1")}catch{p=void 0}u("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:r.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",p]})})(an);var Vs=on,fr=Yn,bf=rr;function Xe(e){if(!(this instanceof Xe))return new Xe(e);this.hash=e.hash,this.predResist=!!e.predResist,this.outLen=this.hash.outSize,this.minEntropy=e.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var t=fr.toArray(e.entropy,e.entropyEnc||"hex"),r=fr.toArray(e.nonce,e.nonceEnc||"hex"),n=fr.toArray(e.pers,e.persEnc||"hex");bf(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(t,r,n)}var Ys=Xe;Xe.prototype._init=function(t,r,n){var i=t.concat(r).concat(n);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var f=0;f<this.V.length;f++)this.K[f]=0,this.V[f]=1;this._update(i),this._reseed=1,this.reseedInterval=281474976710656};Xe.prototype._hmac=function(){return new Vs.hmac(this.hash,this.K)};Xe.prototype._update=function(t){var r=this._hmac().update(this.V).update([0]);t&&(r=r.update(t)),this.K=r.digest(),this.V=this._hmac().update(this.V).digest(),!!t&&(this.K=this._hmac().update(this.V).update([1]).update(t).digest(),this.V=this._hmac().update(this.V).digest())};Xe.prototype.reseed=function(t,r,n,i){typeof r!="string"&&(i=n,n=r,r=null),t=fr.toArray(t,r),n=fr.toArray(n,i),bf(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(t.concat(n||[])),this._reseed=1};Xe.prototype.generate=function(t,r,n,i){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof r!="string"&&(i=n,n=r,r=null),n&&(n=fr.toArray(n,i||"hex"),this._update(n));for(var f=[];f.length<t;)this.V=this._hmac().update(this.V).digest(),f=f.concat(this.V);var l=f.slice(0,t);return this._update(n),this._reseed++,fr.encode(l,r)};var Zs=_e.exports,Qs=ce,ai=Qs.assert;function fe(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}var th=fe;fe.fromPublic=function(t,r,n){return r instanceof fe?r:new fe(t,{pub:r,pubEnc:n})};fe.fromPrivate=function(t,r,n){return r instanceof fe?r:new fe(t,{priv:r,privEnc:n})};fe.prototype.validate=function(){var t=this.getPublic();return t.isInfinity()?{result:!1,reason:"Invalid public key"}:t.validate()?t.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};fe.prototype.getPublic=function(t,r){return typeof t=="string"&&(r=t,t=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),r?this.pub.encode(r,t):this.pub};fe.prototype.getPrivate=function(t){return t==="hex"?this.priv.toString(16,2):this.priv};fe.prototype._importPrivate=function(t,r){this.priv=new Zs(t,r||16),this.priv=this.priv.umod(this.ec.curve.n)};fe.prototype._importPublic=function(t,r){if(t.x||t.y){this.ec.curve.type==="mont"?ai(t.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&ai(t.x&&t.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(t.x,t.y);return}this.pub=this.ec.curve.decodePoint(t,r)};fe.prototype.derive=function(t){return t.validate()||ai(t.validate(),"public point not validated"),t.mul(this.priv).getX()};fe.prototype.sign=function(t,r,n){return this.ec.sign(t,this,r,n)};fe.prototype.verify=function(t,r){return this.ec.verify(t,r,this)};fe.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var un=_e.exports,oi=ce,eh=oi.assert;function cn(e,t){if(e instanceof cn)return e;this._importDER(e,t)||(eh(e.r&&e.s,"Signature without r or s"),this.r=new un(e.r,16),this.s=new un(e.s,16),e.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=e.recoveryParam)}var rh=cn;function nh(){this.place=0}function si(e,t){var r=e[t.place++];if(!(r&128))return r;var n=r&15;if(n===0||n>4)return!1;for(var i=0,f=0,l=t.place;f<n;f++,l++)i<<=8,i|=e[l],i>>>=0;return i<=127?!1:(t.place=l,i)}function yf(e){for(var t=0,r=e.length-1;!e[t]&&!(e[t+1]&128)&&t<r;)t++;return t===0?e:e.slice(t)}cn.prototype._importDER=function(t,r){t=oi.toArray(t,r);var n=new nh;if(t[n.place++]!==48)return!1;var i=si(t,n);if(i===!1||i+n.place!==t.length||t[n.place++]!==2)return!1;var f=si(t,n);if(f===!1)return!1;var l=t.slice(n.place,f+n.place);if(n.place+=f,t[n.place++]!==2)return!1;var u=si(t,n);if(u===!1||t.length!==u+n.place)return!1;var p=t.slice(n.place,u+n.place);if(l[0]===0)if(l[1]&128)l=l.slice(1);else return!1;if(p[0]===0)if(p[1]&128)p=p.slice(1);else return!1;return this.r=new un(l),this.s=new un(p),this.recoveryParam=null,!0};function hi(e,t){if(t<128){e.push(t);return}var r=1+(Math.log(t)/Math.LN2>>>3);for(e.push(r|128);--r;)e.push(t>>>(r<<3)&255);e.push(t)}cn.prototype.toDER=function(t){var r=this.r.toArray(),n=this.s.toArray();for(r[0]&128&&(r=[0].concat(r)),n[0]&128&&(n=[0].concat(n)),r=yf(r),n=yf(n);!n[0]&&!(n[1]&128);)n=n.slice(1);var i=[2];hi(i,r.length),i=i.concat(r),i.push(2),hi(i,n.length);var f=i.concat(n),l=[48];return hi(l,f.length),l=l.concat(f),oi.encode(l,t)};var ar=_e.exports,gf=Ys,ih=ce,ui=an,fh=Qr.exports,xf=ih.assert,ci=th,dn=rh;function pe(e){if(!(this instanceof pe))return new pe(e);typeof e=="string"&&(xf(Object.prototype.hasOwnProperty.call(ui,e),"Unknown curve "+e),e=ui[e]),e instanceof ui.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}var ah=pe;pe.prototype.keyPair=function(t){return new ci(this,t)};pe.prototype.keyFromPrivate=function(t,r){return ci.fromPrivate(this,t,r)};pe.prototype.keyFromPublic=function(t,r){return ci.fromPublic(this,t,r)};pe.prototype.genKeyPair=function(t){t||(t={});for(var r=new gf({hash:this.hash,pers:t.pers,persEnc:t.persEnc||"utf8",entropy:t.entropy||fh(this.hash.hmacStrength),entropyEnc:t.entropy&&t.entropyEnc||"utf8",nonce:this.n.toArray()}),n=this.n.byteLength(),i=this.n.sub(new ar(2));;){var f=new ar(r.generate(n));if(!(f.cmp(i)>0))return f.iaddn(1),this.keyFromPrivate(f)}};pe.prototype._truncateToN=function(t,r){var n=t.byteLength()*8-this.n.bitLength();return n>0&&(t=t.ushrn(n)),!r&&t.cmp(this.n)>=0?t.sub(this.n):t};pe.prototype.sign=function(t,r,n,i){typeof n=="object"&&(i=n,n=null),i||(i={}),r=this.keyFromPrivate(r,n),t=this._truncateToN(new ar(t,16));for(var f=this.n.byteLength(),l=r.getPrivate().toArray("be",f),u=t.toArray("be",f),p=new gf({hash:this.hash,entropy:l,nonce:u,pers:i.pers,persEnc:i.persEnc||"utf8"}),x=this.n.sub(new ar(1)),g=0;;g++){var A=i.k?i.k(g):new ar(p.generate(this.n.byteLength()));if(A=this._truncateToN(A,!0),!(A.cmpn(1)<=0||A.cmp(x)>=0)){var L=this.g.mul(A);if(!L.isInfinity()){var U=L.getX(),N=U.umod(this.n);if(N.cmpn(0)!==0){var T=A.invm(this.n).mul(N.mul(r.getPrivate()).iadd(t));if(T=T.umod(this.n),T.cmpn(0)!==0){var q=(L.getY().isOdd()?1:0)|(U.cmp(N)!==0?2:0);return i.canonical&&T.cmp(this.nh)>0&&(T=this.n.sub(T),q^=1),new dn({r:N,s:T,recoveryParam:q})}}}}}};pe.prototype.verify=function(t,r,n,i){t=this._truncateToN(new ar(t,16)),n=this.keyFromPublic(n,i),r=new dn(r,"hex");var f=r.r,l=r.s;if(f.cmpn(1)<0||f.cmp(this.n)>=0||l.cmpn(1)<0||l.cmp(this.n)>=0)return!1;var u=l.invm(this.n),p=u.mul(t).umod(this.n),x=u.mul(f).umod(this.n),g;return this.curve._maxwellTrick?(g=this.g.jmulAdd(p,n.getPublic(),x),g.isInfinity()?!1:g.eqXToP(f)):(g=this.g.mulAdd(p,n.getPublic(),x),g.isInfinity()?!1:g.getX().umod(this.n).cmp(f)===0)};pe.prototype.recoverPubKey=function(e,t,r,n){xf((3&r)===r,"The recovery param is more than two bits"),t=new dn(t,n);var i=this.n,f=new ar(e),l=t.r,u=t.s,p=r&1,x=r>>1;if(l.cmp(this.curve.p.umod(this.curve.n))>=0&&x)throw new Error("Unable to find sencond key candinate");x?l=this.curve.pointFromX(l.add(this.curve.n),p):l=this.curve.pointFromX(l,p);var g=t.r.invm(i),A=i.sub(f).mul(g).umod(i),L=u.mul(g).umod(i);return this.g.mulAdd(A,l,L)};pe.prototype.getKeyRecoveryParam=function(e,t,r,n){if(t=new dn(t,n),t.recoveryParam!==null)return t.recoveryParam;for(var i=0;i<4;i++){var f;try{f=this.recoverPubKey(e,t,i)}catch{continue}if(f.eq(r))return i}throw new Error("Unable to find valid recovery factor")};var Rr=ce,wf=Rr.assert,mf=Rr.parseBytes,Ar=Rr.cachedProperty;function ee(e,t){this.eddsa=e,this._secret=mf(t.secret),e.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=mf(t.pub)}ee.fromPublic=function(t,r){return r instanceof ee?r:new ee(t,{pub:r})};ee.fromSecret=function(t,r){return r instanceof ee?r:new ee(t,{secret:r})};ee.prototype.secret=function(){return this._secret};Ar(ee,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())});Ar(ee,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())});Ar(ee,"privBytes",function(){var t=this.eddsa,r=this.hash(),n=t.encodingLength-1,i=r.slice(0,t.encodingLength);return i[0]&=248,i[n]&=127,i[n]|=64,i});Ar(ee,"priv",function(){return this.eddsa.decodeInt(this.privBytes())});Ar(ee,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()});Ar(ee,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)});ee.prototype.sign=function(t){return wf(this._secret,"KeyPair can only verify"),this.eddsa.sign(t,this)};ee.prototype.verify=function(t,r){return this.eddsa.verify(t,r,this)};ee.prototype.getSecret=function(t){return wf(this._secret,"KeyPair is public only"),Rr.encode(this.secret(),t)};ee.prototype.getPublic=function(t){return Rr.encode(this.pubBytes(),t)};var oh=ee,sh=_e.exports,ln=ce,hh=ln.assert,vn=ln.cachedProperty,uh=ln.parseBytes;function or(e,t){this.eddsa=e,typeof t!="object"&&(t=uh(t)),Array.isArray(t)&&(t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),hh(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),t.S instanceof sh&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}vn(or,"S",function(){return this.eddsa.decodeInt(this.Sencoded())});vn(or,"R",function(){return this.eddsa.decodePoint(this.Rencoded())});vn(or,"Rencoded",function(){return this.eddsa.encodePoint(this.R())});vn(or,"Sencoded",function(){return this.eddsa.encodeInt(this.S())});or.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())};or.prototype.toHex=function(){return ln.encode(this.toBytes(),"hex").toUpperCase()};var ch=or,dh=on,lh=an,Er=ce,vh=Er.assert,_f=Er.parseBytes,Mf=oh,Sf=ch;function ue(e){if(vh(e==="ed25519","only tested with ed25519 so far"),!(this instanceof ue))return new ue(e);e=lh[e].curve,this.curve=e,this.g=e.g,this.g.precompute(e.n.bitLength()+1),this.pointClass=e.point().constructor,this.encodingLength=Math.ceil(e.n.bitLength()/8),this.hash=dh.sha512}var ph=ue;ue.prototype.sign=function(t,r){t=_f(t);var n=this.keyFromSecret(r),i=this.hashInt(n.messagePrefix(),t),f=this.g.mul(i),l=this.encodePoint(f),u=this.hashInt(l,n.pubBytes(),t).mul(n.priv()),p=i.add(u).umod(this.curve.n);return this.makeSignature({R:f,S:p,Rencoded:l})};ue.prototype.verify=function(t,r,n){t=_f(t),r=this.makeSignature(r);var i=this.keyFromPublic(n),f=this.hashInt(r.Rencoded(),i.pubBytes(),t),l=this.g.mul(r.S()),u=r.R().add(i.pub().mul(f));return u.eq(l)};ue.prototype.hashInt=function(){for(var t=this.hash(),r=0;r<arguments.length;r++)t.update(arguments[r]);return Er.intFromLE(t.digest()).umod(this.curve.n)};ue.prototype.keyFromPublic=function(t){return Mf.fromPublic(this,t)};ue.prototype.keyFromSecret=function(t){return Mf.fromSecret(this,t)};ue.prototype.makeSignature=function(t){return t instanceof Sf?t:new Sf(this,t)};ue.prototype.encodePoint=function(t){var r=t.getY().toArray("le",this.encodingLength);return r[this.encodingLength-1]|=t.getX().isOdd()?128:0,r};ue.prototype.decodePoint=function(t){t=Er.parseBytes(t);var r=t.length-1,n=t.slice(0,r).concat(t[r]&~128),i=(t[r]&128)!=0,f=Er.intFromLE(n);return this.curve.pointFromY(f,i)};ue.prototype.encodeInt=function(t){return t.toArray("le",this.encodingLength)};ue.prototype.decodeInt=function(t){return Er.intFromLE(t)};ue.prototype.isPoint=function(t){return t instanceof this.pointClass};(function(e){var t=e;t.version=vo.version,t.utils=ce,t.rand=Qr.exports,t.curve=Qn,t.curves=an,t.ec=ah,t.eddsa=ph})(Zr);var bh={exports:{}};/**
 * [js-sha3]{@link https://github.com/emn178/js-sha3}
 *
 * @version 0.8.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2015-2018
 * @license MIT
 */(function(e){(function(){var t="input is invalid type",r="finalize already called",n=typeof window=="object",i=n?window:{};i.JS_SHA3_NO_WINDOW&&(n=!1);var f=!n&&typeof self=="object",l=!i.JS_SHA3_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;l?i=me:f&&(i=self);var u=!i.JS_SHA3_NO_COMMON_JS&&!0&&e.exports,p=!i.JS_SHA3_NO_ARRAY_BUFFER&&typeof ArrayBuffer!="undefined",x="0123456789abcdef".split(""),g=[31,7936,2031616,520093696],A=[4,1024,262144,67108864],L=[1,256,65536,16777216],U=[6,1536,393216,100663296],N=[0,8,16,24],T=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],q=[224,256,384,512],j=[128,256],J=["hex","buffer","arrayBuffer","array","digest"],X={"128":168,"256":136};(i.JS_SHA3_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(b){return Object.prototype.toString.call(b)==="[object Array]"}),p&&(i.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(b){return typeof b=="object"&&b.buffer&&b.buffer.constructor===ArrayBuffer});for(var P=function(b,R,E){return function(C){return new K(b,R,b).update(C)[E]()}},O=function(b,R,E){return function(C,B){return new K(b,R,B).update(C)[E]()}},z=function(b,R,E){return function(C,B,s,I){return d["cshake"+b].update(C,B,s,I)[E]()}},h=function(b,R,E){return function(C,B,s,I){return d["kmac"+b].update(C,B,s,I)[E]()}},$=function(b,R,E,C){for(var B=0;B<J.length;++B){var s=J[B];b[s]=R(E,C,s)}return b},F=function(b,R){var E=P(b,R,"hex");return E.create=function(){return new K(b,R,b)},E.update=function(C){return E.create().update(C)},$(E,P,b,R)},G=function(b,R){var E=O(b,R,"hex");return E.create=function(C){return new K(b,R,C)},E.update=function(C,B){return E.create(B).update(C)},$(E,O,b,R)},M=function(b,R){var E=X[b],C=z(b,R,"hex");return C.create=function(B,s,I){return!s&&!I?d["shake"+b].create(B):new K(b,R,B).bytepad([s,I],E)},C.update=function(B,s,I,D){return C.create(s,I,D).update(B)},$(C,z,b,R)},a=function(b,R){var E=X[b],C=h(b,R,"hex");return C.create=function(B,s,I){return new k(b,R,s).bytepad(["KMAC",I],E).bytepad([B],E)},C.update=function(B,s,I,D){return C.create(B,I,D).update(s)},$(C,h,b,R)},c=[{name:"keccak",padding:L,bits:q,createMethod:F},{name:"sha3",padding:U,bits:q,createMethod:F},{name:"shake",padding:g,bits:j,createMethod:G},{name:"cshake",padding:A,bits:j,createMethod:M},{name:"kmac",padding:A,bits:j,createMethod:a}],d={},v=[],w=0;w<c.length;++w)for(var S=c[w],_=S.bits,y=0;y<_.length;++y){var o=S.name+"_"+_[y];if(v.push(o),d[o]=S.createMethod(_[y],S.padding),S.name!=="sha3"){var m=S.name+_[y];v.push(m),d[m]=d[o]}}function K(b,R,E){this.blocks=[],this.s=[],this.padding=R,this.outputBits=E,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(b<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=E>>5,this.extraBytes=(E&31)>>3;for(var C=0;C<50;++C)this.s[C]=0}K.prototype.update=function(b){if(this.finalized)throw new Error(r);var R,E=typeof b;if(E!=="string"){if(E==="object"){if(b===null)throw new Error(t);if(p&&b.constructor===ArrayBuffer)b=new Uint8Array(b);else if(!Array.isArray(b)&&(!p||!ArrayBuffer.isView(b)))throw new Error(t)}else throw new Error(t);R=!0}for(var C=this.blocks,B=this.byteCount,s=b.length,I=this.blockCount,D=0,V=this.s,Y,Q;D<s;){if(this.reset)for(this.reset=!1,C[0]=this.block,Y=1;Y<I+1;++Y)C[Y]=0;if(R)for(Y=this.start;D<s&&Y<B;++D)C[Y>>2]|=b[D]<<N[Y++&3];else for(Y=this.start;D<s&&Y<B;++D)Q=b.charCodeAt(D),Q<128?C[Y>>2]|=Q<<N[Y++&3]:Q<2048?(C[Y>>2]|=(192|Q>>6)<<N[Y++&3],C[Y>>2]|=(128|Q&63)<<N[Y++&3]):Q<55296||Q>=57344?(C[Y>>2]|=(224|Q>>12)<<N[Y++&3],C[Y>>2]|=(128|Q>>6&63)<<N[Y++&3],C[Y>>2]|=(128|Q&63)<<N[Y++&3]):(Q=65536+((Q&1023)<<10|b.charCodeAt(++D)&1023),C[Y>>2]|=(240|Q>>18)<<N[Y++&3],C[Y>>2]|=(128|Q>>12&63)<<N[Y++&3],C[Y>>2]|=(128|Q>>6&63)<<N[Y++&3],C[Y>>2]|=(128|Q&63)<<N[Y++&3]);if(this.lastByteIndex=Y,Y>=B){for(this.start=Y-B,this.block=C[I],Y=0;Y<I;++Y)V[Y]^=C[Y];W(V),this.reset=!0}else this.start=Y}return this},K.prototype.encode=function(b,R){var E=b&255,C=1,B=[E];for(b=b>>8,E=b&255;E>0;)B.unshift(E),b=b>>8,E=b&255,++C;return R?B.push(C):B.unshift(C),this.update(B),B.length},K.prototype.encodeString=function(b){var R,E=typeof b;if(E!=="string"){if(E==="object"){if(b===null)throw new Error(t);if(p&&b.constructor===ArrayBuffer)b=new Uint8Array(b);else if(!Array.isArray(b)&&(!p||!ArrayBuffer.isView(b)))throw new Error(t)}else throw new Error(t);R=!0}var C=0,B=b.length;if(R)C=B;else for(var s=0;s<b.length;++s){var I=b.charCodeAt(s);I<128?C+=1:I<2048?C+=2:I<55296||I>=57344?C+=3:(I=65536+((I&1023)<<10|b.charCodeAt(++s)&1023),C+=4)}return C+=this.encode(C*8),this.update(b),C},K.prototype.bytepad=function(b,R){for(var E=this.encode(R),C=0;C<b.length;++C)E+=this.encodeString(b[C]);var B=R-E%R,s=[];return s.length=B,this.update(s),this},K.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var b=this.blocks,R=this.lastByteIndex,E=this.blockCount,C=this.s;if(b[R>>2]|=this.padding[R&3],this.lastByteIndex===this.byteCount)for(b[0]=b[E],R=1;R<E+1;++R)b[R]=0;for(b[E-1]|=2147483648,R=0;R<E;++R)C[R]^=b[R];W(C)}},K.prototype.toString=K.prototype.hex=function(){this.finalize();for(var b=this.blockCount,R=this.s,E=this.outputBlocks,C=this.extraBytes,B=0,s=0,I="",D;s<E;){for(B=0;B<b&&s<E;++B,++s)D=R[B],I+=x[D>>4&15]+x[D&15]+x[D>>12&15]+x[D>>8&15]+x[D>>20&15]+x[D>>16&15]+x[D>>28&15]+x[D>>24&15];s%b==0&&(W(R),B=0)}return C&&(D=R[B],I+=x[D>>4&15]+x[D&15],C>1&&(I+=x[D>>12&15]+x[D>>8&15]),C>2&&(I+=x[D>>20&15]+x[D>>16&15])),I},K.prototype.arrayBuffer=function(){this.finalize();var b=this.blockCount,R=this.s,E=this.outputBlocks,C=this.extraBytes,B=0,s=0,I=this.outputBits>>3,D;C?D=new ArrayBuffer(E+1<<2):D=new ArrayBuffer(I);for(var V=new Uint32Array(D);s<E;){for(B=0;B<b&&s<E;++B,++s)V[s]=R[B];s%b==0&&W(R)}return C&&(V[B]=R[B],D=D.slice(0,I)),D},K.prototype.buffer=K.prototype.arrayBuffer,K.prototype.digest=K.prototype.array=function(){this.finalize();for(var b=this.blockCount,R=this.s,E=this.outputBlocks,C=this.extraBytes,B=0,s=0,I=[],D,V;s<E;){for(B=0;B<b&&s<E;++B,++s)D=s<<2,V=R[B],I[D]=V&255,I[D+1]=V>>8&255,I[D+2]=V>>16&255,I[D+3]=V>>24&255;s%b==0&&W(R)}return C&&(D=s<<2,V=R[B],I[D]=V&255,C>1&&(I[D+1]=V>>8&255),C>2&&(I[D+2]=V>>16&255)),I};function k(b,R,E){K.call(this,b,R,E)}k.prototype=new K,k.prototype.finalize=function(){return this.encode(this.outputBits,!0),K.prototype.finalize.call(this)};var W=function(b){var R,E,C,B,s,I,D,V,Y,Q,it,Ut,vt,dt,Bt,ft,nt,pt,rt,et,lt,tt,at,$t,ot,st,Ct,ut,ct,zt,Pt,Rt,se,Tt,Dt,ye,kt,yt,Kt,gt,xt,Gt,wt,mt,Jt,_t,Mt,Xt,St,At,Wt,Et,It,tr,Ft,Ht,Te,De,ke,qe,Fe,He,je;for(C=0;C<48;C+=2)B=b[0]^b[10]^b[20]^b[30]^b[40],s=b[1]^b[11]^b[21]^b[31]^b[41],I=b[2]^b[12]^b[22]^b[32]^b[42],D=b[3]^b[13]^b[23]^b[33]^b[43],V=b[4]^b[14]^b[24]^b[34]^b[44],Y=b[5]^b[15]^b[25]^b[35]^b[45],Q=b[6]^b[16]^b[26]^b[36]^b[46],it=b[7]^b[17]^b[27]^b[37]^b[47],Ut=b[8]^b[18]^b[28]^b[38]^b[48],vt=b[9]^b[19]^b[29]^b[39]^b[49],R=Ut^(I<<1|D>>>31),E=vt^(D<<1|I>>>31),b[0]^=R,b[1]^=E,b[10]^=R,b[11]^=E,b[20]^=R,b[21]^=E,b[30]^=R,b[31]^=E,b[40]^=R,b[41]^=E,R=B^(V<<1|Y>>>31),E=s^(Y<<1|V>>>31),b[2]^=R,b[3]^=E,b[12]^=R,b[13]^=E,b[22]^=R,b[23]^=E,b[32]^=R,b[33]^=E,b[42]^=R,b[43]^=E,R=I^(Q<<1|it>>>31),E=D^(it<<1|Q>>>31),b[4]^=R,b[5]^=E,b[14]^=R,b[15]^=E,b[24]^=R,b[25]^=E,b[34]^=R,b[35]^=E,b[44]^=R,b[45]^=E,R=V^(Ut<<1|vt>>>31),E=Y^(vt<<1|Ut>>>31),b[6]^=R,b[7]^=E,b[16]^=R,b[17]^=E,b[26]^=R,b[27]^=E,b[36]^=R,b[37]^=E,b[46]^=R,b[47]^=E,R=Q^(B<<1|s>>>31),E=it^(s<<1|B>>>31),b[8]^=R,b[9]^=E,b[18]^=R,b[19]^=E,b[28]^=R,b[29]^=E,b[38]^=R,b[39]^=E,b[48]^=R,b[49]^=E,dt=b[0],Bt=b[1],_t=b[11]<<4|b[10]>>>28,Mt=b[10]<<4|b[11]>>>28,ut=b[20]<<3|b[21]>>>29,ct=b[21]<<3|b[20]>>>29,qe=b[31]<<9|b[30]>>>23,Fe=b[30]<<9|b[31]>>>23,Gt=b[40]<<18|b[41]>>>14,wt=b[41]<<18|b[40]>>>14,Tt=b[2]<<1|b[3]>>>31,Dt=b[3]<<1|b[2]>>>31,ft=b[13]<<12|b[12]>>>20,nt=b[12]<<12|b[13]>>>20,Xt=b[22]<<10|b[23]>>>22,St=b[23]<<10|b[22]>>>22,zt=b[33]<<13|b[32]>>>19,Pt=b[32]<<13|b[33]>>>19,He=b[42]<<2|b[43]>>>30,je=b[43]<<2|b[42]>>>30,tr=b[5]<<30|b[4]>>>2,Ft=b[4]<<30|b[5]>>>2,ye=b[14]<<6|b[15]>>>26,kt=b[15]<<6|b[14]>>>26,pt=b[25]<<11|b[24]>>>21,rt=b[24]<<11|b[25]>>>21,At=b[34]<<15|b[35]>>>17,Wt=b[35]<<15|b[34]>>>17,Rt=b[45]<<29|b[44]>>>3,se=b[44]<<29|b[45]>>>3,$t=b[6]<<28|b[7]>>>4,ot=b[7]<<28|b[6]>>>4,Ht=b[17]<<23|b[16]>>>9,Te=b[16]<<23|b[17]>>>9,yt=b[26]<<25|b[27]>>>7,Kt=b[27]<<25|b[26]>>>7,et=b[36]<<21|b[37]>>>11,lt=b[37]<<21|b[36]>>>11,Et=b[47]<<24|b[46]>>>8,It=b[46]<<24|b[47]>>>8,mt=b[8]<<27|b[9]>>>5,Jt=b[9]<<27|b[8]>>>5,st=b[18]<<20|b[19]>>>12,Ct=b[19]<<20|b[18]>>>12,De=b[29]<<7|b[28]>>>25,ke=b[28]<<7|b[29]>>>25,gt=b[38]<<8|b[39]>>>24,xt=b[39]<<8|b[38]>>>24,tt=b[48]<<14|b[49]>>>18,at=b[49]<<14|b[48]>>>18,b[0]=dt^~ft&pt,b[1]=Bt^~nt&rt,b[10]=$t^~st&ut,b[11]=ot^~Ct&ct,b[20]=Tt^~ye&yt,b[21]=Dt^~kt&Kt,b[30]=mt^~_t&Xt,b[31]=Jt^~Mt&St,b[40]=tr^~Ht&De,b[41]=Ft^~Te&ke,b[2]=ft^~pt&et,b[3]=nt^~rt&lt,b[12]=st^~ut&zt,b[13]=Ct^~ct&Pt,b[22]=ye^~yt&gt,b[23]=kt^~Kt&xt,b[32]=_t^~Xt&At,b[33]=Mt^~St&Wt,b[42]=Ht^~De&qe,b[43]=Te^~ke&Fe,b[4]=pt^~et&tt,b[5]=rt^~lt&at,b[14]=ut^~zt&Rt,b[15]=ct^~Pt&se,b[24]=yt^~gt&Gt,b[25]=Kt^~xt&wt,b[34]=Xt^~At&Et,b[35]=St^~Wt&It,b[44]=De^~qe&He,b[45]=ke^~Fe&je,b[6]=et^~tt&dt,b[7]=lt^~at&Bt,b[16]=zt^~Rt&$t,b[17]=Pt^~se&ot,b[26]=gt^~Gt&Tt,b[27]=xt^~wt&Dt,b[36]=At^~Et&mt,b[37]=Wt^~It&Jt,b[46]=qe^~He&tr,b[47]=Fe^~je&Ft,b[8]=tt^~dt&ft,b[9]=at^~Bt&nt,b[18]=Rt^~$t&st,b[19]=se^~ot&Ct,b[28]=Gt^~Tt&ye,b[29]=wt^~Dt&kt,b[38]=Et^~mt&_t,b[39]=It^~Jt&Mt,b[48]=He^~tr&Ht,b[49]=je^~Ft&Te,b[0]^=T[C],b[1]^=T[C+1]};if(u)e.exports=d;else for(w=0;w<v.length;++w)i[v[w]]=d[v[w]]})()})(bh);var Or={},di={},li={};Object.defineProperty(li,"__esModule",{value:!0});var Af=65536,yh=function(){function e(){this.isAvailable=!1,this.isInstantiated=!1;var t=typeof self!="undefined"?self.crypto||self.msCrypto:null;t&&t.getRandomValues&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}return e.prototype.randomBytes=function(t){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");for(var r=new Uint8Array(t),n=0;n<r.length;n+=Af)this._crypto.getRandomValues(r.subarray(n,n+Math.min(r.length-n,Af)));return r},e}();li.BrowserRandomSource=yh;var vi={},de={};Object.defineProperty(de,"__esModule",{value:!0});function gh(e){for(var t=0;t<e.length;t++)e[t]=0;return e}de.wipe=gh;Object.defineProperty(vi,"__esModule",{value:!0});var xh=de,wh=function(){function e(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Wa!="undefined"){var t=Za;t&&t.randomBytes&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}}return e.prototype.randomBytes=function(t){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");var r=this._crypto.randomBytes(t);if(r.length!==t)throw new Error("NodeRandomSource: got fewer bytes than requested");for(var n=new Uint8Array(t),i=0;i<n.length;i++)n[i]=r[i];return xh.wipe(r),n},e}();vi.NodeRandomSource=wh;Object.defineProperty(di,"__esModule",{value:!0});var mh=li,_h=vi,Mh=function(){function e(){if(this.isAvailable=!1,this.name="",this._source=new mh.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new _h.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}return e.prototype.randomBytes=function(t){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(t)},e}();di.SystemRandomSource=Mh;var bt={},Ef={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});function t(u,p){var x=u>>>16&65535,g=u&65535,A=p>>>16&65535,L=p&65535;return g*L+(x*L+g*A<<16>>>0)|0}e.mul=Math.imul||t;function r(u,p){return u+p|0}e.add=r;function n(u,p){return u-p|0}e.sub=n;function i(u,p){return u<<p|u>>>32-p}e.rotl=i;function f(u,p){return u<<32-p|u>>>p}e.rotr=f;function l(u){return typeof u=="number"&&isFinite(u)&&Math.floor(u)===u}e.isInteger=Number.isInteger||l,e.MAX_SAFE_INTEGER=9007199254740991,e.isSafeInteger=function(u){return e.isInteger(u)&&u>=-e.MAX_SAFE_INTEGER&&u<=e.MAX_SAFE_INTEGER}})(Ef);Object.defineProperty(bt,"__esModule",{value:!0});var If=Ef;function Sh(e,t){return t===void 0&&(t=0),(e[t+0]<<8|e[t+1])<<16>>16}bt.readInt16BE=Sh;function Ah(e,t){return t===void 0&&(t=0),(e[t+0]<<8|e[t+1])>>>0}bt.readUint16BE=Ah;function Eh(e,t){return t===void 0&&(t=0),(e[t+1]<<8|e[t])<<16>>16}bt.readInt16LE=Eh;function Ih(e,t){return t===void 0&&(t=0),(e[t+1]<<8|e[t])>>>0}bt.readUint16LE=Ih;function Bf(e,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=e>>>8,t[r+1]=e>>>0,t}bt.writeUint16BE=Bf;bt.writeInt16BE=Bf;function $f(e,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t}bt.writeUint16LE=$f;bt.writeInt16LE=$f;function pi(e,t){return t===void 0&&(t=0),e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}bt.readInt32BE=pi;function bi(e,t){return t===void 0&&(t=0),(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}bt.readUint32BE=bi;function yi(e,t){return t===void 0&&(t=0),e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}bt.readInt32LE=yi;function gi(e,t){return t===void 0&&(t=0),(e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t])>>>0}bt.readUint32LE=gi;function pn(e,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=e>>>24,t[r+1]=e>>>16,t[r+2]=e>>>8,t[r+3]=e>>>0,t}bt.writeUint32BE=pn;bt.writeInt32BE=pn;function bn(e,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24,t}bt.writeUint32LE=bn;bt.writeInt32LE=bn;function Bh(e,t){t===void 0&&(t=0);var r=pi(e,t),n=pi(e,t+4);return r*4294967296+n-(n>>31)*4294967296}bt.readInt64BE=Bh;function $h(e,t){t===void 0&&(t=0);var r=bi(e,t),n=bi(e,t+4);return r*4294967296+n}bt.readUint64BE=$h;function Uh(e,t){t===void 0&&(t=0);var r=yi(e,t),n=yi(e,t+4);return n*4294967296+r-(r>>31)*4294967296}bt.readInt64LE=Uh;function Ch(e,t){t===void 0&&(t=0);var r=gi(e,t),n=gi(e,t+4);return n*4294967296+r}bt.readUint64LE=Ch;function Uf(e,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),pn(e/4294967296>>>0,t,r),pn(e>>>0,t,r+4),t}bt.writeUint64BE=Uf;bt.writeInt64BE=Uf;function Cf(e,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),bn(e>>>0,t,r),bn(e/4294967296>>>0,t,r+4),t}bt.writeUint64LE=Cf;bt.writeInt64LE=Cf;function Nh(e,t,r){if(r===void 0&&(r=0),e%8!=0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,i=1,f=e/8+r-1;f>=r;f--)n+=t[f]*i,i*=256;return n}bt.readUintBE=Nh;function Lh(e,t,r){if(r===void 0&&(r=0),e%8!=0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,i=1,f=r;f<r+e/8;f++)n+=t[f]*i,i*=256;return n}bt.readUintLE=Lh;function zh(e,t,r,n){if(r===void 0&&(r=new Uint8Array(e/8)),n===void 0&&(n=0),e%8!=0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!If.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var i=1,f=e/8+n-1;f>=n;f--)r[f]=t/i&255,i*=256;return r}bt.writeUintBE=zh;function Ph(e,t,r,n){if(r===void 0&&(r=new Uint8Array(e/8)),n===void 0&&(n=0),e%8!=0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!If.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var i=1,f=n;f<n+e/8;f++)r[f]=t/i&255,i*=256;return r}bt.writeUintLE=Ph;function Rh(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat32(t)}bt.readFloat32BE=Rh;function Oh(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat32(t,!0)}bt.readFloat32LE=Oh;function Th(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat64(t)}bt.readFloat64BE=Th;function Dh(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat64(t,!0)}bt.readFloat64LE=Dh;function kh(e,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat32(r,e),t}bt.writeFloat32BE=kh;function qh(e,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat32(r,e,!0),t}bt.writeFloat32LE=qh;function Fh(e,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat64(r,e),t}bt.writeFloat64BE=Fh;function Hh(e,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat64(r,e,!0),t}bt.writeFloat64LE=Hh;(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=di,r=bt,n=de;e.defaultRandomSource=new t.SystemRandomSource;function i(x,g){return g===void 0&&(g=e.defaultRandomSource),g.randomBytes(x)}e.randomBytes=i;function f(x){x===void 0&&(x=e.defaultRandomSource);var g=i(4,x),A=r.readUint32LE(g);return n.wipe(g),A}e.randomUint32=f;var l="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function u(x,g,A){if(g===void 0&&(g=l),A===void 0&&(A=e.defaultRandomSource),g.length<2)throw new Error("randomString charset is too short");if(g.length>256)throw new Error("randomString charset is too long");for(var L="",U=g.length,N=256-256%U;x>0;){for(var T=i(Math.ceil(x*256/N),A),q=0;q<T.length&&x>0;q++){var j=T[q];j<N&&(L+=g.charAt(j%U),x--)}n.wipe(T)}return L}e.randomString=u;function p(x,g,A){g===void 0&&(g=l),A===void 0&&(A=e.defaultRandomSource);var L=Math.ceil(x/(Math.log(g.length)/Math.LN2));return u(L,g,A)}e.randomStringForEntropy=p})(Or);function jh(e,t){t||(t=e.reduce((i,f)=>i+f.length,0));const r=new Uint8Array(t);let n=0;for(const i of e)r.set(i,n),n+=i.length;return r}function Kh(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var f=e.charAt(i),l=f.charCodeAt(0);if(r[l]!==255)throw new TypeError(f+" is ambiguous");r[l]=i}var u=e.length,p=e.charAt(0),x=Math.log(u)/Math.log(256),g=Math.log(256)/Math.log(u);function A(N){if(N instanceof Uint8Array||(ArrayBuffer.isView(N)?N=new Uint8Array(N.buffer,N.byteOffset,N.byteLength):Array.isArray(N)&&(N=Uint8Array.from(N))),!(N instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(N.length===0)return"";for(var T=0,q=0,j=0,J=N.length;j!==J&&N[j]===0;)j++,T++;for(var X=(J-j)*g+1>>>0,P=new Uint8Array(X);j!==J;){for(var O=N[j],z=0,h=X-1;(O!==0||z<q)&&h!==-1;h--,z++)O+=256*P[h]>>>0,P[h]=O%u>>>0,O=O/u>>>0;if(O!==0)throw new Error("Non-zero carry");q=z,j++}for(var $=X-q;$!==X&&P[$]===0;)$++;for(var F=p.repeat(T);$<X;++$)F+=e.charAt(P[$]);return F}function L(N){if(typeof N!="string")throw new TypeError("Expected String");if(N.length===0)return new Uint8Array;var T=0;if(N[T]!==" "){for(var q=0,j=0;N[T]===p;)q++,T++;for(var J=(N.length-T)*x+1>>>0,X=new Uint8Array(J);N[T];){var P=r[N.charCodeAt(T)];if(P===255)return;for(var O=0,z=J-1;(P!==0||O<j)&&z!==-1;z--,O++)P+=u*X[z]>>>0,X[z]=P%256>>>0,P=P/256>>>0;if(P!==0)throw new Error("Non-zero carry");j=O,T++}if(N[T]!==" "){for(var h=J-j;h!==J&&X[h]===0;)h++;for(var $=new Uint8Array(q+(J-h)),F=q;h!==J;)$[F++]=X[h++];return $}}}function U(N){var T=L(N);if(T)return T;throw new Error(`Non-${t} character`)}return{encode:A,decodeUnsafe:L,decode:U}}var Gh=Kh,Jh=Gh;const Nf=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},Xh=e=>new TextEncoder().encode(e),Wh=e=>new TextDecoder().decode(e);class Vh{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class Yh{constructor(t,r,n){this.name=t,this.prefix=r,this.baseDecode=n}decode(t){if(typeof t=="string")switch(t[0]){case this.prefix:return this.baseDecode(t.slice(1));default:throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)}else throw Error("Can only multibase decode strings")}or(t){return Lf(this,t)}}class Zh{constructor(t){this.decoders=t}or(t){return Lf(this,t)}decode(t){const r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Lf=(e,t)=>new Zh(Vt(Vt({},e.decoders||{[e.prefix]:e}),t.decoders||{[t.prefix]:t}));class Qh{constructor(t,r,n,i){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Vh(t,r,n),this.decoder=new Yh(t,r,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const xi=({name:e,prefix:t,encode:r,decode:n})=>new Qh(e,t,r,n),Tr=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=Jh(r,t);return xi({prefix:e,name:t,encode:n,decode:f=>Nf(i(f))})},t0=(e,t,r,n)=>{const i={};for(let g=0;g<t.length;++g)i[t[g]]=g;let f=e.length;for(;e[f-1]==="=";)--f;const l=new Uint8Array(f*r/8|0);let u=0,p=0,x=0;for(let g=0;g<f;++g){const A=i[e[g]];if(A===void 0)throw new SyntaxError(`Non-${n} character`);p=p<<r|A,u+=r,u>=8&&(u-=8,l[x++]=255&p>>u)}if(u>=r||255&p<<8-u)throw new SyntaxError("Unexpected end of data");return l},e0=(e,t,r)=>{const n=t[t.length-1]==="=",i=(1<<r)-1;let f="",l=0,u=0;for(let p=0;p<e.length;++p)for(u=u<<8|e[p],l+=8;l>r;)l-=r,f+=t[i&u>>l];if(l&&(f+=t[i&u<<r-l]),n)for(;f.length*r&7;)f+="=";return f},ne=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>xi({prefix:t,name:e,encode(i){return e0(i,n,r)},decode(i){return t0(i,n,r,e)}}),r0=xi({prefix:"\0",name:"identity",encode:e=>Wh(e),decode:e=>Xh(e)});var n0=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",identity:r0});const i0=ne({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var f0=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",base2:i0});const a0=ne({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var o0=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",base8:a0});const s0=Tr({prefix:"9",name:"base10",alphabet:"0123456789"});var h0=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",base10:s0});const u0=ne({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),c0=ne({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var d0=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",base16:u0,base16upper:c0});const l0=ne({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),v0=ne({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),p0=ne({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),b0=ne({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),y0=ne({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),g0=ne({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),x0=ne({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),w0=ne({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),m0=ne({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var _0=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",base32:l0,base32upper:v0,base32pad:p0,base32padupper:b0,base32hex:y0,base32hexupper:g0,base32hexpad:x0,base32hexpadupper:w0,base32z:m0});const M0=Tr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),S0=Tr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var A0=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",base36:M0,base36upper:S0});const E0=Tr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),I0=Tr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var B0=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",base58btc:E0,base58flickr:I0});const $0=ne({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),U0=ne({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),C0=ne({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),N0=ne({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var L0=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",base64:$0,base64pad:U0,base64url:C0,base64urlpad:N0}),z0=Pf,zf=128,P0=127,R0=~P0,O0=Math.pow(2,31);function Pf(e,t,r){t=t||[],r=r||0;for(var n=r;e>=O0;)t[r++]=e&255|zf,e/=128;for(;e&R0;)t[r++]=e&255|zf,e>>>=7;return t[r]=e|0,Pf.bytes=r-n+1,t}var T0=wi,D0=128,Rf=127;function wi(e,t){var r=0,t=t||0,n=0,i=t,f,l=e.length;do{if(i>=l)throw wi.bytes=0,new RangeError("Could not decode varint");f=e[i++],r+=n<28?(f&Rf)<<n:(f&Rf)*Math.pow(2,n),n+=7}while(f>=D0);return wi.bytes=i-t,r}var k0=Math.pow(2,7),q0=Math.pow(2,14),F0=Math.pow(2,21),H0=Math.pow(2,28),j0=Math.pow(2,35),K0=Math.pow(2,42),G0=Math.pow(2,49),J0=Math.pow(2,56),X0=Math.pow(2,63),W0=function(e){return e<k0?1:e<q0?2:e<F0?3:e<H0?4:e<j0?5:e<K0?6:e<G0?7:e<J0?8:e<X0?9:10},V0={encode:z0,decode:T0,encodingLength:W0},Of=V0;const Tf=(e,t,r=0)=>(Of.encode(e,t,r),t),Df=e=>Of.encodingLength(e),mi=(e,t)=>{const r=t.byteLength,n=Df(e),i=n+Df(r),f=new Uint8Array(i+r);return Tf(e,f,0),Tf(r,f,n),f.set(t,i),new Y0(e,r,t,f)};class Y0{constructor(t,r,n,i){this.code=t,this.size=r,this.digest=n,this.bytes=i}}const kf=({name:e,code:t,encode:r})=>new Z0(e,t,r);class Z0{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?mi(this.code,r):r.then(n=>mi(this.code,n))}else throw Error("Unknown type, must be binary type")}}const qf=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Q0=kf({name:"sha2-256",code:18,encode:qf("SHA-256")}),tu=kf({name:"sha2-512",code:19,encode:qf("SHA-512")});var eu=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",sha256:Q0,sha512:tu});const Ff=0,ru="identity",Hf=Nf,nu=e=>mi(Ff,Hf(e)),iu={code:Ff,name:ru,encode:Hf,digest:nu};var fu=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",identity:iu});new TextEncoder;new TextDecoder;const jf=Vt(Vt(Vt(Vt(Vt(Vt(Vt(Vt(Vt({},n0),f0),o0),h0),d0),_0),A0),B0),L0);Vt(Vt({},eu),fu);function Kf(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const Gf=Kf("utf8","u",e=>{const t=new TextDecoder("utf8");return"u"+t.decode(e)},e=>new TextEncoder().encode(e.substring(1))),_i=Kf("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),Jf=Vt({utf8:Gf,"utf-8":Gf,hex:jf.base16,latin1:_i,ascii:_i,binary:_i},jf);function yn(e,t="utf8"){const r=Jf[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return r.decoder.decode(`${r.prefix}${e}`)}function Xf(e,t="utf8"){const r=Jf[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return r.encoder.encode(e).substring(1)}var au={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=bt,r=de;e.DIGEST_LENGTH=32,e.BLOCK_SIZE=64;var n=function(){function u(){this.digestLength=e.DIGEST_LENGTH,this.blockSize=e.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return u.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},u.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},u.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},u.prototype.update=function(p,x){if(x===void 0&&(x=p.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var g=0;if(this._bytesHashed+=x,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&x>0;)this._buffer[this._bufferLength++]=p[g++],x--;this._bufferLength===this.blockSize&&(f(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(x>=this.blockSize&&(g=f(this._temp,this._state,p,g,x),x%=this.blockSize);x>0;)this._buffer[this._bufferLength++]=p[g++],x--;return this},u.prototype.finish=function(p){if(!this._finished){var x=this._bytesHashed,g=this._bufferLength,A=x/536870912|0,L=x<<3,U=x%64<56?64:128;this._buffer[g]=128;for(var N=g+1;N<U-8;N++)this._buffer[N]=0;t.writeUint32BE(A,this._buffer,U-8),t.writeUint32BE(L,this._buffer,U-4),f(this._temp,this._state,this._buffer,0,U),this._finished=!0}for(var N=0;N<this.digestLength/4;N++)t.writeUint32BE(this._state[N],p,N*4);return this},u.prototype.digest=function(){var p=new Uint8Array(this.digestLength);return this.finish(p),p},u.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},u.prototype.restoreState=function(p){return this._state.set(p.state),this._bufferLength=p.bufferLength,p.buffer&&this._buffer.set(p.buffer),this._bytesHashed=p.bytesHashed,this._finished=!1,this},u.prototype.cleanSavedState=function(p){r.wipe(p.state),p.buffer&&r.wipe(p.buffer),p.bufferLength=0,p.bytesHashed=0},u}();e.SHA256=n;var i=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function f(u,p,x,g,A){for(;A>=64;){for(var L=p[0],U=p[1],N=p[2],T=p[3],q=p[4],j=p[5],J=p[6],X=p[7],P=0;P<16;P++){var O=g+P*4;u[P]=t.readUint32BE(x,O)}for(var P=16;P<64;P++){var z=u[P-2],h=(z>>>17|z<<32-17)^(z>>>19|z<<32-19)^z>>>10;z=u[P-15];var $=(z>>>7|z<<32-7)^(z>>>18|z<<32-18)^z>>>3;u[P]=(h+u[P-7]|0)+($+u[P-16]|0)}for(var P=0;P<64;P++){var h=(((q>>>6|q<<32-6)^(q>>>11|q<<32-11)^(q>>>25|q<<32-25))+(q&j^~q&J)|0)+(X+(i[P]+u[P]|0)|0)|0,$=((L>>>2|L<<32-2)^(L>>>13|L<<32-13)^(L>>>22|L<<32-22))+(L&U^L&N^U&N)|0;X=J,J=j,j=q,q=T+h|0,T=N,N=U,U=L,L=h+$|0}p[0]+=L,p[1]+=U,p[2]+=N,p[3]+=T,p[4]+=q,p[5]+=j,p[6]+=J,p[7]+=X,g+=64,A-=64}return g}function l(u){var p=new n;p.update(u);var x=p.digest();return p.clean(),x}e.hash=l})(au);var ou={},Wf={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=bt,r=de;e.DIGEST_LENGTH=64,e.BLOCK_SIZE=128;var n=function(){function u(){this.digestLength=e.DIGEST_LENGTH,this.blockSize=e.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return u.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},u.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},u.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},u.prototype.update=function(p,x){if(x===void 0&&(x=p.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var g=0;if(this._bytesHashed+=x,this._bufferLength>0){for(;this._bufferLength<e.BLOCK_SIZE&&x>0;)this._buffer[this._bufferLength++]=p[g++],x--;this._bufferLength===this.blockSize&&(f(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(x>=this.blockSize&&(g=f(this._tempHi,this._tempLo,this._stateHi,this._stateLo,p,g,x),x%=this.blockSize);x>0;)this._buffer[this._bufferLength++]=p[g++],x--;return this},u.prototype.finish=function(p){if(!this._finished){var x=this._bytesHashed,g=this._bufferLength,A=x/536870912|0,L=x<<3,U=x%128<112?128:256;this._buffer[g]=128;for(var N=g+1;N<U-8;N++)this._buffer[N]=0;t.writeUint32BE(A,this._buffer,U-8),t.writeUint32BE(L,this._buffer,U-4),f(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,U),this._finished=!0}for(var N=0;N<this.digestLength/8;N++)t.writeUint32BE(this._stateHi[N],p,N*8),t.writeUint32BE(this._stateLo[N],p,N*8+4);return this},u.prototype.digest=function(){var p=new Uint8Array(this.digestLength);return this.finish(p),p},u.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},u.prototype.restoreState=function(p){return this._stateHi.set(p.stateHi),this._stateLo.set(p.stateLo),this._bufferLength=p.bufferLength,p.buffer&&this._buffer.set(p.buffer),this._bytesHashed=p.bytesHashed,this._finished=!1,this},u.prototype.cleanSavedState=function(p){r.wipe(p.stateHi),r.wipe(p.stateLo),p.buffer&&r.wipe(p.buffer),p.bufferLength=0,p.bytesHashed=0},u}();e.SHA512=n;var i=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function f(u,p,x,g,A,L,U){for(var N=x[0],T=x[1],q=x[2],j=x[3],J=x[4],X=x[5],P=x[6],O=x[7],z=g[0],h=g[1],$=g[2],F=g[3],G=g[4],M=g[5],a=g[6],c=g[7],d,v,w,S,_,y,o,m;U>=128;){for(var K=0;K<16;K++){var k=8*K+L;u[K]=t.readUint32BE(A,k),p[K]=t.readUint32BE(A,k+4)}for(var K=0;K<80;K++){var W=N,b=T,R=q,E=j,C=J,B=X,s=P,I=O,D=z,V=h,Y=$,Q=F,it=G,Ut=M,vt=a,dt=c;if(d=O,v=c,_=v&65535,y=v>>>16,o=d&65535,m=d>>>16,d=(J>>>14|G<<32-14)^(J>>>18|G<<32-18)^(G>>>41-32|J<<32-(41-32)),v=(G>>>14|J<<32-14)^(G>>>18|J<<32-18)^(J>>>41-32|G<<32-(41-32)),_+=v&65535,y+=v>>>16,o+=d&65535,m+=d>>>16,d=J&X^~J&P,v=G&M^~G&a,_+=v&65535,y+=v>>>16,o+=d&65535,m+=d>>>16,d=i[K*2],v=i[K*2+1],_+=v&65535,y+=v>>>16,o+=d&65535,m+=d>>>16,d=u[K%16],v=p[K%16],_+=v&65535,y+=v>>>16,o+=d&65535,m+=d>>>16,y+=_>>>16,o+=y>>>16,m+=o>>>16,w=o&65535|m<<16,S=_&65535|y<<16,d=w,v=S,_=v&65535,y=v>>>16,o=d&65535,m=d>>>16,d=(N>>>28|z<<32-28)^(z>>>34-32|N<<32-(34-32))^(z>>>39-32|N<<32-(39-32)),v=(z>>>28|N<<32-28)^(N>>>34-32|z<<32-(34-32))^(N>>>39-32|z<<32-(39-32)),_+=v&65535,y+=v>>>16,o+=d&65535,m+=d>>>16,d=N&T^N&q^T&q,v=z&h^z&$^h&$,_+=v&65535,y+=v>>>16,o+=d&65535,m+=d>>>16,y+=_>>>16,o+=y>>>16,m+=o>>>16,I=o&65535|m<<16,dt=_&65535|y<<16,d=E,v=Q,_=v&65535,y=v>>>16,o=d&65535,m=d>>>16,d=w,v=S,_+=v&65535,y+=v>>>16,o+=d&65535,m+=d>>>16,y+=_>>>16,o+=y>>>16,m+=o>>>16,E=o&65535|m<<16,Q=_&65535|y<<16,T=W,q=b,j=R,J=E,X=C,P=B,O=s,N=I,h=D,$=V,F=Y,G=Q,M=it,a=Ut,c=vt,z=dt,K%16==15)for(var k=0;k<16;k++)d=u[k],v=p[k],_=v&65535,y=v>>>16,o=d&65535,m=d>>>16,d=u[(k+9)%16],v=p[(k+9)%16],_+=v&65535,y+=v>>>16,o+=d&65535,m+=d>>>16,w=u[(k+1)%16],S=p[(k+1)%16],d=(w>>>1|S<<32-1)^(w>>>8|S<<32-8)^w>>>7,v=(S>>>1|w<<32-1)^(S>>>8|w<<32-8)^(S>>>7|w<<32-7),_+=v&65535,y+=v>>>16,o+=d&65535,m+=d>>>16,w=u[(k+14)%16],S=p[(k+14)%16],d=(w>>>19|S<<32-19)^(S>>>61-32|w<<32-(61-32))^w>>>6,v=(S>>>19|w<<32-19)^(w>>>61-32|S<<32-(61-32))^(S>>>6|w<<32-6),_+=v&65535,y+=v>>>16,o+=d&65535,m+=d>>>16,y+=_>>>16,o+=y>>>16,m+=o>>>16,u[k]=o&65535|m<<16,p[k]=_&65535|y<<16}d=N,v=z,_=v&65535,y=v>>>16,o=d&65535,m=d>>>16,d=x[0],v=g[0],_+=v&65535,y+=v>>>16,o+=d&65535,m+=d>>>16,y+=_>>>16,o+=y>>>16,m+=o>>>16,x[0]=N=o&65535|m<<16,g[0]=z=_&65535|y<<16,d=T,v=h,_=v&65535,y=v>>>16,o=d&65535,m=d>>>16,d=x[1],v=g[1],_+=v&65535,y+=v>>>16,o+=d&65535,m+=d>>>16,y+=_>>>16,o+=y>>>16,m+=o>>>16,x[1]=T=o&65535|m<<16,g[1]=h=_&65535|y<<16,d=q,v=$,_=v&65535,y=v>>>16,o=d&65535,m=d>>>16,d=x[2],v=g[2],_+=v&65535,y+=v>>>16,o+=d&65535,m+=d>>>16,y+=_>>>16,o+=y>>>16,m+=o>>>16,x[2]=q=o&65535|m<<16,g[2]=$=_&65535|y<<16,d=j,v=F,_=v&65535,y=v>>>16,o=d&65535,m=d>>>16,d=x[3],v=g[3],_+=v&65535,y+=v>>>16,o+=d&65535,m+=d>>>16,y+=_>>>16,o+=y>>>16,m+=o>>>16,x[3]=j=o&65535|m<<16,g[3]=F=_&65535|y<<16,d=J,v=G,_=v&65535,y=v>>>16,o=d&65535,m=d>>>16,d=x[4],v=g[4],_+=v&65535,y+=v>>>16,o+=d&65535,m+=d>>>16,y+=_>>>16,o+=y>>>16,m+=o>>>16,x[4]=J=o&65535|m<<16,g[4]=G=_&65535|y<<16,d=X,v=M,_=v&65535,y=v>>>16,o=d&65535,m=d>>>16,d=x[5],v=g[5],_+=v&65535,y+=v>>>16,o+=d&65535,m+=d>>>16,y+=_>>>16,o+=y>>>16,m+=o>>>16,x[5]=X=o&65535|m<<16,g[5]=M=_&65535|y<<16,d=P,v=a,_=v&65535,y=v>>>16,o=d&65535,m=d>>>16,d=x[6],v=g[6],_+=v&65535,y+=v>>>16,o+=d&65535,m+=d>>>16,y+=_>>>16,o+=y>>>16,m+=o>>>16,x[6]=P=o&65535|m<<16,g[6]=a=_&65535|y<<16,d=O,v=c,_=v&65535,y=v>>>16,o=d&65535,m=d>>>16,d=x[7],v=g[7],_+=v&65535,y+=v>>>16,o+=d&65535,m+=d>>>16,y+=_>>>16,o+=y>>>16,m+=o>>>16,x[7]=O=o&65535|m<<16,g[7]=c=_&65535|y<<16,L+=128,U-=128}return L}function l(u){var p=new n;p.update(u);var x=p.digest();return p.clean(),x}e.hash=l})(Wf);(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=Or,r=Wf,n=de;e.SIGNATURE_LENGTH=64,e.PUBLIC_KEY_LENGTH=32,e.SECRET_KEY_LENGTH=64,e.SEED_LENGTH=32;function i(E){var C=new Float64Array(16);if(E)for(var B=0;B<E.length;B++)C[B]=E[B];return C}var f=new Uint8Array(32);f[0]=9;var l=i(),u=i([1]),p=i([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),x=i([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),g=i([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),A=i([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),L=i([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function U(E,C){for(var B=0;B<16;B++)E[B]=C[B]|0}function N(E){for(var C=1,B=0;B<16;B++){var s=E[B]+C+65535;C=Math.floor(s/65536),E[B]=s-C*65536}E[0]+=C-1+37*(C-1)}function T(E,C,B){for(var s=~(B-1),I=0;I<16;I++){var D=s&(E[I]^C[I]);E[I]^=D,C[I]^=D}}function q(E,C){for(var B=i(),s=i(),I=0;I<16;I++)s[I]=C[I];N(s),N(s),N(s);for(var D=0;D<2;D++){B[0]=s[0]-65517;for(var I=1;I<15;I++)B[I]=s[I]-65535-(B[I-1]>>16&1),B[I-1]&=65535;B[15]=s[15]-32767-(B[14]>>16&1);var V=B[15]>>16&1;B[14]&=65535,T(s,B,1-V)}for(var I=0;I<16;I++)E[2*I]=s[I]&255,E[2*I+1]=s[I]>>8}function j(E,C){for(var B=0,s=0;s<32;s++)B|=E[s]^C[s];return(1&B-1>>>8)-1}function J(E,C){var B=new Uint8Array(32),s=new Uint8Array(32);return q(B,E),q(s,C),j(B,s)}function X(E){var C=new Uint8Array(32);return q(C,E),C[0]&1}function P(E,C){for(var B=0;B<16;B++)E[B]=C[2*B]+(C[2*B+1]<<8);E[15]&=32767}function O(E,C,B){for(var s=0;s<16;s++)E[s]=C[s]+B[s]}function z(E,C,B){for(var s=0;s<16;s++)E[s]=C[s]-B[s]}function h(E,C,B){var s,I,D=0,V=0,Y=0,Q=0,it=0,Ut=0,vt=0,dt=0,Bt=0,ft=0,nt=0,pt=0,rt=0,et=0,lt=0,tt=0,at=0,$t=0,ot=0,st=0,Ct=0,ut=0,ct=0,zt=0,Pt=0,Rt=0,se=0,Tt=0,Dt=0,ye=0,kt=0,yt=B[0],Kt=B[1],gt=B[2],xt=B[3],Gt=B[4],wt=B[5],mt=B[6],Jt=B[7],_t=B[8],Mt=B[9],Xt=B[10],St=B[11],At=B[12],Wt=B[13],Et=B[14],It=B[15];s=C[0],D+=s*yt,V+=s*Kt,Y+=s*gt,Q+=s*xt,it+=s*Gt,Ut+=s*wt,vt+=s*mt,dt+=s*Jt,Bt+=s*_t,ft+=s*Mt,nt+=s*Xt,pt+=s*St,rt+=s*At,et+=s*Wt,lt+=s*Et,tt+=s*It,s=C[1],V+=s*yt,Y+=s*Kt,Q+=s*gt,it+=s*xt,Ut+=s*Gt,vt+=s*wt,dt+=s*mt,Bt+=s*Jt,ft+=s*_t,nt+=s*Mt,pt+=s*Xt,rt+=s*St,et+=s*At,lt+=s*Wt,tt+=s*Et,at+=s*It,s=C[2],Y+=s*yt,Q+=s*Kt,it+=s*gt,Ut+=s*xt,vt+=s*Gt,dt+=s*wt,Bt+=s*mt,ft+=s*Jt,nt+=s*_t,pt+=s*Mt,rt+=s*Xt,et+=s*St,lt+=s*At,tt+=s*Wt,at+=s*Et,$t+=s*It,s=C[3],Q+=s*yt,it+=s*Kt,Ut+=s*gt,vt+=s*xt,dt+=s*Gt,Bt+=s*wt,ft+=s*mt,nt+=s*Jt,pt+=s*_t,rt+=s*Mt,et+=s*Xt,lt+=s*St,tt+=s*At,at+=s*Wt,$t+=s*Et,ot+=s*It,s=C[4],it+=s*yt,Ut+=s*Kt,vt+=s*gt,dt+=s*xt,Bt+=s*Gt,ft+=s*wt,nt+=s*mt,pt+=s*Jt,rt+=s*_t,et+=s*Mt,lt+=s*Xt,tt+=s*St,at+=s*At,$t+=s*Wt,ot+=s*Et,st+=s*It,s=C[5],Ut+=s*yt,vt+=s*Kt,dt+=s*gt,Bt+=s*xt,ft+=s*Gt,nt+=s*wt,pt+=s*mt,rt+=s*Jt,et+=s*_t,lt+=s*Mt,tt+=s*Xt,at+=s*St,$t+=s*At,ot+=s*Wt,st+=s*Et,Ct+=s*It,s=C[6],vt+=s*yt,dt+=s*Kt,Bt+=s*gt,ft+=s*xt,nt+=s*Gt,pt+=s*wt,rt+=s*mt,et+=s*Jt,lt+=s*_t,tt+=s*Mt,at+=s*Xt,$t+=s*St,ot+=s*At,st+=s*Wt,Ct+=s*Et,ut+=s*It,s=C[7],dt+=s*yt,Bt+=s*Kt,ft+=s*gt,nt+=s*xt,pt+=s*Gt,rt+=s*wt,et+=s*mt,lt+=s*Jt,tt+=s*_t,at+=s*Mt,$t+=s*Xt,ot+=s*St,st+=s*At,Ct+=s*Wt,ut+=s*Et,ct+=s*It,s=C[8],Bt+=s*yt,ft+=s*Kt,nt+=s*gt,pt+=s*xt,rt+=s*Gt,et+=s*wt,lt+=s*mt,tt+=s*Jt,at+=s*_t,$t+=s*Mt,ot+=s*Xt,st+=s*St,Ct+=s*At,ut+=s*Wt,ct+=s*Et,zt+=s*It,s=C[9],ft+=s*yt,nt+=s*Kt,pt+=s*gt,rt+=s*xt,et+=s*Gt,lt+=s*wt,tt+=s*mt,at+=s*Jt,$t+=s*_t,ot+=s*Mt,st+=s*Xt,Ct+=s*St,ut+=s*At,ct+=s*Wt,zt+=s*Et,Pt+=s*It,s=C[10],nt+=s*yt,pt+=s*Kt,rt+=s*gt,et+=s*xt,lt+=s*Gt,tt+=s*wt,at+=s*mt,$t+=s*Jt,ot+=s*_t,st+=s*Mt,Ct+=s*Xt,ut+=s*St,ct+=s*At,zt+=s*Wt,Pt+=s*Et,Rt+=s*It,s=C[11],pt+=s*yt,rt+=s*Kt,et+=s*gt,lt+=s*xt,tt+=s*Gt,at+=s*wt,$t+=s*mt,ot+=s*Jt,st+=s*_t,Ct+=s*Mt,ut+=s*Xt,ct+=s*St,zt+=s*At,Pt+=s*Wt,Rt+=s*Et,se+=s*It,s=C[12],rt+=s*yt,et+=s*Kt,lt+=s*gt,tt+=s*xt,at+=s*Gt,$t+=s*wt,ot+=s*mt,st+=s*Jt,Ct+=s*_t,ut+=s*Mt,ct+=s*Xt,zt+=s*St,Pt+=s*At,Rt+=s*Wt,se+=s*Et,Tt+=s*It,s=C[13],et+=s*yt,lt+=s*Kt,tt+=s*gt,at+=s*xt,$t+=s*Gt,ot+=s*wt,st+=s*mt,Ct+=s*Jt,ut+=s*_t,ct+=s*Mt,zt+=s*Xt,Pt+=s*St,Rt+=s*At,se+=s*Wt,Tt+=s*Et,Dt+=s*It,s=C[14],lt+=s*yt,tt+=s*Kt,at+=s*gt,$t+=s*xt,ot+=s*Gt,st+=s*wt,Ct+=s*mt,ut+=s*Jt,ct+=s*_t,zt+=s*Mt,Pt+=s*Xt,Rt+=s*St,se+=s*At,Tt+=s*Wt,Dt+=s*Et,ye+=s*It,s=C[15],tt+=s*yt,at+=s*Kt,$t+=s*gt,ot+=s*xt,st+=s*Gt,Ct+=s*wt,ut+=s*mt,ct+=s*Jt,zt+=s*_t,Pt+=s*Mt,Rt+=s*Xt,se+=s*St,Tt+=s*At,Dt+=s*Wt,ye+=s*Et,kt+=s*It,D+=38*at,V+=38*$t,Y+=38*ot,Q+=38*st,it+=38*Ct,Ut+=38*ut,vt+=38*ct,dt+=38*zt,Bt+=38*Pt,ft+=38*Rt,nt+=38*se,pt+=38*Tt,rt+=38*Dt,et+=38*ye,lt+=38*kt,I=1,s=D+I+65535,I=Math.floor(s/65536),D=s-I*65536,s=V+I+65535,I=Math.floor(s/65536),V=s-I*65536,s=Y+I+65535,I=Math.floor(s/65536),Y=s-I*65536,s=Q+I+65535,I=Math.floor(s/65536),Q=s-I*65536,s=it+I+65535,I=Math.floor(s/65536),it=s-I*65536,s=Ut+I+65535,I=Math.floor(s/65536),Ut=s-I*65536,s=vt+I+65535,I=Math.floor(s/65536),vt=s-I*65536,s=dt+I+65535,I=Math.floor(s/65536),dt=s-I*65536,s=Bt+I+65535,I=Math.floor(s/65536),Bt=s-I*65536,s=ft+I+65535,I=Math.floor(s/65536),ft=s-I*65536,s=nt+I+65535,I=Math.floor(s/65536),nt=s-I*65536,s=pt+I+65535,I=Math.floor(s/65536),pt=s-I*65536,s=rt+I+65535,I=Math.floor(s/65536),rt=s-I*65536,s=et+I+65535,I=Math.floor(s/65536),et=s-I*65536,s=lt+I+65535,I=Math.floor(s/65536),lt=s-I*65536,s=tt+I+65535,I=Math.floor(s/65536),tt=s-I*65536,D+=I-1+37*(I-1),I=1,s=D+I+65535,I=Math.floor(s/65536),D=s-I*65536,s=V+I+65535,I=Math.floor(s/65536),V=s-I*65536,s=Y+I+65535,I=Math.floor(s/65536),Y=s-I*65536,s=Q+I+65535,I=Math.floor(s/65536),Q=s-I*65536,s=it+I+65535,I=Math.floor(s/65536),it=s-I*65536,s=Ut+I+65535,I=Math.floor(s/65536),Ut=s-I*65536,s=vt+I+65535,I=Math.floor(s/65536),vt=s-I*65536,s=dt+I+65535,I=Math.floor(s/65536),dt=s-I*65536,s=Bt+I+65535,I=Math.floor(s/65536),Bt=s-I*65536,s=ft+I+65535,I=Math.floor(s/65536),ft=s-I*65536,s=nt+I+65535,I=Math.floor(s/65536),nt=s-I*65536,s=pt+I+65535,I=Math.floor(s/65536),pt=s-I*65536,s=rt+I+65535,I=Math.floor(s/65536),rt=s-I*65536,s=et+I+65535,I=Math.floor(s/65536),et=s-I*65536,s=lt+I+65535,I=Math.floor(s/65536),lt=s-I*65536,s=tt+I+65535,I=Math.floor(s/65536),tt=s-I*65536,D+=I-1+37*(I-1),E[0]=D,E[1]=V,E[2]=Y,E[3]=Q,E[4]=it,E[5]=Ut,E[6]=vt,E[7]=dt,E[8]=Bt,E[9]=ft,E[10]=nt,E[11]=pt,E[12]=rt,E[13]=et,E[14]=lt,E[15]=tt}function $(E,C){h(E,C,C)}function F(E,C){var B=i(),s;for(s=0;s<16;s++)B[s]=C[s];for(s=253;s>=0;s--)$(B,B),s!==2&&s!==4&&h(B,B,C);for(s=0;s<16;s++)E[s]=B[s]}function G(E,C){var B=i(),s;for(s=0;s<16;s++)B[s]=C[s];for(s=250;s>=0;s--)$(B,B),s!==1&&h(B,B,C);for(s=0;s<16;s++)E[s]=B[s]}function M(E,C){var B=i(),s=i(),I=i(),D=i(),V=i(),Y=i(),Q=i(),it=i(),Ut=i();z(B,E[1],E[0]),z(Ut,C[1],C[0]),h(B,B,Ut),O(s,E[0],E[1]),O(Ut,C[0],C[1]),h(s,s,Ut),h(I,E[3],C[3]),h(I,I,x),h(D,E[2],C[2]),O(D,D,D),z(V,s,B),z(Y,D,I),O(Q,D,I),O(it,s,B),h(E[0],V,Y),h(E[1],it,Q),h(E[2],Q,Y),h(E[3],V,it)}function a(E,C,B){for(var s=0;s<4;s++)T(E[s],C[s],B)}function c(E,C){var B=i(),s=i(),I=i();F(I,C[2]),h(B,C[0],I),h(s,C[1],I),q(E,s),E[31]^=X(B)<<7}function d(E,C,B){U(E[0],l),U(E[1],u),U(E[2],u),U(E[3],l);for(var s=255;s>=0;--s){var I=B[s/8|0]>>(s&7)&1;a(E,C,I),M(C,E),M(E,E),a(E,C,I)}}function v(E,C){var B=[i(),i(),i(),i()];U(B[0],g),U(B[1],A),U(B[2],u),h(B[3],g,A),d(E,B,C)}function w(E){if(E.length!==e.SEED_LENGTH)throw new Error("ed25519: seed must be "+e.SEED_LENGTH+" bytes");var C=r.hash(E);C[0]&=248,C[31]&=127,C[31]|=64;var B=new Uint8Array(32),s=[i(),i(),i(),i()];v(s,C),c(B,s);var I=new Uint8Array(64);return I.set(E),I.set(B,32),{publicKey:B,secretKey:I}}e.generateKeyPairFromSeed=w;function S(E){var C=t.randomBytes(32,E),B=w(C);return n.wipe(C),B}e.generateKeyPair=S;function _(E){if(E.length!==e.SECRET_KEY_LENGTH)throw new Error("ed25519: secret key must be "+e.SECRET_KEY_LENGTH+" bytes");return new Uint8Array(E.subarray(32))}e.extractPublicKeyFromSecretKey=_;var y=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function o(E,C){var B,s,I,D;for(s=63;s>=32;--s){for(B=0,I=s-32,D=s-12;I<D;++I)C[I]+=B-16*C[s]*y[I-(s-32)],B=Math.floor((C[I]+128)/256),C[I]-=B*256;C[I]+=B,C[s]=0}for(B=0,I=0;I<32;I++)C[I]+=B-(C[31]>>4)*y[I],B=C[I]>>8,C[I]&=255;for(I=0;I<32;I++)C[I]-=B*y[I];for(s=0;s<32;s++)C[s+1]+=C[s]>>8,E[s]=C[s]&255}function m(E){for(var C=new Float64Array(64),B=0;B<64;B++)C[B]=E[B];for(var B=0;B<64;B++)E[B]=0;o(E,C)}function K(E,C){var B=new Float64Array(64),s=[i(),i(),i(),i()],I=r.hash(E.subarray(0,32));I[0]&=248,I[31]&=127,I[31]|=64;var D=new Uint8Array(64);D.set(I.subarray(32),32);var V=new r.SHA512;V.update(D.subarray(32)),V.update(C);var Y=V.digest();V.clean(),m(Y),v(s,Y),c(D,s),V.reset(),V.update(D.subarray(0,32)),V.update(E.subarray(32)),V.update(C);var Q=V.digest();m(Q);for(var it=0;it<32;it++)B[it]=Y[it];for(var it=0;it<32;it++)for(var Ut=0;Ut<32;Ut++)B[it+Ut]+=Q[it]*I[Ut];return o(D.subarray(32),B),D}e.sign=K;function k(E,C){var B=i(),s=i(),I=i(),D=i(),V=i(),Y=i(),Q=i();return U(E[2],u),P(E[1],C),$(I,E[1]),h(D,I,p),z(I,I,E[2]),O(D,E[2],D),$(V,D),$(Y,V),h(Q,Y,V),h(B,Q,I),h(B,B,D),G(B,B),h(B,B,I),h(B,B,D),h(B,B,D),h(E[0],B,D),$(s,E[0]),h(s,s,D),J(s,I)&&h(E[0],E[0],L),$(s,E[0]),h(s,s,D),J(s,I)?-1:(X(E[0])===C[31]>>7&&z(E[0],l,E[0]),h(E[3],E[0],E[1]),0)}function W(E,C,B){var s=new Uint8Array(32),I=[i(),i(),i(),i()],D=[i(),i(),i(),i()];if(B.length!==e.SIGNATURE_LENGTH)throw new Error("ed25519: signature must be "+e.SIGNATURE_LENGTH+" bytes");if(k(D,E))return!1;var V=new r.SHA512;V.update(B.subarray(0,32)),V.update(E),V.update(C);var Y=V.digest();return m(Y),d(I,D,Y),v(D,B.subarray(32)),M(I,D),c(s,I),!j(B,s)}e.verify=W;function b(E){var C=[i(),i(),i(),i()];if(k(C,E))throw new Error("Ed25519: invalid public key");var B=i(),s=i(),I=C[1];O(B,u,I),z(s,u,I),F(s,s),h(B,B,s);var D=new Uint8Array(32);return q(D,B),D}e.convertPublicKeyToX25519=b;function R(E){var C=r.hash(E.subarray(0,32));C[0]&=248,C[31]&=127,C[31]|=64;var B=new Uint8Array(C.subarray(0,32));return n.wipe(C),B}e.convertSecretKeyToX25519=R})(ou);var Dr={};Object.defineProperty(Dr,"__esModule",{value:!0});Dr.bech32m=Dr.bech32=void 0;const gn="qpzry9x8gf2tvdw0s3jn54khce6mua7l",Vf={};for(let e=0;e<gn.length;e++){const t=gn.charAt(e);Vf[t]=e}function Ir(e){const t=e>>25;return(e&33554431)<<5^-(t>>0&1)&996825010^-(t>>1&1)&642813549^-(t>>2&1)&513874426^-(t>>3&1)&1027748829^-(t>>4&1)&705979059}function Yf(e){let t=1;for(let r=0;r<e.length;++r){const n=e.charCodeAt(r);if(n<33||n>126)return"Invalid prefix ("+e+")";t=Ir(t)^n>>5}t=Ir(t);for(let r=0;r<e.length;++r){const n=e.charCodeAt(r);t=Ir(t)^n&31}return t}function Mi(e,t,r,n){let i=0,f=0;const l=(1<<r)-1,u=[];for(let p=0;p<e.length;++p)for(i=i<<t|e[p],f+=t;f>=r;)f-=r,u.push(i>>f&l);if(n)f>0&&u.push(i<<r-f&l);else{if(f>=t)return"Excess padding";if(i<<r-f&l)return"Non-zero padding"}return u}function su(e){return Mi(e,8,5,!0)}function hu(e){const t=Mi(e,5,8,!1);if(Array.isArray(t))return t}function uu(e){const t=Mi(e,5,8,!1);if(Array.isArray(t))return t;throw new Error(t)}function Zf(e){let t;e==="bech32"?t=1:t=734539939;function r(l,u,p){if(p=p||90,l.length+7+u.length>p)throw new TypeError("Exceeds length limit");l=l.toLowerCase();let x=Yf(l);if(typeof x=="string")throw new Error(x);let g=l+"1";for(let A=0;A<u.length;++A){const L=u[A];if(L>>5!=0)throw new Error("Non 5-bit word");x=Ir(x)^L,g+=gn.charAt(L)}for(let A=0;A<6;++A)x=Ir(x);x^=t;for(let A=0;A<6;++A){const L=x>>(5-A)*5&31;g+=gn.charAt(L)}return g}function n(l,u){if(u=u||90,l.length<8)return l+" too short";if(l.length>u)return"Exceeds length limit";const p=l.toLowerCase(),x=l.toUpperCase();if(l!==p&&l!==x)return"Mixed-case string "+l;l=p;const g=l.lastIndexOf("1");if(g===-1)return"No separator character for "+l;if(g===0)return"Missing prefix for "+l;const A=l.slice(0,g),L=l.slice(g+1);if(L.length<6)return"Data too short";let U=Yf(A);if(typeof U=="string")return U;const N=[];for(let T=0;T<L.length;++T){const q=L.charAt(T),j=Vf[q];if(j===void 0)return"Unknown character "+q;U=Ir(U)^j,!(T+6>=L.length)&&N.push(j)}return U!==t?"Invalid checksum for "+l:{prefix:A,words:N}}function i(l,u){const p=n(l,u);if(typeof p=="object")return p}function f(l,u){const p=n(l,u);if(typeof p=="object")return p;throw new Error(p)}return{decodeUnsafe:i,decode:f,encode:r,toWords:su,fromWordsUnsafe:hu,fromWords:uu}}Dr.bech32=Zf("bech32");Dr.bech32m=Zf("bech32m");var cu={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=Or,r=de;e.PUBLIC_KEY_LENGTH=32,e.SECRET_KEY_LENGTH=32,e.SHARED_KEY_LENGTH=32;function n(P){var O=new Float64Array(16);if(P)for(var z=0;z<P.length;z++)O[z]=P[z];return O}var i=new Uint8Array(32);i[0]=9;var f=n([56129,1]);function l(P){for(var O=1,z=0;z<16;z++){var h=P[z]+O+65535;O=Math.floor(h/65536),P[z]=h-O*65536}P[0]+=O-1+37*(O-1)}function u(P,O,z){for(var h=~(z-1),$=0;$<16;$++){var F=h&(P[$]^O[$]);P[$]^=F,O[$]^=F}}function p(P,O){for(var z=n(),h=n(),$=0;$<16;$++)h[$]=O[$];l(h),l(h),l(h);for(var F=0;F<2;F++){z[0]=h[0]-65517;for(var $=1;$<15;$++)z[$]=h[$]-65535-(z[$-1]>>16&1),z[$-1]&=65535;z[15]=h[15]-32767-(z[14]>>16&1);var G=z[15]>>16&1;z[14]&=65535,u(h,z,1-G)}for(var $=0;$<16;$++)P[2*$]=h[$]&255,P[2*$+1]=h[$]>>8}function x(P,O){for(var z=0;z<16;z++)P[z]=O[2*z]+(O[2*z+1]<<8);P[15]&=32767}function g(P,O,z){for(var h=0;h<16;h++)P[h]=O[h]+z[h]}function A(P,O,z){for(var h=0;h<16;h++)P[h]=O[h]-z[h]}function L(P,O,z){var h,$,F=0,G=0,M=0,a=0,c=0,d=0,v=0,w=0,S=0,_=0,y=0,o=0,m=0,K=0,k=0,W=0,b=0,R=0,E=0,C=0,B=0,s=0,I=0,D=0,V=0,Y=0,Q=0,it=0,Ut=0,vt=0,dt=0,Bt=z[0],ft=z[1],nt=z[2],pt=z[3],rt=z[4],et=z[5],lt=z[6],tt=z[7],at=z[8],$t=z[9],ot=z[10],st=z[11],Ct=z[12],ut=z[13],ct=z[14],zt=z[15];h=O[0],F+=h*Bt,G+=h*ft,M+=h*nt,a+=h*pt,c+=h*rt,d+=h*et,v+=h*lt,w+=h*tt,S+=h*at,_+=h*$t,y+=h*ot,o+=h*st,m+=h*Ct,K+=h*ut,k+=h*ct,W+=h*zt,h=O[1],G+=h*Bt,M+=h*ft,a+=h*nt,c+=h*pt,d+=h*rt,v+=h*et,w+=h*lt,S+=h*tt,_+=h*at,y+=h*$t,o+=h*ot,m+=h*st,K+=h*Ct,k+=h*ut,W+=h*ct,b+=h*zt,h=O[2],M+=h*Bt,a+=h*ft,c+=h*nt,d+=h*pt,v+=h*rt,w+=h*et,S+=h*lt,_+=h*tt,y+=h*at,o+=h*$t,m+=h*ot,K+=h*st,k+=h*Ct,W+=h*ut,b+=h*ct,R+=h*zt,h=O[3],a+=h*Bt,c+=h*ft,d+=h*nt,v+=h*pt,w+=h*rt,S+=h*et,_+=h*lt,y+=h*tt,o+=h*at,m+=h*$t,K+=h*ot,k+=h*st,W+=h*Ct,b+=h*ut,R+=h*ct,E+=h*zt,h=O[4],c+=h*Bt,d+=h*ft,v+=h*nt,w+=h*pt,S+=h*rt,_+=h*et,y+=h*lt,o+=h*tt,m+=h*at,K+=h*$t,k+=h*ot,W+=h*st,b+=h*Ct,R+=h*ut,E+=h*ct,C+=h*zt,h=O[5],d+=h*Bt,v+=h*ft,w+=h*nt,S+=h*pt,_+=h*rt,y+=h*et,o+=h*lt,m+=h*tt,K+=h*at,k+=h*$t,W+=h*ot,b+=h*st,R+=h*Ct,E+=h*ut,C+=h*ct,B+=h*zt,h=O[6],v+=h*Bt,w+=h*ft,S+=h*nt,_+=h*pt,y+=h*rt,o+=h*et,m+=h*lt,K+=h*tt,k+=h*at,W+=h*$t,b+=h*ot,R+=h*st,E+=h*Ct,C+=h*ut,B+=h*ct,s+=h*zt,h=O[7],w+=h*Bt,S+=h*ft,_+=h*nt,y+=h*pt,o+=h*rt,m+=h*et,K+=h*lt,k+=h*tt,W+=h*at,b+=h*$t,R+=h*ot,E+=h*st,C+=h*Ct,B+=h*ut,s+=h*ct,I+=h*zt,h=O[8],S+=h*Bt,_+=h*ft,y+=h*nt,o+=h*pt,m+=h*rt,K+=h*et,k+=h*lt,W+=h*tt,b+=h*at,R+=h*$t,E+=h*ot,C+=h*st,B+=h*Ct,s+=h*ut,I+=h*ct,D+=h*zt,h=O[9],_+=h*Bt,y+=h*ft,o+=h*nt,m+=h*pt,K+=h*rt,k+=h*et,W+=h*lt,b+=h*tt,R+=h*at,E+=h*$t,C+=h*ot,B+=h*st,s+=h*Ct,I+=h*ut,D+=h*ct,V+=h*zt,h=O[10],y+=h*Bt,o+=h*ft,m+=h*nt,K+=h*pt,k+=h*rt,W+=h*et,b+=h*lt,R+=h*tt,E+=h*at,C+=h*$t,B+=h*ot,s+=h*st,I+=h*Ct,D+=h*ut,V+=h*ct,Y+=h*zt,h=O[11],o+=h*Bt,m+=h*ft,K+=h*nt,k+=h*pt,W+=h*rt,b+=h*et,R+=h*lt,E+=h*tt,C+=h*at,B+=h*$t,s+=h*ot,I+=h*st,D+=h*Ct,V+=h*ut,Y+=h*ct,Q+=h*zt,h=O[12],m+=h*Bt,K+=h*ft,k+=h*nt,W+=h*pt,b+=h*rt,R+=h*et,E+=h*lt,C+=h*tt,B+=h*at,s+=h*$t,I+=h*ot,D+=h*st,V+=h*Ct,Y+=h*ut,Q+=h*ct,it+=h*zt,h=O[13],K+=h*Bt,k+=h*ft,W+=h*nt,b+=h*pt,R+=h*rt,E+=h*et,C+=h*lt,B+=h*tt,s+=h*at,I+=h*$t,D+=h*ot,V+=h*st,Y+=h*Ct,Q+=h*ut,it+=h*ct,Ut+=h*zt,h=O[14],k+=h*Bt,W+=h*ft,b+=h*nt,R+=h*pt,E+=h*rt,C+=h*et,B+=h*lt,s+=h*tt,I+=h*at,D+=h*$t,V+=h*ot,Y+=h*st,Q+=h*Ct,it+=h*ut,Ut+=h*ct,vt+=h*zt,h=O[15],W+=h*Bt,b+=h*ft,R+=h*nt,E+=h*pt,C+=h*rt,B+=h*et,s+=h*lt,I+=h*tt,D+=h*at,V+=h*$t,Y+=h*ot,Q+=h*st,it+=h*Ct,Ut+=h*ut,vt+=h*ct,dt+=h*zt,F+=38*b,G+=38*R,M+=38*E,a+=38*C,c+=38*B,d+=38*s,v+=38*I,w+=38*D,S+=38*V,_+=38*Y,y+=38*Q,o+=38*it,m+=38*Ut,K+=38*vt,k+=38*dt,$=1,h=F+$+65535,$=Math.floor(h/65536),F=h-$*65536,h=G+$+65535,$=Math.floor(h/65536),G=h-$*65536,h=M+$+65535,$=Math.floor(h/65536),M=h-$*65536,h=a+$+65535,$=Math.floor(h/65536),a=h-$*65536,h=c+$+65535,$=Math.floor(h/65536),c=h-$*65536,h=d+$+65535,$=Math.floor(h/65536),d=h-$*65536,h=v+$+65535,$=Math.floor(h/65536),v=h-$*65536,h=w+$+65535,$=Math.floor(h/65536),w=h-$*65536,h=S+$+65535,$=Math.floor(h/65536),S=h-$*65536,h=_+$+65535,$=Math.floor(h/65536),_=h-$*65536,h=y+$+65535,$=Math.floor(h/65536),y=h-$*65536,h=o+$+65535,$=Math.floor(h/65536),o=h-$*65536,h=m+$+65535,$=Math.floor(h/65536),m=h-$*65536,h=K+$+65535,$=Math.floor(h/65536),K=h-$*65536,h=k+$+65535,$=Math.floor(h/65536),k=h-$*65536,h=W+$+65535,$=Math.floor(h/65536),W=h-$*65536,F+=$-1+37*($-1),$=1,h=F+$+65535,$=Math.floor(h/65536),F=h-$*65536,h=G+$+65535,$=Math.floor(h/65536),G=h-$*65536,h=M+$+65535,$=Math.floor(h/65536),M=h-$*65536,h=a+$+65535,$=Math.floor(h/65536),a=h-$*65536,h=c+$+65535,$=Math.floor(h/65536),c=h-$*65536,h=d+$+65535,$=Math.floor(h/65536),d=h-$*65536,h=v+$+65535,$=Math.floor(h/65536),v=h-$*65536,h=w+$+65535,$=Math.floor(h/65536),w=h-$*65536,h=S+$+65535,$=Math.floor(h/65536),S=h-$*65536,h=_+$+65535,$=Math.floor(h/65536),_=h-$*65536,h=y+$+65535,$=Math.floor(h/65536),y=h-$*65536,h=o+$+65535,$=Math.floor(h/65536),o=h-$*65536,h=m+$+65535,$=Math.floor(h/65536),m=h-$*65536,h=K+$+65535,$=Math.floor(h/65536),K=h-$*65536,h=k+$+65535,$=Math.floor(h/65536),k=h-$*65536,h=W+$+65535,$=Math.floor(h/65536),W=h-$*65536,F+=$-1+37*($-1),P[0]=F,P[1]=G,P[2]=M,P[3]=a,P[4]=c,P[5]=d,P[6]=v,P[7]=w,P[8]=S,P[9]=_,P[10]=y,P[11]=o,P[12]=m,P[13]=K,P[14]=k,P[15]=W}function U(P,O){L(P,O,O)}function N(P,O){for(var z=n(),h=0;h<16;h++)z[h]=O[h];for(var h=253;h>=0;h--)U(z,z),h!==2&&h!==4&&L(z,z,O);for(var h=0;h<16;h++)P[h]=z[h]}function T(P,O){for(var z=new Uint8Array(32),h=new Float64Array(80),$=n(),F=n(),G=n(),M=n(),a=n(),c=n(),d=0;d<31;d++)z[d]=P[d];z[31]=P[31]&127|64,z[0]&=248,x(h,O);for(var d=0;d<16;d++)F[d]=h[d];$[0]=M[0]=1;for(var d=254;d>=0;--d){var v=z[d>>>3]>>>(d&7)&1;u($,F,v),u(G,M,v),g(a,$,G),A($,$,G),g(G,F,M),A(F,F,M),U(M,a),U(c,$),L($,G,$),L(G,F,a),g(a,$,G),A($,$,G),U(F,$),A(G,M,c),L($,G,f),g($,$,M),L(G,G,$),L($,M,c),L(M,F,h),U(F,a),u($,F,v),u(G,M,v)}for(var d=0;d<16;d++)h[d+16]=$[d],h[d+32]=G[d],h[d+48]=F[d],h[d+64]=M[d];var w=h.subarray(32),S=h.subarray(16);N(w,w),L(S,S,w);var _=new Uint8Array(32);return p(_,S),_}e.scalarMult=T;function q(P){return T(P,i)}e.scalarMultBase=q;function j(P){if(P.length!==e.SECRET_KEY_LENGTH)throw new Error("x25519: seed must be "+e.SECRET_KEY_LENGTH+" bytes");var O=new Uint8Array(P),z=q(O);return{publicKey:z,secretKey:O}}e.generateKeyPairFromSeed=j;function J(P){var O=t.randomBytes(32,P),z=j(O);return r.wipe(O),z}e.generateKeyPair=J;function X(P,O,z){if(z===void 0&&(z=!1),P.length!==e.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(O.length!==e.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");var h=T(P,O);if(z){for(var $=0,F=0;F<h.length;F++)$|=h[F];if($===0)throw new Error("X25519: invalid shared key")}return h}e.sharedKey=X})(cu);var Si={},kr={},qr={};Object.defineProperty(qr,"__esModule",{value:!0});var ae=bt,Ai=de,du=20;function lu(e,t,r){for(var n=1634760805,i=857760878,f=2036477234,l=1797285236,u=r[3]<<24|r[2]<<16|r[1]<<8|r[0],p=r[7]<<24|r[6]<<16|r[5]<<8|r[4],x=r[11]<<24|r[10]<<16|r[9]<<8|r[8],g=r[15]<<24|r[14]<<16|r[13]<<8|r[12],A=r[19]<<24|r[18]<<16|r[17]<<8|r[16],L=r[23]<<24|r[22]<<16|r[21]<<8|r[20],U=r[27]<<24|r[26]<<16|r[25]<<8|r[24],N=r[31]<<24|r[30]<<16|r[29]<<8|r[28],T=t[3]<<24|t[2]<<16|t[1]<<8|t[0],q=t[7]<<24|t[6]<<16|t[5]<<8|t[4],j=t[11]<<24|t[10]<<16|t[9]<<8|t[8],J=t[15]<<24|t[14]<<16|t[13]<<8|t[12],X=n,P=i,O=f,z=l,h=u,$=p,F=x,G=g,M=A,a=L,c=U,d=N,v=T,w=q,S=j,_=J,y=0;y<du;y+=2)X=X+h|0,v^=X,v=v>>>32-16|v<<16,M=M+v|0,h^=M,h=h>>>32-12|h<<12,P=P+$|0,w^=P,w=w>>>32-16|w<<16,a=a+w|0,$^=a,$=$>>>32-12|$<<12,O=O+F|0,S^=O,S=S>>>32-16|S<<16,c=c+S|0,F^=c,F=F>>>32-12|F<<12,z=z+G|0,_^=z,_=_>>>32-16|_<<16,d=d+_|0,G^=d,G=G>>>32-12|G<<12,O=O+F|0,S^=O,S=S>>>32-8|S<<8,c=c+S|0,F^=c,F=F>>>32-7|F<<7,z=z+G|0,_^=z,_=_>>>32-8|_<<8,d=d+_|0,G^=d,G=G>>>32-7|G<<7,P=P+$|0,w^=P,w=w>>>32-8|w<<8,a=a+w|0,$^=a,$=$>>>32-7|$<<7,X=X+h|0,v^=X,v=v>>>32-8|v<<8,M=M+v|0,h^=M,h=h>>>32-7|h<<7,X=X+$|0,_^=X,_=_>>>32-16|_<<16,c=c+_|0,$^=c,$=$>>>32-12|$<<12,P=P+F|0,v^=P,v=v>>>32-16|v<<16,d=d+v|0,F^=d,F=F>>>32-12|F<<12,O=O+G|0,w^=O,w=w>>>32-16|w<<16,M=M+w|0,G^=M,G=G>>>32-12|G<<12,z=z+h|0,S^=z,S=S>>>32-16|S<<16,a=a+S|0,h^=a,h=h>>>32-12|h<<12,O=O+G|0,w^=O,w=w>>>32-8|w<<8,M=M+w|0,G^=M,G=G>>>32-7|G<<7,z=z+h|0,S^=z,S=S>>>32-8|S<<8,a=a+S|0,h^=a,h=h>>>32-7|h<<7,P=P+F|0,v^=P,v=v>>>32-8|v<<8,d=d+v|0,F^=d,F=F>>>32-7|F<<7,X=X+$|0,_^=X,_=_>>>32-8|_<<8,c=c+_|0,$^=c,$=$>>>32-7|$<<7;ae.writeUint32LE(X+n|0,e,0),ae.writeUint32LE(P+i|0,e,4),ae.writeUint32LE(O+f|0,e,8),ae.writeUint32LE(z+l|0,e,12),ae.writeUint32LE(h+u|0,e,16),ae.writeUint32LE($+p|0,e,20),ae.writeUint32LE(F+x|0,e,24),ae.writeUint32LE(G+g|0,e,28),ae.writeUint32LE(M+A|0,e,32),ae.writeUint32LE(a+L|0,e,36),ae.writeUint32LE(c+U|0,e,40),ae.writeUint32LE(d+N|0,e,44),ae.writeUint32LE(v+T|0,e,48),ae.writeUint32LE(w+q|0,e,52),ae.writeUint32LE(S+j|0,e,56),ae.writeUint32LE(_+J|0,e,60)}function Qf(e,t,r,n,i){if(i===void 0&&(i=0),e.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(n.length<r.length)throw new Error("ChaCha: destination is shorter than source");var f,l;if(i===0){if(t.length!==8&&t.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");f=new Uint8Array(16),l=f.length-t.length,f.set(t,l)}else{if(t.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");f=t,l=i}for(var u=new Uint8Array(64),p=0;p<r.length;p+=64){lu(u,f,e);for(var x=p;x<p+64&&x<r.length;x++)n[x]=r[x]^u[x-p];pu(f,0,l)}return Ai.wipe(u),i===0&&Ai.wipe(f),n}qr.streamXOR=Qf;function vu(e,t,r,n){return n===void 0&&(n=0),Ai.wipe(r),Qf(e,t,r,r,n)}qr.stream=vu;function pu(e,t,r){for(var n=1;r--;)n=n+(e[t]&255)|0,e[t]=n&255,n>>>=8,t++;if(n>0)throw new Error("ChaCha: counter overflow")}Object.defineProperty(kr,"__esModule",{value:!0});var We=bt,ta=de,bu=qr,yu=20;function ea(e,t,r,n){if(t.length!==24)throw new Error("XChaCha20 nonce must be 24 bytes");var i=ra(e,t.subarray(0,16),new Uint8Array(32)),f=new Uint8Array(12);f.set(t.subarray(16),4);var l=bu.streamXOR(i,f,r,n);return ta.wipe(i),l}kr.streamXOR=ea;function gu(e,t,r){return ta.wipe(r),ea(e,t,r,r)}kr.stream=gu;function ra(e,t,r){for(var n=1634760805,i=857760878,f=2036477234,l=1797285236,u=e[3]<<24|e[2]<<16|e[1]<<8|e[0],p=e[7]<<24|e[6]<<16|e[5]<<8|e[4],x=e[11]<<24|e[10]<<16|e[9]<<8|e[8],g=e[15]<<24|e[14]<<16|e[13]<<8|e[12],A=e[19]<<24|e[18]<<16|e[17]<<8|e[16],L=e[23]<<24|e[22]<<16|e[21]<<8|e[20],U=e[27]<<24|e[26]<<16|e[25]<<8|e[24],N=e[31]<<24|e[30]<<16|e[29]<<8|e[28],T=t[3]<<24|t[2]<<16|t[1]<<8|t[0],q=t[7]<<24|t[6]<<16|t[5]<<8|t[4],j=t[11]<<24|t[10]<<16|t[9]<<8|t[8],J=t[15]<<24|t[14]<<16|t[13]<<8|t[12],X=n,P=i,O=f,z=l,h=u,$=p,F=x,G=g,M=A,a=L,c=U,d=N,v=T,w=q,S=j,_=J,y=0;y<yu;y+=2)X=X+h|0,v^=X,v=v>>>32-16|v<<16,M=M+v|0,h^=M,h=h>>>32-12|h<<12,P=P+$|0,w^=P,w=w>>>32-16|w<<16,a=a+w|0,$^=a,$=$>>>32-12|$<<12,O=O+F|0,S^=O,S=S>>>32-16|S<<16,c=c+S|0,F^=c,F=F>>>32-12|F<<12,z=z+G|0,_^=z,_=_>>>32-16|_<<16,d=d+_|0,G^=d,G=G>>>32-12|G<<12,O=O+F|0,S^=O,S=S>>>32-8|S<<8,c=c+S|0,F^=c,F=F>>>32-7|F<<7,z=z+G|0,_^=z,_=_>>>32-8|_<<8,d=d+_|0,G^=d,G=G>>>32-7|G<<7,P=P+$|0,w^=P,w=w>>>32-8|w<<8,a=a+w|0,$^=a,$=$>>>32-7|$<<7,X=X+h|0,v^=X,v=v>>>32-8|v<<8,M=M+v|0,h^=M,h=h>>>32-7|h<<7,X=X+$|0,_^=X,_=_>>>32-16|_<<16,c=c+_|0,$^=c,$=$>>>32-12|$<<12,P=P+F|0,v^=P,v=v>>>32-16|v<<16,d=d+v|0,F^=d,F=F>>>32-12|F<<12,O=O+G|0,w^=O,w=w>>>32-16|w<<16,M=M+w|0,G^=M,G=G>>>32-12|G<<12,z=z+h|0,S^=z,S=S>>>32-16|S<<16,a=a+S|0,h^=a,h=h>>>32-12|h<<12,O=O+G|0,w^=O,w=w>>>32-8|w<<8,M=M+w|0,G^=M,G=G>>>32-7|G<<7,z=z+h|0,S^=z,S=S>>>32-8|S<<8,a=a+S|0,h^=a,h=h>>>32-7|h<<7,P=P+F|0,v^=P,v=v>>>32-8|v<<8,d=d+v|0,F^=d,F=F>>>32-7|F<<7,X=X+$|0,_^=X,_=_>>>32-8|_<<8,c=c+_|0,$^=c,$=$>>>32-7|$<<7;return We.writeUint32LE(X,r,0),We.writeUint32LE(P,r,4),We.writeUint32LE(O,r,8),We.writeUint32LE(z,r,12),We.writeUint32LE(v,r,16),We.writeUint32LE(w,r,20),We.writeUint32LE(S,r,24),We.writeUint32LE(_,r,28),r}kr.hchacha=ra;var na={},ia={},sr={};Object.defineProperty(sr,"__esModule",{value:!0});function xu(e,t,r){return~(e-1)&t|e-1&r}sr.select=xu;function wu(e,t){return(e|0)-(t|0)-1>>>31&1}sr.lessOrEqual=wu;function fa(e,t){if(e.length!==t.length)return 0;for(var r=0,n=0;n<e.length;n++)r|=e[n]^t[n];return 1&r-1>>>8}sr.compare=fa;function mu(e,t){return e.length===0||t.length===0?!1:fa(e,t)!==0}sr.equal=mu;(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=sr,r=de;e.DIGEST_LENGTH=16;var n=function(){function l(u){this.digestLength=e.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var p=u[0]|u[1]<<8;this._r[0]=p&8191;var x=u[2]|u[3]<<8;this._r[1]=(p>>>13|x<<3)&8191;var g=u[4]|u[5]<<8;this._r[2]=(x>>>10|g<<6)&7939;var A=u[6]|u[7]<<8;this._r[3]=(g>>>7|A<<9)&8191;var L=u[8]|u[9]<<8;this._r[4]=(A>>>4|L<<12)&255,this._r[5]=L>>>1&8190;var U=u[10]|u[11]<<8;this._r[6]=(L>>>14|U<<2)&8191;var N=u[12]|u[13]<<8;this._r[7]=(U>>>11|N<<5)&8065;var T=u[14]|u[15]<<8;this._r[8]=(N>>>8|T<<8)&8191,this._r[9]=T>>>5&127,this._pad[0]=u[16]|u[17]<<8,this._pad[1]=u[18]|u[19]<<8,this._pad[2]=u[20]|u[21]<<8,this._pad[3]=u[22]|u[23]<<8,this._pad[4]=u[24]|u[25]<<8,this._pad[5]=u[26]|u[27]<<8,this._pad[6]=u[28]|u[29]<<8,this._pad[7]=u[30]|u[31]<<8}return l.prototype._blocks=function(u,p,x){for(var g=this._fin?0:1<<11,A=this._h[0],L=this._h[1],U=this._h[2],N=this._h[3],T=this._h[4],q=this._h[5],j=this._h[6],J=this._h[7],X=this._h[8],P=this._h[9],O=this._r[0],z=this._r[1],h=this._r[2],$=this._r[3],F=this._r[4],G=this._r[5],M=this._r[6],a=this._r[7],c=this._r[8],d=this._r[9];x>=16;){var v=u[p+0]|u[p+1]<<8;A+=v&8191;var w=u[p+2]|u[p+3]<<8;L+=(v>>>13|w<<3)&8191;var S=u[p+4]|u[p+5]<<8;U+=(w>>>10|S<<6)&8191;var _=u[p+6]|u[p+7]<<8;N+=(S>>>7|_<<9)&8191;var y=u[p+8]|u[p+9]<<8;T+=(_>>>4|y<<12)&8191,q+=y>>>1&8191;var o=u[p+10]|u[p+11]<<8;j+=(y>>>14|o<<2)&8191;var m=u[p+12]|u[p+13]<<8;J+=(o>>>11|m<<5)&8191;var K=u[p+14]|u[p+15]<<8;X+=(m>>>8|K<<8)&8191,P+=K>>>5|g;var k=0,W=k;W+=A*O,W+=L*(5*d),W+=U*(5*c),W+=N*(5*a),W+=T*(5*M),k=W>>>13,W&=8191,W+=q*(5*G),W+=j*(5*F),W+=J*(5*$),W+=X*(5*h),W+=P*(5*z),k+=W>>>13,W&=8191;var b=k;b+=A*z,b+=L*O,b+=U*(5*d),b+=N*(5*c),b+=T*(5*a),k=b>>>13,b&=8191,b+=q*(5*M),b+=j*(5*G),b+=J*(5*F),b+=X*(5*$),b+=P*(5*h),k+=b>>>13,b&=8191;var R=k;R+=A*h,R+=L*z,R+=U*O,R+=N*(5*d),R+=T*(5*c),k=R>>>13,R&=8191,R+=q*(5*a),R+=j*(5*M),R+=J*(5*G),R+=X*(5*F),R+=P*(5*$),k+=R>>>13,R&=8191;var E=k;E+=A*$,E+=L*h,E+=U*z,E+=N*O,E+=T*(5*d),k=E>>>13,E&=8191,E+=q*(5*c),E+=j*(5*a),E+=J*(5*M),E+=X*(5*G),E+=P*(5*F),k+=E>>>13,E&=8191;var C=k;C+=A*F,C+=L*$,C+=U*h,C+=N*z,C+=T*O,k=C>>>13,C&=8191,C+=q*(5*d),C+=j*(5*c),C+=J*(5*a),C+=X*(5*M),C+=P*(5*G),k+=C>>>13,C&=8191;var B=k;B+=A*G,B+=L*F,B+=U*$,B+=N*h,B+=T*z,k=B>>>13,B&=8191,B+=q*O,B+=j*(5*d),B+=J*(5*c),B+=X*(5*a),B+=P*(5*M),k+=B>>>13,B&=8191;var s=k;s+=A*M,s+=L*G,s+=U*F,s+=N*$,s+=T*h,k=s>>>13,s&=8191,s+=q*z,s+=j*O,s+=J*(5*d),s+=X*(5*c),s+=P*(5*a),k+=s>>>13,s&=8191;var I=k;I+=A*a,I+=L*M,I+=U*G,I+=N*F,I+=T*$,k=I>>>13,I&=8191,I+=q*h,I+=j*z,I+=J*O,I+=X*(5*d),I+=P*(5*c),k+=I>>>13,I&=8191;var D=k;D+=A*c,D+=L*a,D+=U*M,D+=N*G,D+=T*F,k=D>>>13,D&=8191,D+=q*$,D+=j*h,D+=J*z,D+=X*O,D+=P*(5*d),k+=D>>>13,D&=8191;var V=k;V+=A*d,V+=L*c,V+=U*a,V+=N*M,V+=T*G,k=V>>>13,V&=8191,V+=q*F,V+=j*$,V+=J*h,V+=X*z,V+=P*O,k+=V>>>13,V&=8191,k=(k<<2)+k|0,k=k+W|0,W=k&8191,k=k>>>13,b+=k,A=W,L=b,U=R,N=E,T=C,q=B,j=s,J=I,X=D,P=V,p+=16,x-=16}this._h[0]=A,this._h[1]=L,this._h[2]=U,this._h[3]=N,this._h[4]=T,this._h[5]=q,this._h[6]=j,this._h[7]=J,this._h[8]=X,this._h[9]=P},l.prototype.finish=function(u,p){p===void 0&&(p=0);var x=new Uint16Array(10),g,A,L,U;if(this._leftover){for(U=this._leftover,this._buffer[U++]=1;U<16;U++)this._buffer[U]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(g=this._h[1]>>>13,this._h[1]&=8191,U=2;U<10;U++)this._h[U]+=g,g=this._h[U]>>>13,this._h[U]&=8191;for(this._h[0]+=g*5,g=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=g,g=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=g,x[0]=this._h[0]+5,g=x[0]>>>13,x[0]&=8191,U=1;U<10;U++)x[U]=this._h[U]+g,g=x[U]>>>13,x[U]&=8191;for(x[9]-=1<<13,A=(g^1)-1,U=0;U<10;U++)x[U]&=A;for(A=~A,U=0;U<10;U++)this._h[U]=this._h[U]&A|x[U];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,L=this._h[0]+this._pad[0],this._h[0]=L&65535,U=1;U<8;U++)L=(this._h[U]+this._pad[U]|0)+(L>>>16)|0,this._h[U]=L&65535;return u[p+0]=this._h[0]>>>0,u[p+1]=this._h[0]>>>8,u[p+2]=this._h[1]>>>0,u[p+3]=this._h[1]>>>8,u[p+4]=this._h[2]>>>0,u[p+5]=this._h[2]>>>8,u[p+6]=this._h[3]>>>0,u[p+7]=this._h[3]>>>8,u[p+8]=this._h[4]>>>0,u[p+9]=this._h[4]>>>8,u[p+10]=this._h[5]>>>0,u[p+11]=this._h[5]>>>8,u[p+12]=this._h[6]>>>0,u[p+13]=this._h[6]>>>8,u[p+14]=this._h[7]>>>0,u[p+15]=this._h[7]>>>8,this._finished=!0,this},l.prototype.update=function(u){var p=0,x=u.length,g;if(this._leftover){g=16-this._leftover,g>x&&(g=x);for(var A=0;A<g;A++)this._buffer[this._leftover+A]=u[p+A];if(x-=g,p+=g,this._leftover+=g,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(x>=16&&(g=x-x%16,this._blocks(u,p,g),p+=g,x-=g),x){for(var A=0;A<x;A++)this._buffer[this._leftover+A]=u[p+A];this._leftover+=x}return this},l.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var u=new Uint8Array(16);return this.finish(u),u},l.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},l}();e.Poly1305=n;function i(l,u){var p=new n(l);p.update(u);var x=p.digest();return p.clean(),x}e.oneTimeAuth=i;function f(l,u){return l.length!==e.DIGEST_LENGTH||u.length!==e.DIGEST_LENGTH?!1:t.equal(l,u)}e.equal=f})(ia);(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=qr,r=ia,n=de,i=bt,f=sr;e.KEY_LENGTH=32,e.NONCE_LENGTH=12,e.TAG_LENGTH=16;var l=new Uint8Array(16),u=function(){function p(x){if(this.nonceLength=e.NONCE_LENGTH,this.tagLength=e.TAG_LENGTH,x.length!==e.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(x)}return p.prototype.seal=function(x,g,A,L){if(x.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var U=new Uint8Array(16);U.set(x,U.length-x.length);var N=new Uint8Array(32);t.stream(this._key,U,N,4);var T=g.length+this.tagLength,q;if(L){if(L.length!==T)throw new Error("ChaCha20Poly1305: incorrect destination length");q=L}else q=new Uint8Array(T);return t.streamXOR(this._key,U,g,q,4),this._authenticate(q.subarray(q.length-this.tagLength,q.length),N,q.subarray(0,q.length-this.tagLength),A),n.wipe(U),q},p.prototype.open=function(x,g,A,L){if(x.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(g.length<this.tagLength)return null;var U=new Uint8Array(16);U.set(x,U.length-x.length);var N=new Uint8Array(32);t.stream(this._key,U,N,4);var T=new Uint8Array(this.tagLength);if(this._authenticate(T,N,g.subarray(0,g.length-this.tagLength),A),!f.equal(T,g.subarray(g.length-this.tagLength,g.length)))return null;var q=g.length-this.tagLength,j;if(L){if(L.length!==q)throw new Error("ChaCha20Poly1305: incorrect destination length");j=L}else j=new Uint8Array(q);return t.streamXOR(this._key,U,g.subarray(0,g.length-this.tagLength),j,4),n.wipe(U),j},p.prototype.clean=function(){return n.wipe(this._key),this},p.prototype._authenticate=function(x,g,A,L){var U=new r.Poly1305(g);L&&(U.update(L),L.length%16>0&&U.update(l.subarray(L.length%16))),U.update(A),A.length%16>0&&U.update(l.subarray(A.length%16));var N=new Uint8Array(8);L&&i.writeUint64LE(L.length,N),U.update(N),i.writeUint64LE(A.length,N),U.update(N);for(var T=U.digest(),q=0;q<T.length;q++)x[q]=T[q];U.clean(),n.wipe(T),n.wipe(N)},p}();e.ChaCha20Poly1305=u})(na);(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=kr,r=na,n=de;e.KEY_LENGTH=32,e.NONCE_LENGTH=24,e.TAG_LENGTH=16;var i=function(){function f(l){if(this.nonceLength=e.NONCE_LENGTH,this.tagLength=e.TAG_LENGTH,l.length!==e.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(l)}return f.prototype.seal=function(l,u,p,x){if(l.length!==24)throw new Error("XChaCha20Poly1305: incorrect nonce length");var g=t.hchacha(this._key,l.subarray(0,16),new Uint8Array(32)),A=new Uint8Array(12);A.set(l.subarray(16),4);var L=new r.ChaCha20Poly1305(g),U=L.seal(A,u,p,x);return n.wipe(g),n.wipe(A),L.clean(),U},f.prototype.open=function(l,u,p,x){if(l.length!==24)throw new Error("XChaCha20Poly1305: incorrect nonce length");if(u.length<this.tagLength)return null;var g=t.hchacha(this._key,l.subarray(0,16),new Uint8Array(32)),A=new Uint8Array(12);A.set(l.subarray(16),4);var L=new r.ChaCha20Poly1305(g),U=L.open(A,u,p,x);return n.wipe(g),n.wipe(A),L.clean(),U},f.prototype.clean=function(){return n.wipe(this._key),this},f}();e.XChaCha20Poly1305=i})(Si);function Br(e){return Xf(e,"base64url")}function Fr(e){const t=e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"");return yn(t,"base64url")}function _u(e){return Br(yn(e))}function Mu(e){return Xf(Fr(e))}function Su(e,t){return jh([Fr(e),Fr(t)])}new Zr.ec("secp256k1");Zr.ec;new Zr.ec("secp256k1");function Au(e,t,r){for(var n;;){var i=e();if(Ve(i)&&(i=i.v),!i)return f;if(i.then){n=0;break}var f=r();if(f&&f.then)if(Ve(f))f=f.s;else{n=1;break}if(t){var l=t();if(l&&l.then&&!Ve(l)){n=2;break}}}var u=new hr,p=Zt.bind(null,u,2);return(n===0?i.then(g):n===1?f.then(x):l.then(A)).then(void 0,p),u;function x(L){f=L;do{if(t&&(l=t(),l&&l.then&&!Ve(l))){l.then(A).then(void 0,p);return}if(i=e(),!i||Ve(i)&&!i.v){Zt(u,1,f);return}if(i.then){i.then(g).then(void 0,p);return}f=r(),Ve(f)&&(f=f.v)}while(!f||!f.then);f.then(x).then(void 0,p)}function g(L){L?(f=r(),f&&f.then?f.then(x).then(void 0,p):x(f)):Zt(u,1,f)}function A(){(i=e())?i.then?i.then(g).then(void 0,p):g(i):Zt(u,1,f)}}const Eu=function(e,t){try{let n=function(x){if(u===null)throw new Error("failure: Failed to decrypt");return u},r;$u(e);const i=JSON.parse(Mu(e.protected));if(i.enc!==t.enc)throw new Error(`not_supported: Decrypter does not supported: '${i.enc}'`);const f=Su(e.ciphertext,e.tag),l=yn(e.aad?`${e.protected}.${e.aad}`:e.protected);let u=null;const p=function(){return i.alg==="dir"&&t.alg==="dir"?Promise.resolve(t.decrypt(f,Fr(e.iv),l)).then(function(x){u=x}):function(){if(!e.recipients||e.recipients.length===0)throw new Error("bad_jwe: missing recipients");{let x=0;return Au(function(){return!u&&x<e.recipients.length},function(){return x++},function(){const g=e.recipients[x];Object.assign(g.header,i);const A=function(){if(g.header.alg===t.alg)return Promise.resolve(t.decrypt(f,Fr(e.iv),l,g)).then(function(L){u=L})}();if(A&&A.then)return A.then(function(){})})}}()}();return Promise.resolve(p&&p.then?p.then(n):n(p))}catch(r){return Promise.reject(r)}},aa=typeof Symbol!="undefined"?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function Zt(e,t,r){if(!e.s){if(r instanceof hr)if(r.s)t&1&&(t=r.s),r=r.v;else{r.o=Zt.bind(null,e,t);return}if(r&&r.then){r.then(Zt.bind(null,e,t),Zt.bind(null,e,2));return}e.s=t,e.v=r;const n=e.o;n&&n(e)}}const hr=function(){function e(){}return e.prototype.then=function(t,r){const n=new e,i=this.s;if(i){const f=i&1?t:r;if(f){try{Zt(n,1,f(this.v))}catch(l){Zt(n,2,l)}return n}else return this}return this.o=function(f){try{const l=f.v;f.s&1?Zt(n,1,t?t(l):l):r?Zt(n,1,r(l)):Zt(n,2,l)}catch(l){Zt(n,2,l)}},n},e}();function Ve(e){return e instanceof hr&&e.s&1}function Iu(e,t,r){var n=-1,i,f;function l(u){try{for(;++n<e.length&&(!r||!r());)if(u=t(n),u&&u.then)if(Ve(u))u=u.v;else{u.then(l,f||(f=Zt.bind(null,i=new hr,2)));return}i?Zt(i,1,u):i=u}catch(p){Zt(i||(i=new hr),2,p)}}return l(),i}function Bu(e,t,r){if(typeof e[aa]=="function"){let g=function(A){try{for(;!(i=n.next()).done&&(!r||!r());)if(A=t(i.value),A&&A.then)if(Ve(A))A=A.v;else{A.then(g,l||(l=Zt.bind(null,f=new hr,2)));return}f?Zt(f,1,A):f=A}catch(L){Zt(f||(f=new hr),2,L)}};var n=e[aa](),i,f,l;if(g(),n.return){var u=function(A){try{i.done||n.return()}catch{}return A};if(f&&f.then)return f.then(u,function(A){throw u(A)});u()}return f}if(!("length"in e))throw new TypeError("Object is not iterable");for(var p=[],x=0;x<e.length;x++)p.push(e[x]);return Iu(p,function(g){return t(p[g])},r)}function $u(e){if(!(e.protected&&e.iv&&e.ciphertext&&e.tag))throw new Error("bad_jwe: missing properties");e.recipients&&e.recipients.map(t=>{if(!(t.header&&t.encrypted_key))throw new Error("bad_jwe: malformed recipients")})}function oa({ciphertext:e,tag:t,iv:r,protectedHeader:n,recipient:i},f){const l={protected:n,iv:Br(r),ciphertext:Br(e),tag:Br(t)};return f&&(l.aad=Br(f)),i&&(l.recipients=[i]),l}const Uu=function(e,t,r={},n){try{if(t[0].alg==="dir"){if(t.length>1)throw new Error('not_supported: Can only do "dir" encryption to one key.');return Promise.resolve(t[0].encrypt(e,r,n)).then(function(i){return oa(i,n)})}else{const i=t[0].enc;if(!t.reduce((p,x)=>p&&x.enc===i,!0))throw new Error("invalid_argument: Incompatible encrypters passed");let f,l;const u=Bu(t,function(p){const x=function(){return f?Promise.resolve(p.encryptCek==null?void 0:p.encryptCek(f)).then(function(g){if(g){var A,L;(A=l)==null||(L=A.recipients)==null||L.push(g)}}):Promise.resolve(p.encrypt(e,r,n)).then(function(g){f=g.cek,l=oa(g,n)})}();if(x&&x.then)return x.then(function(){})});return Promise.resolve(u&&u.then?u.then(function(){return l}):l)}}catch(i){return Promise.reject(i)}};function Cu(e){const t=new Si.XChaCha20Poly1305(e);return(r,n)=>{const i=Or.randomBytes(t.nonceLength),f=t.seal(i,r,n);return{ciphertext:f.subarray(0,f.length-t.tagLength),tag:f.subarray(f.length-t.tagLength),iv:i}}}function Nu(e){const t=function(f,l={},u){try{const p=_u(JSON.stringify(Object.assign({alg:i},l,{enc:n}))),x=yn(u?`${p}.${Br(u)}`:p);return Promise.resolve(Yr(Vt({},r(f,x)),{protectedHeader:p}))}catch(p){return Promise.reject(p)}},r=Cu(e),n="XC20P",i="dir";return{alg:i,enc:n,encrypt:t}}function Lu(e){const t=function(n,i,f){try{return Promise.resolve(r.open(i,n,f))}catch(l){return Promise.reject(l)}},r=new Si.XChaCha20Poly1305(e);return{alg:"dir",enc:"XC20P",decrypt:t}}var oe={},zu=ha,sa=128,Pu=127,Ru=~Pu,Ou=Math.pow(2,31);function ha(e,t,r){t=t||[],r=r||0;for(var n=r;e>=Ou;)t[r++]=e&255|sa,e/=128;for(;e&Ru;)t[r++]=e&255|sa,e>>>=7;return t[r]=e|0,ha.bytes=r-n+1,t}var Tu=Ei,Du=128,ua=127;function Ei(e,t){var r=0,t=t||0,n=0,i=t,f,l=e.length;do{if(i>=l)throw Ei.bytes=0,new RangeError("Could not decode varint");f=e[i++],r+=n<28?(f&ua)<<n:(f&ua)*Math.pow(2,n),n+=7}while(f>=Du);return Ei.bytes=i-t,r}var ku=Math.pow(2,7),qu=Math.pow(2,14),Fu=Math.pow(2,21),Hu=Math.pow(2,28),ju=Math.pow(2,35),Ku=Math.pow(2,42),Gu=Math.pow(2,49),Ju=Math.pow(2,56),Xu=Math.pow(2,63),Wu=function(e){return e<ku?1:e<qu?2:e<Fu?3:e<Hu?4:e<ju?5:e<Ku?6:e<Gu?7:e<Ju?8:e<Xu?9:10},Vu={encode:zu,decode:Tu,encodingLength:Wu},xn=Vu;const Ii=e=>[xn.decode(e),xn.decode.bytes],wn=(e,t,r=0)=>(xn.encode(e,t,r),t),mn=e=>xn.encodingLength(e),ca=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0},_n=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},da=(e,t)=>{const r=t.byteLength,n=mn(e),i=n+mn(r),f=new Uint8Array(i+r);return wn(e,f,0),wn(r,f,n),f.set(t,i),new Bi(e,r,t,f)},Yu=e=>{const t=_n(e),[r,n]=Ii(t),[i,f]=Ii(t.subarray(n)),l=t.subarray(n+f);if(l.byteLength!==i)throw new Error("Incorrect length");return new Bi(r,i,l,t)},Zu=(e,t)=>e===t?!0:e.code===t.code&&e.size===t.size&&ca(e.bytes,t.bytes);class Bi{constructor(t,r,n,i){this.code=t,this.size=r,this.digest=n,this.bytes=i}}function Qu(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),r=0;r<t.length;r++)t[r]=255;for(var n=0;n<e.length;n++){var i=e.charAt(n),f=i.charCodeAt(0);if(t[f]!==255)throw new TypeError(i+" is ambiguous");t[f]=n}var l=e.length,u=e.charAt(0),p=Math.log(l)/Math.log(256),x=Math.log(256)/Math.log(l);function g(U){if(U instanceof Uint8Array||(ArrayBuffer.isView(U)?U=new Uint8Array(U.buffer,U.byteOffset,U.byteLength):Array.isArray(U)&&(U=Uint8Array.from(U))),!(U instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(U.length===0)return"";for(var N=0,T=0,q=0,j=U.length;q!==j&&U[q]===0;)q++,N++;for(var J=(j-q)*x+1>>>0,X=new Uint8Array(J);q!==j;){for(var P=U[q],O=0,z=J-1;(P!==0||O<T)&&z!==-1;z--,O++)P+=256*X[z]>>>0,X[z]=P%l>>>0,P=P/l>>>0;if(P!==0)throw new Error("Non-zero carry");T=O,q++}for(var h=J-T;h!==J&&X[h]===0;)h++;for(var $=u.repeat(N);h<J;++h)$+=e.charAt(X[h]);return $}function A(U){if(typeof U!="string")throw new TypeError("Expected String");if(U.length===0)return new Uint8Array;var N=0;if(U[N]!==" "){for(var T=0,q=0;U[N]===u;)T++,N++;for(var j=(U.length-N)*p+1>>>0,J=new Uint8Array(j);U[N];){var X=t[U.charCodeAt(N)];if(X===255)return;for(var P=0,O=j-1;(X!==0||P<q)&&O!==-1;O--,P++)X+=l*J[O]>>>0,J[O]=X%256>>>0,X=X/256>>>0;if(X!==0)throw new Error("Non-zero carry");q=P,N++}if(U[N]!==" "){for(var z=j-q;z!==j&&J[z]===0;)z++;for(var h=new Uint8Array(T+(j-z)),$=T;z!==j;)h[$++]=J[z++];return h}}}function L(U){var N=A(U);if(N)return N;throw new Error("Non-base"+l+" character")}return{encode:g,decodeUnsafe:A,decode:L}}var tc=Qu,ec=tc;class rc{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class nc{constructor(t,r,n){this.name=t,this.prefix=r,this.baseDecode=n}decode(t){if(typeof t=="string")switch(t[0]){case this.prefix:return this.baseDecode(t.slice(1));default:throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)}else throw Error("Can only multibase decode strings")}or(t){const r=Vt({[this.prefix]:this},t.decoders||{[t.prefix]:t});return new $i(r)}}class $i{constructor(t){this.decoders=t}or(t){const r=t.decoders||{[t.prefix]:t};return new $i(Vt(Vt({},this.decoders),r))}decode(t){const r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}class ic{constructor(t,r,n,i){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new rc(t,r,n),this.decoder=new nc(t,r,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Hr=({name:e,prefix:t,encode:r,decode:n,alphabet:i})=>Mn({name:e,prefix:t,encode:f=>r(f,i),decode:f=>{for(const l of f)if(i.indexOf(l)<0)throw new Error(`invalid ${e} character`);return n(f,i)}}),fc=({name:e,prefix:t,settings:r,encode:n,decode:i})=>Mn({name:e,prefix:t,encode:f=>n(f,r),decode:f=>i(f,r)}),Mn=({name:e,prefix:t,encode:r,decode:n})=>new ic(e,t,r,n),la=e=>{const{encode:t,decode:r}=ec(e);return{encode:t,decode:n=>_n(r(n))}},Ye=Mn(Vt({name:"base58btc",prefix:"z"},la("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")));Mn(Vt({name:"base58flickr",prefix:"Z"},la("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ")));function jr(e,t){e=e.replace(/=/g,"");const r=e.length;let n=0,i=0,f=0;const l=new Uint8Array(r*5/8|0);for(let u=0;u<r;u++)i=i<<5|t.indexOf(e[u]),n+=5,n>=8&&(l[f++]=i>>>n-8&255,n-=8);return l}function Kr(e,t){const r=e.byteLength,n=new Uint8Array(e),i=t.indexOf("=")===t.length-1;i&&(t=t.substring(0,t.length-1));let f=0,l=0,u="";for(let p=0;p<r;p++)for(l=l<<8|n[p],f+=8;f>=5;)u+=t[l>>>f-5&31],f-=5;if(f>0&&(u+=t[l<<5-f&31]),i)for(;u.length%8!=0;)u+="=";return u}const Sn=Hr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",encode:Kr,decode:jr});Hr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",encode:Kr,decode:jr});Hr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",encode:Kr,decode:jr});Hr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",encode:Kr,decode:jr});Hr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",encode:Kr,decode:jr});class jt{constructor(t,r,n,i){this.code=r,this.version=t,this.multihash=n,this.bytes=i,this.byteOffset=i.byteOffset,this.byteLength=i.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:En,byteLength:En,code:An,version:An,multihash:An,bytes:An,_baseCache:En,asCID:En})}toV0(){switch(this.version){case 0:return this;default:{const{code:t,multihash:r}=this;if(t!==Gr)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==hc)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return jt.createV0(r)}}}toV1(){switch(this.version){case 0:{const{code:t,digest:r}=this.multihash,n=da(t,r);return jt.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(t){return t&&this.code===t.code&&this.version===t.version&&Zu(this.multihash,t.multihash)}toString(t){const{bytes:r,version:n,_baseCache:i}=this;switch(n){case 0:return oc(r,i,t||Ye.encoder);default:return sc(r,i,t||Sn.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(t){return cc(/^0\.0/,dc),!!(t&&(t[pa]||t.asCID===t))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(t){if(t instanceof jt)return t;if(t!=null&&t.asCID===t){const{version:r,code:n,multihash:i,bytes:f}=t;return new jt(r,n,i,f||va(r,n,i.bytes))}else if(t!=null&&t[pa]===!0){const{version:r,multihash:n,code:i}=t,f=Yu(n);return jt.create(r,i,f)}else return null}static create(t,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");switch(t){case 0:{if(r!==Gr)throw new Error(`Version 0 CID must use dag-pb (code: ${Gr}) block encoding`);return new jt(t,r,n,n.bytes)}case 1:{const i=va(t,r,n.bytes);return new jt(t,r,n,i)}default:throw new Error("Invalid version")}}static createV0(t){return jt.create(0,Gr,t)}static createV1(t,r){return jt.create(1,t,r)}static decode(t){const[r,n]=jt.decodeFirst(t);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(t){const r=jt.inspectBytes(t),n=r.size-r.multihashSize,i=_n(t.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");const f=i.subarray(r.multihashSize-r.digestSize),l=new Bi(r.multihashCode,r.digestSize,f,i);return[r.version===0?jt.createV0(l):jt.createV1(r.codec,l),t.subarray(r.size)]}static inspectBytes(t){let r=0;const n=()=>{const[A,L]=Ii(t.subarray(r));return r+=L,A};let i=n(),f=Gr;if(i===18)i=0,r=0;else if(i===1)f=n();else if(i!==1)throw new RangeError(`Invalid CID version ${i}`);const l=r,u=n(),p=n(),x=r+p,g=x-l;return{version:i,codec:f,multihashCode:u,digestSize:p,multihashSize:g,size:x}}static parse(t,r){const[n,i]=ac(t,r),f=jt.decode(i);return f._baseCache.set(n,t),f}}const ac=(e,t)=>{switch(e[0]){case"Q":{const r=t||Ye;return[Ye.prefix,r.decode(`${Ye.prefix}${e}`)]}case Ye.prefix:{const r=t||Ye;return[Ye.prefix,r.decode(e)]}case Sn.prefix:{const r=t||Sn;return[Sn.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32 or base56btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}},oc=(e,t,r)=>{const{prefix:n}=r;if(n!==Ye.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const i=t.get(n);if(i==null){const f=r.encode(e).slice(1);return t.set(n,f),f}else return i},sc=(e,t,r)=>{const{prefix:n}=r,i=t.get(n);if(i==null){const f=r.encode(e);return t.set(n,f),f}else return i},Gr=112,hc=18,va=(e,t,r)=>{const n=mn(e),i=n+mn(t),f=new Uint8Array(i+r.byteLength);return wn(e,f,0),wn(t,f,n),f.set(r,i),f},pa=Symbol.for("@ipld/js-cid/CID"),An={writable:!1,configurable:!1,enumerable:!0},En={writable:!1,enumerable:!1,configurable:!1},uc="0.0.0-dev",cc=(e,t)=>{if(e.test(uc))console.warn(t);else throw new Error(t)},dc=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`;var lc=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",CID:jt});const Ui=({name:e,code:t,encode:r})=>new vc(e,t,r);class vc{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}async digest(t){if(t instanceof Uint8Array){const r=await this.encode(t);return da(this.code,r)}else throw Error("Unknown type, must be binary type")}}const In=({enumerable:e=!0,configurable:t=!1}={})=>({enumerable:e,configurable:t,writable:!1}),Ci=function*(e,t){if(e!=null)for(const[r,n]of Object.entries(e)){const i=[...t,r];if(n!=null&&typeof n=="object")if(Array.isArray(n))for(const[f,l]of n.entries()){const u=[...i,f],p=jt.asCID(l);p?yield[u.join("/"),p]:typeof l=="object"&&(yield*Ci(l,u))}else{const f=jt.asCID(n);f?yield[i.join("/"),f]:yield*Ci(n,i)}}},Ni=function*(e,t){if(e!=null)for(const[r,n]of Object.entries(e)){const i=[...t,r];if(yield i.join("/"),n!=null&&typeof n=="object"&&!jt.asCID(n))if(Array.isArray(n))for(const[f,l]of n.entries()){const u=[...i,f];yield u.join("/"),typeof l=="object"&&!jt.asCID(l)&&(yield*Ni(l,u))}else yield*Ni(n,i)}},pc=(e,t)=>{let r=e;for(const[n,i]of t.entries()){if(r=r[i],r==null)throw new Error(`Object has no property at ${t.slice(0,n+1).map(l=>`[${JSON.stringify(l)}]`).join("")}`);const f=jt.asCID(r);if(f)return{value:f,remaining:t.slice(n+1).join("/")}}return{value:r}};class Bn{constructor({cid:t,bytes:r,value:n}){if(!t||!r||typeof n=="undefined")throw new Error("Missing required argument");this.cid=t,this.bytes=r,this.value=n,this.asBlock=this,Object.defineProperties(this,{cid:In(),bytes:In(),value:In(),asBlock:In()})}links(){return Ci(this.value,[])}tree(){return Ni(this.value,[])}get(t="/"){return pc(this.value,t.split("/").filter(Boolean))}}const bc=async({value:e,codec:t,hasher:r})=>{if(typeof e=="undefined")throw new Error('Missing required argument "value"');if(!t||!r)throw new Error("Missing required argument: codec or hasher");const n=t.encode(e),i=await r.digest(n),f=jt.create(1,t.code,i);return new Bn({value:e,bytes:n,cid:f})},yc=async({bytes:e,codec:t,hasher:r})=>{if(!e)throw new Error('Missing required argument "bytes"');if(!t||!r)throw new Error("Missing required argument: codec or hasher");const n=t.decode(e),i=await r.digest(e),f=jt.create(1,t.code,i);return new Bn({value:n,bytes:e,cid:f})},ba=({bytes:e,cid:t,value:r,codec:n})=>{const i=r!==void 0?r:n&&n.decode(e);if(i===void 0)throw new Error('Missing required argument, must either provide "value" or "codec"');return new Bn({cid:t,bytes:e,value:i})},gc=async({bytes:e,cid:t,hasher:r,codec:n})=>{if(!e)throw new Error('Missing required argument "bytes"');if(!r)throw new Error('Missing required argument "hasher"');const i=n.decode(e),f=await r.digest(e);if(!ca(t.multihash.bytes,f.bytes))throw new Error("CID hash does not match bytes");return ba({bytes:e,cid:t,value:i,codec:n})};var xc=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",encode:bc,decode:yc,create:gc,createUnsafe:ba,Block:Bn}),wc=er(xc),mc=er(lc);const ya=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),_c=Ui({name:"sha2-256",code:18,encode:ya("SHA-256")}),Mc=Ui({name:"sha2-512",code:19,encode:ya("SHA-512")}),Sc=!0;var Ac=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",sha256:_c,sha512:Mc,__browser:Sc}),Ec=er(Ac);const Ic=Ui({name:"identity",code:0,encode:e=>_n(e)});var Bc=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",identity:Ic}),$c=er(Bc);const Uc=e=>({alphabet:e,padding:e.indexOf("=")>-1,url:e.indexOf("-")>-1&&e.indexOf("_")>-1});var Cc=e=>{const t=(i,{url:f,padding:l})=>{let u=e.encode(i);f&&(u=u.replace(/\+/g,"-").replace(/\//g,"_"));const p=u.indexOf("=");return p>0&&!l&&(u=u.substring(0,p)),u},r=(i,{alphabet:f})=>{for(const l of i)if(f.indexOf(l)<0)throw new Error("invalid base64 character");return e.decode(i)},n=({name:i,prefix:f,alphabet:l})=>fc({name:i,prefix:f,settings:Uc(l),decode:r,encode:t});return{b64:e,__browser:e.__browser,base64:n({name:"base64",prefix:"m",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"}),base64pad:n({name:"base64pad",prefix:"M",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}),base64url:n({name:"base64url",prefix:"u",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"}),base64urlpad:n({name:"base64urlpad",prefix:"U",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_="})}};const{base64:Nc,base64pad:Lc,base64url:zc,base64urlpad:Pc,__browser:Rc}=Cc({encode:e=>btoa(e.reduce((t,r)=>t+String.fromCharCode(r),"")),decode:e=>Uint8Array.from(atob(e),t=>t.charCodeAt(0)),__browser:!0});var Oc=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",base64:Nc,base64pad:Lc,base64url:zc,base64urlpad:Pc,__browser:Rc}),Tc=er(Oc);const Dc=["string","number","bigint","symbol"],kc=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function qc(e){if(e===null)return"null";if(e===void 0)return"undefined";if(e===!0||e===!1)return"boolean";const t=typeof e;if(Dc.includes(t))return t;if(t==="function")return"Function";if(Array.isArray(e))return"Array";if(Fc(e))return"Buffer";const r=Hc(e);return r||"Object"}function Fc(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}function Hc(e){const t=Object.prototype.toString.call(e).slice(8,-1);if(kc.includes(t))return t}class H{constructor(t,r,n){this.major=t,this.majorEncoded=t<<5,this.name=r,this.terminal=n}toString(){return`Type[${this.major}].${this.name}`}compare(t){return this.major<t.major?-1:this.major>t.major?1:0}}H.uint=new H(0,"uint",!0);H.negint=new H(1,"negint",!0);H.bytes=new H(2,"bytes",!0);H.string=new H(3,"string",!0);H.array=new H(4,"array",!1);H.map=new H(5,"map",!1);H.tag=new H(6,"tag",!1);H.float=new H(7,"float",!0);H.false=new H(7,"false",!0);H.true=new H(7,"true",!0);H.null=new H(7,"null",!0);H.undefined=new H(7,"undefined",!0);H.break=new H(7,"break",!0);class ht{constructor(t,r,n){this.type=t,this.value=r,this.encodedLength=n,this.encodedBytes=void 0}toString(){return`Token[${this.type}].${this.value}`}}const $r=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",jc=new TextDecoder,Kc=new TextEncoder;function $n(e){return $r&&globalThis.Buffer.isBuffer(e)}function Li(e){return e instanceof Uint8Array?$n(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}const Gc=$r?(e,t,r)=>r-t>64?globalThis.Buffer.from(e.subarray(t,r)).toString("utf8"):ma(e,t,r):(e,t,r)=>r-t>64?jc.decode(e.subarray(t,r)):ma(e,t,r),ga=$r?e=>e.length>64?globalThis.Buffer.from(e):wa(e):e=>e.length>64?Kc.encode(e):wa(e),Re=e=>Uint8Array.from(e),xa=$r?(e,t,r)=>$n(e)?new Uint8Array(e.subarray(t,r)):e.slice(t,r):(e,t,r)=>e.slice(t,r),Jc=$r?(e,t)=>(e=e.map(r=>r instanceof Uint8Array?r:globalThis.Buffer.from(r)),Li(globalThis.Buffer.concat(e,t))):(e,t)=>{const r=new Uint8Array(t);let n=0;for(let i of e)n+i.length>r.length&&(i=i.subarray(0,r.length-n)),r.set(i,n),n+=i.length;return r},Xc=$r?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function Wc(e,t){if($n(e)&&$n(t))return e.compare(t);for(let r=0;r<e.length;r++)if(e[r]!==t[r])return e[r]<t[r]?-1:1;return 0}function wa(e,t=1/0){let r;const n=e.length;let i=null;const f=[];for(let l=0;l<n;++l){if(r=e.charCodeAt(l),r>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&f.push(239,191,189);continue}else if(l+1===n){(t-=3)>-1&&f.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&f.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(t-=3)>-1&&f.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;f.push(r)}else if(r<2048){if((t-=2)<0)break;f.push(r>>6|192,r&63|128)}else if(r<65536){if((t-=3)<0)break;f.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((t-=4)<0)break;f.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return f}function ma(e,t,r){const n=[];for(;t<r;){const i=e[t];let f=null,l=i>239?4:i>223?3:i>191?2:1;if(t+l<=r){let u,p,x,g;switch(l){case 1:i<128&&(f=i);break;case 2:u=e[t+1],(u&192)==128&&(g=(i&31)<<6|u&63,g>127&&(f=g));break;case 3:u=e[t+1],p=e[t+2],(u&192)==128&&(p&192)==128&&(g=(i&15)<<12|(u&63)<<6|p&63,g>2047&&(g<55296||g>57343)&&(f=g));break;case 4:u=e[t+1],p=e[t+2],x=e[t+3],(u&192)==128&&(p&192)==128&&(x&192)==128&&(g=(i&15)<<18|(u&63)<<12|(p&63)<<6|x&63,g>65535&&g<1114112&&(f=g))}}f===null?(f=65533,l=1):f>65535&&(f-=65536,n.push(f>>>10&1023|55296),f=56320|f&1023),n.push(f),t+=l}return Vc(n)}const _a=4096;function Vc(e){const t=e.length;if(t<=_a)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=_a));return r}const Yc=256;class Ma{constructor(t=Yc){this.chunkSize=t,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.chunks=[],this.cursor=0,this.maxCursor=-1,this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(t){let r=this.chunks[this.chunks.length-1];if(this.cursor+t.length<=this.maxCursor+1){const i=r.length-(this.maxCursor-this.cursor)-1;r.set(t,i)}else{if(r){const i=r.length-(this.maxCursor-this.cursor)-1;i<r.length&&(this.chunks[this.chunks.length-1]=r.subarray(0,i),this.maxCursor=this.cursor-1)}t.length<64&&t.length<this.chunkSize?(r=Xc(this.chunkSize),this.chunks.push(r),this.maxCursor+=r.length,this._initReuseChunk===null&&(this._initReuseChunk=r),r.set(t,0)):(this.chunks.push(t),this.maxCursor+=t.length)}this.cursor+=t.length}toBytes(t=!1){let r;if(this.chunks.length===1){const n=this.chunks[0];t&&this.cursor>n.length/2?(r=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):r=xa(n,0,this.cursor)}else r=Jc(this.chunks,this.cursor);return t&&this.reset(),r}}const Lt="CBOR decode error:",Un="CBOR encode error:";function Ur(e,t,r){if(e.length-t<r)throw new Error(`${Lt} not enough data for type`)}const ie=[24,256,65536,4294967296,BigInt("18446744073709551616")];function ur(e,t,r){Ur(e,t,1);const n=e[t];if(r.strict===!0&&n<ie[0])throw new Error(`${Lt} integer encoded in more bytes than necessary (strict decode)`);return n}function cr(e,t,r){Ur(e,t,2);const n=e[t]<<8|e[t+1];if(r.strict===!0&&n<ie[1])throw new Error(`${Lt} integer encoded in more bytes than necessary (strict decode)`);return n}function dr(e,t,r){Ur(e,t,4);const n=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(r.strict===!0&&n<ie[2])throw new Error(`${Lt} integer encoded in more bytes than necessary (strict decode)`);return n}function lr(e,t,r){Ur(e,t,8);const n=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],i=e[t+4]*16777216+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],f=(BigInt(n)<<BigInt(32))+BigInt(i);if(r.strict===!0&&f<ie[3])throw new Error(`${Lt} integer encoded in more bytes than necessary (strict decode)`);if(f<=Number.MAX_SAFE_INTEGER)return Number(f);if(r.allowBigInt===!0)return f;throw new Error(`${Lt} integers outside of the safe integer range are not supported`)}function Zc(e,t,r,n){return new ht(H.uint,ur(e,t+1,n),2)}function Qc(e,t,r,n){return new ht(H.uint,cr(e,t+1,n),3)}function td(e,t,r,n){return new ht(H.uint,dr(e,t+1,n),5)}function ed(e,t,r,n){return new ht(H.uint,lr(e,t+1,n),9)}function vr(e,t){return Oe(e,0,t.value)}function Oe(e,t,r){if(r<ie[0]){const n=Number(r);e.push([t|n])}else if(r<ie[1]){const n=Number(r);e.push([t|24,n])}else if(r<ie[2]){const n=Number(r);e.push([t|25,n>>>8,n&255])}else if(r<ie[3]){const n=Number(r);e.push([t|26,n>>>24&255,n>>>16&255,n>>>8&255,n&255])}else{const n=BigInt(r);if(n<ie[4]){const i=[t|27,0,0,0,0,0,0,0];let f=Number(n&BigInt(4294967295)),l=Number(n>>BigInt(32)&BigInt(4294967295));i[8]=f&255,f=f>>8,i[7]=f&255,f=f>>8,i[6]=f&255,f=f>>8,i[5]=f&255,i[4]=l&255,l=l>>8,i[3]=l&255,l=l>>8,i[2]=l&255,l=l>>8,i[1]=l&255,e.push(i)}else throw new Error(`${Lt} encountered BigInt larger than allowable range`)}}vr.encodedSize=function(t){return Oe.encodedSize(t.value)};Oe.encodedSize=function(t){return t<ie[0]?1:t<ie[1]?2:t<ie[2]?3:t<ie[3]?5:9};vr.compareTokens=function(t,r){return t.value<r.value?-1:t.value>r.value?1:0};function rd(e,t,r,n){return new ht(H.negint,-1-ur(e,t+1,n),2)}function nd(e,t,r,n){return new ht(H.negint,-1-cr(e,t+1,n),3)}function id(e,t,r,n){return new ht(H.negint,-1-dr(e,t+1,n),5)}const zi=BigInt(-1),Sa=BigInt(1);function fd(e,t,r,n){const i=lr(e,t+1,n);if(typeof i!="bigint"){const f=-1-i;if(f>=Number.MIN_SAFE_INTEGER)return new ht(H.negint,f,9)}if(n.allowBigInt!==!0)throw new Error(`${Lt} integers outside of the safe integer range are not supported`);return new ht(H.negint,zi-BigInt(i),9)}function Pi(e,t){const r=t.value,n=typeof r=="bigint"?r*zi-Sa:r*-1-1;Oe(e,t.type.majorEncoded,n)}Pi.encodedSize=function(t){const r=t.value,n=typeof r=="bigint"?r*zi-Sa:r*-1-1;return n<ie[0]?1:n<ie[1]?2:n<ie[2]?3:n<ie[3]?5:9};Pi.compareTokens=function(t,r){return t.value<r.value?1:t.value>r.value?-1:0};function Jr(e,t,r,n){Ur(e,t,r+n);const i=xa(e,t+r,t+r+n);return new ht(H.bytes,i,r+n)}function ad(e,t,r,n){return Jr(e,t,1,r)}function od(e,t,r,n){return Jr(e,t,2,ur(e,t+1,n))}function sd(e,t,r,n){return Jr(e,t,3,cr(e,t+1,n))}function hd(e,t,r,n){return Jr(e,t,5,dr(e,t+1,n))}function ud(e,t,r,n){const i=lr(e,t+1,n);if(typeof i=="bigint")throw new Error(`${Lt} 64-bit integer bytes lengths not supported`);return Jr(e,t,9,i)}function Cn(e){return e.encodedBytes===void 0&&(e.encodedBytes=e.type===H.string?ga(e.value):e.value),e.encodedBytes}function Nn(e,t){const r=Cn(t);Oe(e,t.type.majorEncoded,r.length),e.push(r)}Nn.encodedSize=function(t){const r=Cn(t);return Oe.encodedSize(r.length)+r.length};Nn.compareTokens=function(t,r){return cd(Cn(t),Cn(r))};function cd(e,t){return e.length<t.length?-1:e.length>t.length?1:Wc(e,t)}function Xr(e,t,r,n){const i=r+n;return Ur(e,t,i),new ht(H.string,Gc(e,t+r,t+i),i)}function dd(e,t,r,n){return Xr(e,t,1,r)}function ld(e,t,r,n){return Xr(e,t,2,ur(e,t+1,n))}function vd(e,t,r,n){return Xr(e,t,3,cr(e,t+1,n))}function pd(e,t,r,n){return Xr(e,t,5,dr(e,t+1,n))}function bd(e,t,r,n){const i=lr(e,t+1,n);if(typeof i=="bigint")throw new Error(`${Lt} 64-bit integer string lengths not supported`);return Xr(e,t,9,i)}const yd=Nn;function Cr(e,t,r,n){return new ht(H.array,n,r)}function gd(e,t,r,n){return Cr(e,t,1,r)}function xd(e,t,r,n){return Cr(e,t,2,ur(e,t+1,n))}function wd(e,t,r,n){return Cr(e,t,3,cr(e,t+1,n))}function md(e,t,r,n){return Cr(e,t,5,dr(e,t+1,n))}function _d(e,t,r,n){const i=lr(e,t+1,n);if(typeof i=="bigint")throw new Error(`${Lt} 64-bit integer array lengths not supported`);return Cr(e,t,9,i)}function Md(e,t,r,n){if(n.allowIndefinite===!1)throw new Error(`${Lt} indefinite length items not allowed`);return Cr(e,t,1,1/0)}function Aa(e,t){Oe(e,H.array.majorEncoded,t.value)}Aa.compareTokens=vr.compareTokens;function Nr(e,t,r,n){return new ht(H.map,n,r)}function Sd(e,t,r,n){return Nr(e,t,1,r)}function Ad(e,t,r,n){return Nr(e,t,2,ur(e,t+1,n))}function Ed(e,t,r,n){return Nr(e,t,3,cr(e,t+1,n))}function Id(e,t,r,n){return Nr(e,t,5,dr(e,t+1,n))}function Bd(e,t,r,n){const i=lr(e,t+1,n);if(typeof i=="bigint")throw new Error(`${Lt} 64-bit integer map lengths not supported`);return Nr(e,t,9,i)}function $d(e,t,r,n){if(n.allowIndefinite===!1)throw new Error(`${Lt} indefinite length items not allowed`);return Nr(e,t,1,1/0)}function Ea(e,t){Oe(e,H.map.majorEncoded,t.value)}Ea.compareTokens=vr.compareTokens;function Ud(e,t,r,n){return new ht(H.tag,r,1)}function Cd(e,t,r,n){return new ht(H.tag,ur(e,t+1,n),2)}function Nd(e,t,r,n){return new ht(H.tag,cr(e,t+1,n),3)}function Ld(e,t,r,n){return new ht(H.tag,dr(e,t+1,n),5)}function zd(e,t,r,n){return new ht(H.tag,lr(e,t+1,n),9)}function Ia(e,t){Oe(e,H.tag.majorEncoded,t.value)}Ia.compareTokens=vr.compareTokens;const Pd=20,Rd=21,Od=22,Td=23;function Dd(e,t,r,n){if(n.allowUndefined===!1)throw new Error(`${Lt} undefined values are not supported`);return n.coerceUndefinedToNull===!0?new ht(H.null,null,1):new ht(H.undefined,void 0,1)}function kd(e,t,r,n){if(n.allowIndefinite===!1)throw new Error(`${Lt} indefinite length items not allowed`);return new ht(H.break,void 0,1)}function Ri(e,t,r){if(r){if(r.allowNaN===!1&&Number.isNaN(e))throw new Error(`${Lt} NaN values are not supported`);if(r.allowInfinity===!1&&(e===1/0||e===-1/0))throw new Error(`${Lt} Infinity values are not supported`)}return new ht(H.float,e,t)}function qd(e,t,r,n){return Ri(Ti(e,t+1),3,n)}function Fd(e,t,r,n){return Ri(Di(e,t+1),5,n)}function Hd(e,t,r,n){return Ri(Ca(e,t+1),9,n)}function Oi(e,t,r){const n=t.value;if(n===!1)e.push([H.float.majorEncoded|Pd]);else if(n===!0)e.push([H.float.majorEncoded|Rd]);else if(n===null)e.push([H.float.majorEncoded|Od]);else if(n===void 0)e.push([H.float.majorEncoded|Td]);else{let i,f=!1;(!r||r.float64!==!0)&&($a(n),i=Ti(we,1),n===i||Number.isNaN(n)?(we[0]=249,e.push(we.slice(0,3)),f=!0):(Ua(n),i=Di(we,1),n===i&&(we[0]=250,e.push(we.slice(0,5)),f=!0))),f||(jd(n),i=Ca(we,1),we[0]=251,e.push(we.slice(0,9)))}}Oi.encodedSize=function(t,r){const n=t.value;if(n===!1||n===!0||n===null||n===void 0)return 1;let i;if(!r||r.float64!==!0){if($a(n),i=Ti(we,1),n===i||Number.isNaN(n))return 3;if(Ua(n),i=Di(we,1),n===i)return 5}return 9};const Ba=new ArrayBuffer(9),be=new DataView(Ba,1),we=new Uint8Array(Ba,0);function $a(e){if(e===1/0)be.setUint16(0,31744,!1);else if(e===-1/0)be.setUint16(0,64512,!1);else if(Number.isNaN(e))be.setUint16(0,32256,!1);else{be.setFloat32(0,e);const t=be.getUint32(0),r=(t&2139095040)>>23,n=t&8388607;if(r===255)be.setUint16(0,31744,!1);else if(r===0)be.setUint16(0,(e&2147483648)>>16|n>>13,!1);else{const i=r-127;i<-24?be.setUint16(0,0):i<-14?be.setUint16(0,(t&2147483648)>>16|1<<24+i,!1):be.setUint16(0,(t&2147483648)>>16|i+15<<10|n>>13,!1)}}}function Ti(e,t){if(e.length-t<2)throw new Error(`${Lt} not enough data for float16`);const r=(e[t]<<8)+e[t+1];if(r===31744)return 1/0;if(r===64512)return-1/0;if(r===32256)return NaN;const n=r>>10&31,i=r&1023;let f;return n===0?f=i*2**-24:n!==31?f=(i+1024)*2**(n-25):f=i===0?1/0:NaN,r&32768?-f:f}function Ua(e){be.setFloat32(0,e,!1)}function Di(e,t){if(e.length-t<4)throw new Error(`${Lt} not enough data for float32`);const r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,4).getFloat32(0,!1)}function jd(e){be.setFloat64(0,e,!1)}function Ca(e,t){if(e.length-t<8)throw new Error(`${Lt} not enough data for float64`);const r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,8).getFloat64(0,!1)}Oi.compareTokens=vr.compareTokens;function Ot(e,t,r){throw new Error(`${Lt} encountered invalid minor (${r}) for major ${e[t]>>>5}`)}function Ln(e){return()=>{throw new Error(`${Lt} ${e}`)}}const Z=[];for(let e=0;e<=23;e++)Z[e]=Ot;Z[24]=Zc;Z[25]=Qc;Z[26]=td;Z[27]=ed;Z[28]=Ot;Z[29]=Ot;Z[30]=Ot;Z[31]=Ot;for(let e=32;e<=55;e++)Z[e]=Ot;Z[56]=rd;Z[57]=nd;Z[58]=id;Z[59]=fd;Z[60]=Ot;Z[61]=Ot;Z[62]=Ot;Z[63]=Ot;for(let e=64;e<=87;e++)Z[e]=ad;Z[88]=od;Z[89]=sd;Z[90]=hd;Z[91]=ud;Z[92]=Ot;Z[93]=Ot;Z[94]=Ot;Z[95]=Ln("indefinite length bytes/strings are not supported");for(let e=96;e<=119;e++)Z[e]=dd;Z[120]=ld;Z[121]=vd;Z[122]=pd;Z[123]=bd;Z[124]=Ot;Z[125]=Ot;Z[126]=Ot;Z[127]=Ln("indefinite length bytes/strings are not supported");for(let e=128;e<=151;e++)Z[e]=gd;Z[152]=xd;Z[153]=wd;Z[154]=md;Z[155]=_d;Z[156]=Ot;Z[157]=Ot;Z[158]=Ot;Z[159]=Md;for(let e=160;e<=183;e++)Z[e]=Sd;Z[184]=Ad;Z[185]=Ed;Z[186]=Id;Z[187]=Bd;Z[188]=Ot;Z[189]=Ot;Z[190]=Ot;Z[191]=$d;for(let e=192;e<=215;e++)Z[e]=Ud;Z[216]=Cd;Z[217]=Nd;Z[218]=Ld;Z[219]=zd;Z[220]=Ot;Z[221]=Ot;Z[222]=Ot;Z[223]=Ot;for(let e=224;e<=243;e++)Z[e]=Ln("simple values are not supported");Z[244]=Ot;Z[245]=Ot;Z[246]=Ot;Z[247]=Dd;Z[248]=Ln("simple values are not supported");Z[249]=qd;Z[250]=Fd;Z[251]=Hd;Z[252]=Ot;Z[253]=Ot;Z[254]=Ot;Z[255]=kd;const Ce=[];for(let e=0;e<24;e++)Ce[e]=new ht(H.uint,e,1);for(let e=-1;e>=-24;e--)Ce[31-e]=new ht(H.negint,e,1);Ce[64]=new ht(H.bytes,new Uint8Array(0),1);Ce[96]=new ht(H.string,"",1);Ce[128]=new ht(H.array,0,1);Ce[160]=new ht(H.map,0,1);Ce[244]=new ht(H.false,!1,1);Ce[245]=new ht(H.true,!0,1);Ce[246]=new ht(H.null,null,1);function Kd(e){switch(e.type){case H.false:return Re([244]);case H.true:return Re([245]);case H.null:return Re([246]);case H.bytes:return e.value.length?void 0:Re([64]);case H.string:return e.value===""?Re([96]):void 0;case H.array:return e.value===0?Re([128]):void 0;case H.map:return e.value===0?Re([160]):void 0;case H.uint:return e.value<24?Re([Number(e.value)]):void 0;case H.negint:if(e.value>=-24)return Re([31-Number(e.value)])}}const Gd={float64:!1,mapSorter:Xd,quickEncodeToken:Kd},Ne=[];Ne[H.uint.major]=vr;Ne[H.negint.major]=Pi;Ne[H.bytes.major]=Nn;Ne[H.string.major]=yd;Ne[H.array.major]=Aa;Ne[H.map.major]=Ea;Ne[H.tag.major]=Ia;Ne[H.float.major]=Oi;const Na=new Ma;class zn{constructor(t,r){this.obj=t,this.parent=r}includes(t){let r=this;do if(r.obj===t)return!0;while(r=r.parent);return!1}static createCheck(t,r){if(t&&t.includes(r))throw new Error(`${Un} object contains circular references`);return new zn(r,t)}}const Ze={null:new ht(H.null,null),undefined:new ht(H.undefined,void 0),true:new ht(H.true,!0),false:new ht(H.false,!1),emptyArray:new ht(H.array,0),emptyMap:new ht(H.map,0)},Qe={number(e,t,r,n){return!Number.isInteger(e)||!Number.isSafeInteger(e)?new ht(H.float,e):e>=0?new ht(H.uint,e):new ht(H.negint,e)},bigint(e,t,r,n){return e>=BigInt(0)?new ht(H.uint,e):new ht(H.negint,e)},Uint8Array(e,t,r,n){return new ht(H.bytes,e)},string(e,t,r,n){return new ht(H.string,e)},boolean(e,t,r,n){return e?Ze.true:Ze.false},null(e,t,r,n){return Ze.null},undefined(e,t,r,n){return Ze.undefined},ArrayBuffer(e,t,r,n){return new ht(H.bytes,new Uint8Array(e))},DataView(e,t,r,n){return new ht(H.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength))},Array(e,t,r,n){if(!e.length)return r.addBreakTokens===!0?[Ze.emptyArray,new ht(H.break)]:Ze.emptyArray;n=zn.createCheck(n,e);const i=[];let f=0;for(const l of e)i[f++]=Pn(l,r,n);return r.addBreakTokens?[new ht(H.array,e.length),i,new ht(H.break)]:[new ht(H.array,e.length),i]},Object(e,t,r,n){const i=t!=="Object",f=i?e.keys():Object.keys(e),l=i?e.size:f.length;if(!l)return r.addBreakTokens===!0?[Ze.emptyMap,new ht(H.break)]:Ze.emptyMap;n=zn.createCheck(n,e);const u=[];let p=0;for(const x of f)u[p++]=[Pn(x,r,n),Pn(i?e.get(x):e[x],r,n)];return Jd(u,r),r.addBreakTokens?[new ht(H.map,l),u,new ht(H.break)]:[new ht(H.map,l),u]}};Qe.Map=Qe.Object;Qe.Buffer=Qe.Uint8Array;for(const e of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))Qe[`${e}Array`]=Qe.DataView;function Pn(e,t={},r){const n=qc(e),i=t&&t.typeEncoders&&t.typeEncoders[n]||Qe[n];if(typeof i=="function"){const l=i(e,n,t,r);if(l!=null)return l}const f=Qe[n];if(!f)throw new Error(`${Un} unsupported type: ${n}`);return f(e,n,t,r)}function Jd(e,t){t.mapSorter&&e.sort(t.mapSorter)}function Xd(e,t){const r=Array.isArray(e[0])?e[0][0]:e[0],n=Array.isArray(t[0])?t[0][0]:t[0];if(r.type!==n.type)return r.type.compare(n.type);const i=r.type.major,f=Ne[i].compareTokens(r,n);return f===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),f}function La(e,t,r,n){if(Array.isArray(t))for(const i of t)La(e,i,r,n);else r[t.type.major](e,t,n)}function Wd(e,t,r){const n=Pn(e,r);if(!Array.isArray(n)&&r.quickEncodeToken){const i=r.quickEncodeToken(n);if(i)return i;const f=t[n.type.major];if(f.encodedSize){const l=f.encodedSize(n,r),u=new Ma(l);if(f(u,n,r),u.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return Li(u.chunks[0])}}return La(Na,n,t,r),Na.toBytes(!0)}function Vd(e,t){return t=Object.assign({},Gd,t),Wd(e,Ne,t)}const Yd={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class Zd{constructor(t,r={}){this.pos=0,this.data=t,this.options=r}done(){return this.pos>=this.data.length}next(){const t=this.data[this.pos];let r=Ce[t];if(r===void 0){const n=Z[t];if(!n)throw new Error(`${Lt} no decoder for major type ${t>>>5} (byte 0x${t.toString(16).padStart(2,"0")})`);const i=t&31;r=n(this.data,this.pos,i,this.options)}return this.pos+=r.encodedLength,r}}const Wr=Symbol.for("DONE"),Rn=Symbol.for("BREAK");function Qd(e,t,r){const n=[];for(let i=0;i<e.value;i++){const f=Vr(t,r);if(f===Rn){if(e.value===1/0)break;throw new Error(`${Lt} got unexpected break to lengthed array`)}if(f===Wr)throw new Error(`${Lt} found array but not enough entries (got ${i}, expected ${e.value})`);n[i]=f}return n}function tl(e,t,r){const n=r.useMaps===!0,i=n?void 0:{},f=n?new Map:void 0;for(let l=0;l<e.value;l++){const u=Vr(t,r);if(u===Rn){if(e.value===1/0)break;throw new Error(`${Lt} got unexpected break to lengthed map`)}if(u===Wr)throw new Error(`${Lt} found map but not enough entries (got ${l} [no key], expected ${e.value})`);if(n!==!0&&typeof u!="string")throw new Error(`${Lt} non-string keys not supported (got ${typeof u})`);const p=Vr(t,r);if(p===Wr)throw new Error(`${Lt} found map but not enough entries (got ${l} [no value], expected ${e.value})`);n?f.set(u,p):i[u]=p}return n?f:i}function Vr(e,t){if(e.done())return Wr;const r=e.next();if(r.type===H.break)return Rn;if(r.type.terminal)return r.value;if(r.type===H.array)return Qd(r,e,t);if(r.type===H.map)return tl(r,e,t);if(r.type===H.tag){if(t.tags&&typeof t.tags[r.value]=="function"){const n=Vr(e,t);return t.tags[r.value](n)}throw new Error(`${Lt} tag not supported (${r.value})`)}throw new Error("unsupported")}function el(e,t){if(!(e instanceof Uint8Array))throw new Error(`${Lt} data to decode must be a Uint8Array`);t=Object.assign({},Yd,t);const r=t.tokenizer||new Zd(e,t),n=Vr(r,t);if(n===Wr)throw new Error(`${Lt} did not find any content to decode`);if(n===Rn)throw new Error(`${Lt} got unexpected break`);if(!r.done())throw new Error(`${Lt} too many terminals, data makes no sense`);return n}const za=42;function rl(e){if(e.asCID!==e)return null;const t=jt.asCID(e);if(!t)return null;const r=new Uint8Array(t.bytes.byteLength+1);return r.set(t.bytes,1),[new ht(H.tag,za),new ht(H.bytes,r)]}function nl(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function il(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const fl={float64:!0,typeEncoders:{Object:rl,undefined:nl,number:il}};function al(e){if(e[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return jt.decode(e.subarray(1))}const Pa={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};Pa.tags[za]=al;const ol="dag-cbor",sl=113,hl=e=>Vd(e,fl),ul=e=>el(e,Pa);var cl=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",name:ol,code:sl,encode:hl,decode:ul}),dl=er(cl),ll=me&&me.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),vl=me&&me.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Ra=me&&me.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&ll(t,e,r);return vl(t,e),t},ki=me&&me.__awaiter||function(e,t,r,n){function i(f){return f instanceof r?f:new r(function(l){l(f)})}return new(r||(r=Promise))(function(f,l){function u(g){try{x(n.next(g))}catch(A){l(A)}}function p(g){try{x(n.throw(g))}catch(A){l(A)}}function x(g){g.done?f(g.value):i(g.value).then(u,p)}x((n=n.apply(e,t||[])).next())})};Object.defineProperty(oe,"__esModule",{value:!0});var Oa=oe.decodeCleartext=Fa=oe.prepareCleartext=oe.decodeIdentityCID=oe.encodeIdentityCID=oe.toJWSStrings=oe.toJWSPayload=oe.encodePayload=void 0;const Ta=Ra(wc),On=mc,pl=Ec,Da=$c,bl=Tc,Tn=Ra(dl),yl=24;function gl(e){return ki(this,void 0,void 0,function*(){const t=yield Ta.encode({value:e,codec:Tn,hasher:pl.sha256});return{cid:t.cid,linkedBlock:t.bytes}})}oe.encodePayload=gl;function xl(e){let t=On.CID.asCID(e);if(t||(t=On.CID.asCID(e.cid)),!t)throw new Error("Payload must be an EncodedPayload or a CID");return bl.base64url.encode(t.bytes).slice(1)}oe.toJWSPayload=xl;function wl(e){if(typeof e=="object"&&typeof e.payload=="string"&&Array.isArray(e.signatures))return e.signatures.map(t=>{if(typeof t!="object"||typeof t.protected!="string"||typeof t.signature!="string")throw new Error("Object must be a DagJWS");return`${t.protected}.${e.payload}.${t.signature}`},[]);throw new Error("Object must be a DagJWS")}oe.toJWSStrings=wl;function ml(e,t=yl){const r=(t-e.length%t)%t,n=new Uint8Array(e.length+r);return n.set(e,0),n}function ka(e){return ki(this,void 0,void 0,function*(){return(yield Ta.encode({value:e,codec:Tn,hasher:Da.identity})).cid})}oe.encodeIdentityCID=ka;function qa(e){if(e=On.CID.asCID(e),e.code!==Tn.code)throw new Error("CID codec must be dag-cbor");if(e.multihash.code!==Da.identity.code)throw new Error("CID must use identity multihash");return Tn.decode(e.multihash.digest)}oe.decodeIdentityCID=qa;function _l(e,t){return ki(this,void 0,void 0,function*(){return ml((yield ka(e)).bytes,t)})}var Fa=oe.prepareCleartext=_l;function Ml(e){return qa(On.CID.decodeFirst(e)[0])}Oa=oe.decodeCleartext=Ml;class Il extends Array{constructor(){super();this.inRecursive=[]}prefix(t){const r=this.inRecursive[this.inRecursive.length-1];r&&(r.type===H.array&&(r.elements++,r.elements!==1&&t.push([44])),r.type===H.map&&(r.elements++,r.elements!==1&&(r.elements%2==1?t.push([44]):t.push([58]))))}[H.uint.major](t,r){this.prefix(t);const n=String(r.value),i=[];for(let f=0;f<n.length;f++)i[f]=n.charCodeAt(f);t.push(i)}[H.negint.major](t,r){this[H.uint.major](t,r)}[H.bytes.major](t,r){throw new Error(`${Un} unsupported type: Uint8Array`)}[H.string.major](t,r){this.prefix(t);const n=ga(JSON.stringify(r.value));t.push(n.length>32?Li(n):n)}[H.array.major](t,r){this.prefix(t),this.inRecursive.push({type:H.array,elements:0}),t.push([91])}[H.map.major](t,r){this.prefix(t),this.inRecursive.push({type:H.map,elements:0}),t.push([123])}[H.tag.major](t,r){}[H.float.major](t,r){if(r.type.name==="break"){const l=this.inRecursive.pop();if(l){if(l.type===H.array)t.push([93]);else if(l.type===H.map)t.push([125]);else throw new Error("Unexpected recursive type; this should not happen!");return}throw new Error("Unexpected break; this should not happen!")}if(r.value===void 0)throw new Error(`${Un} unsupported type: undefined`);if(this.prefix(t),r.type.name==="true"){t.push([116,114,117,101]);return}else if(r.type.name==="false"){t.push([102,97,108,115,101]);return}else if(r.type.name==="null"){t.push([110,117,108,108]);return}const n=String(r.value),i=[];let f=!1;for(let l=0;l<n.length;l++)i[l]=n.charCodeAt(l),!f&&(i[l]===46||i[l]===101||i[l]===69)&&(f=!0);f||(i.push(46),i.push(48)),t.push(i)}}const Ha=297,Sl=new TextEncoder;new TextDecoder;const qi="reKeys";class Bl{constructor(t,r,n){this.storeDAGEncrypted=async(i,f)=>{const l=await this.makeJWE(i,f);return await this.ipfs.dag.put(l,{hashAlg:"sha2-256"})},this.storeIPFSEncrypted=async(i,f)=>{const l=await this.makeJWE(i,f);return(await this.ipfs.add(JSON.stringify(l),{cidVersion:1,pin:!0})).cid},this.makeJWE=async(i,f)=>{const l=Nu(f),u=await Fa(i);return await Uu(u,[l])},this.loadEncrypted=async(i,f)=>{const l=Lu(f),u=await this.ipfs.dag.get(i),p=await Eu(u.value,l);return Oa(p)},this.ipfs=t,this.proxcryptor=r,this.rootCID=n}async updateDag(t,r,n){const i=await this.ipfs.dag.put(n,{pin:!0,format:Ha}),f=t?await this.ipfs.dag.get(t):{};let l=Yr(Vt({},f.value),{[r]:i,prev:t||!1});return await this.ipfs.dag.put(l,{format:Ha})}async getHashedTags(t,r){const n=await this.proxcryptor.getPublicKey(),f=Sl.encode(t)+r+n;return crypto.subtle.digest("SHA-256",f)}async setTagReKeys(t,r){const n=await this.getHashedTags(t,r),i=await this.ipfs.dag.get(this.rootCID,{path:`/${t}`});let l=(await this.ipfs.dag.get(i.value)).value;const u=l[qi],p=await this.proxcryptor.generateReKey(r,t),x=await this.proxcryptor.reEncrypt(r,l.encryptedKey,p);return u[n]=x,l=Yr(Vt({},l),{[qi]:u}),this.rootCID=await this.updateDag(this.rootCID,t,l),this.rootCID}async updateTagNode(){}async put(t,r,n={}){const i=Or.randomBytes(32),f=await this.proxcryptor.selfEncrypt(i,r),l=await this.storeDAGEncrypted(t,i);await this.ipfs.pin.add(l,{recursive:!0});let u=!1;try{u=(await this.ipfs.dag.resolve(`${this.rootCID}/${r}`)).cid}catch{u=!1}const p={tag:r,schema:n,timestamp:+new Date,encryptedData:l,encryptedKey:f,[qi]:{},prev:u};this.rootCID=await this.updateDag(this.rootCID,r,p)}async get(t,r){const n=await this.proxcryptor.reDecrypt(r);return await this.loadEncrypted(t,n)}async selfDecrypt(t){try{const r=await this.proxcryptor.selfDecrypt(t.encryptedKey);return await this.loadEncrypted(t.encryptedData,r)}catch(r){return console.error("In selfDecrypt",r),!1}}}export{Bl as DagJoseCryptor};
